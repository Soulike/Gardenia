(this["webpackJsonpsoulike-git"]=this["webpackJsonpsoulike-git"]||[]).push([[28],{1158:function(e,t,a){(function(e){function a(e,t){for(var a=0,r=e.length-1;r>=0;r--){var n=e[r];"."===n?e.splice(r,1):".."===n?(e.splice(r,1),a++):a&&(e.splice(r,1),a--)}if(t)for(;a--;a)e.unshift("..");return e}function r(e,t){if(e.filter)return e.filter(t);for(var a=[],r=0;r<e.length;r++)t(e[r],r,e)&&a.push(e[r]);return a}t.resolve=function(){for(var t="",n=!1,i=arguments.length-1;i>=-1&&!n;i--){var s=i>=0?arguments[i]:e.cwd();if("string"!==typeof s)throw new TypeError("Arguments to path.resolve must be strings");s&&(t=s+"/"+t,n="/"===s.charAt(0))}return(n?"/":"")+(t=a(r(t.split("/"),(function(e){return!!e})),!n).join("/"))||"."},t.normalize=function(e){var i=t.isAbsolute(e),s="/"===n(e,-1);return(e=a(r(e.split("/"),(function(e){return!!e})),!i).join("/"))||i||(e="."),e&&s&&(e+="/"),(i?"/":"")+e},t.isAbsolute=function(e){return"/"===e.charAt(0)},t.join=function(){var e=Array.prototype.slice.call(arguments,0);return t.normalize(r(e,(function(e,t){if("string"!==typeof e)throw new TypeError("Arguments to path.join must be strings");return e})).join("/"))},t.relative=function(e,a){function r(e){for(var t=0;t<e.length&&""===e[t];t++);for(var a=e.length-1;a>=0&&""===e[a];a--);return t>a?[]:e.slice(t,a-t+1)}e=t.resolve(e).substr(1),a=t.resolve(a).substr(1);for(var n=r(e.split("/")),i=r(a.split("/")),s=Math.min(n.length,i.length),o=s,c=0;c<s;c++)if(n[c]!==i[c]){o=c;break}var l=[];for(c=o;c<n.length;c++)l.push("..");return(l=l.concat(i.slice(o))).join("/")},t.sep="/",t.delimiter=":",t.dirname=function(e){if("string"!==typeof e&&(e+=""),0===e.length)return".";for(var t=e.charCodeAt(0),a=47===t,r=-1,n=!0,i=e.length-1;i>=1;--i)if(47===(t=e.charCodeAt(i))){if(!n){r=i;break}}else n=!1;return-1===r?a?"/":".":a&&1===r?"/":e.slice(0,r)},t.basename=function(e,t){var a=function(e){"string"!==typeof e&&(e+="");var t,a=0,r=-1,n=!0;for(t=e.length-1;t>=0;--t)if(47===e.charCodeAt(t)){if(!n){a=t+1;break}}else-1===r&&(n=!1,r=t+1);return-1===r?"":e.slice(a,r)}(e);return t&&a.substr(-1*t.length)===t&&(a=a.substr(0,a.length-t.length)),a},t.extname=function(e){"string"!==typeof e&&(e+="");for(var t=-1,a=0,r=-1,n=!0,i=0,s=e.length-1;s>=0;--s){var o=e.charCodeAt(s);if(47!==o)-1===r&&(n=!1,r=s+1),46===o?-1===t?t=s:1!==i&&(i=1):-1!==t&&(i=-1);else if(!n){a=s+1;break}}return-1===t||-1===r||0===i||1===i&&t===r-1&&t===a+1?"":e.slice(t,r)};var n="b"==="ab".substr(-1)?function(e,t,a){return e.substr(t,a)}:function(e,t,a){return t<0&&(t=e.length+t),e.substr(t,a)}}).call(this,a(84))},1159:function(e,t,a){e.exports={CommitInfoBar:"Style_CommitInfoBar__1-ElH",left:"Style_left__1syWH",right:"Style_right__3RBYJ",avatar:"Style_avatar__290nj",name:"Style_name__3xcxA"}},1164:function(e,t,a){"use strict";a(306);var r=a(138),n=a(0),i=a.n(n),s=a(1159),o=a.n(s),c=a(27),l=a(118),m=a(45),u=a(125);var f=Object(l.f)(i.a.memo((function(e){var t=e.lastCommit,a=t.committerName,n=t.commitHash,s=t.message,l=t.timestamp,f=e.match.params,p=f.username,h=f.repository;return i.a.createElement("div",{className:o.a.CommitInfoBar},i.a.createElement("div",{className:o.a.left},i.a.createElement(c.b,{className:o.a.name,to:m.b.generatePersonalCenterRoute({username:a})},a),i.a.createElement("div",{className:o.a.message},s)),i.a.createElement("div",{className:o.a.right},i.a.createElement("div",{className:o.a.time},u.a.parseTimestampToDifference(l)),i.a.createElement(r.a,{title:n},i.a.createElement("div",{className:o.a.commitHash},"\u6700\u540e\u63d0\u4ea4\uff1a",i.a.createElement(c.b,{to:m.b.generateRepositoryCommitRoute({username:p,repository:h,commitHash:n})},n.slice(0,7))))))})));a.d(t,"a",(function(){return f}))},1245:function(e,t,a){e.exports={FileReader:"Style_FileReader__1hW4w",commitInfoBar:"Style_commitInfoBar__2xvVY",contentWrapper:"Style_contentWrapper__3jWFR",fileInfoBar:"Style_fileInfoBar__2iqjb",fileName:"Style_fileName__3GaRF",htmlWrapper:"Style_htmlWrapper__3PHFv",content:"Style_content__3_Ute"}},1278:function(e,t,a){"use strict";a.r(t);var r=a(3),n=a.n(r),i=a(5),s=a(20),o=a(21),c=a(40),l=a(39),m=a(41),u=a(0),f=a.n(u),p=(a(154),a(90)),h=(a(457),a(190)),v=(a(153),a(46)),d=a(1245),g=a.n(d),b=(a(311),a(1164)),y=a(45),w=a(27),x=a(118),k=a(438);var _=Object(x.f)(f.a.memo((function(e){var t=e.isBinary,a=e.isOversize,r=e.exists,n=e.fileName,i=e.html,s=e.lastCommit,o=e.loading,c=e.onRawFileButtonClick,l=e.match.params,m=l.username,u=l.repository,d=l.branch,x=l.path;return f.a.createElement("div",{className:g.a.FileReader},f.a.createElement(p.a,{spinning:o},f.a.createElement("div",{className:g.a.commitInfoBar},f.a.createElement(b.a,{lastCommit:s})),f.a.createElement("div",{className:g.a.contentWrapper},f.a.createElement("div",{className:g.a.fileInfoBar},f.a.createElement("div",{className:g.a.fileName},n),f.a.createElement(v.a.Group,{className:g.a.buttonWrapper},f.a.createElement(v.a,null,f.a.createElement(w.b,{to:y.b.generateRepositoryCommitsRoute({username:m,repository:u,branch:d,path:x})},"\u5386\u53f2")),f.a.createElement(v.a,{onClick:c},"\u4e0b\u8f7d"))),f.a.createElement("div",{className:g.a.htmlWrapper},r?t?f.a.createElement(h.a,{type:"info",showIcon:!0,message:"\u4e8c\u8fdb\u5236\u6587\u4ef6\u65e0\u6cd5\u663e\u793a",description:"\u4f60\u53ef\u4ee5\u76f4\u63a5\u67e5\u770b\u539f\u6587\u4ef6"}):a?f.a.createElement(h.a,{type:"info",showIcon:!0,message:"\u6587\u4ef6\u592a\u5927",description:"\u4f60\u53ef\u4ee5\u76f4\u63a5\u67e5\u770b\u539f\u6587\u4ef6"}):f.a.createElement(k.a,{html:i,processing:o}):f.a.createElement(h.a,{type:"error",showIcon:!0,message:"\u6587\u4ef6\u4e0d\u5b58\u5728"})))))}))),E=a(137),C=a(77),j=a(433),B=a.n(j),O=a(1158),N=a.n(O),S=a(437),F=a(125),H=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(l.a)(t).call(this,e))).loadLastCommit=Object(i.a)(n.a.mark((function e(){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(i.a)(n.a.mark((function e(t){var r,i,s,o,c,l;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.props.match.params,i=r.username,s=r.repository,o=r.path,c=r.branch,e.next=3,C.g.lastCommit({username:i},{name:s},c,o);case 3:null!==(l=e.sent)&&a.setState({lastCommit:l},(function(){return t()}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)}))),a.loadFileInfo=Object(i.a)(n.a.mark((function e(){var t,r,i,s,o,c,l,m,u;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.state.lastCommit.commitHash,r=a.props.match.params,i=r.username,s=r.repository,o=r.path,e.next=4,C.g.fileInfo({username:i},{name:s},o,t);case 4:if(null===(c=e.sent)){e.next=17;break}if(l=c.exists,m=c.size,u=c.isBinary,a.setState({exists:l}),!l){e.next=17;break}if(a.setState({isBinary:u}),u){e.next=17;break}if(!(m>1048576)){e.next=15;break}a.setState({isOversize:!0}),e.next=17;break;case 15:return e.next=17,a.loadHTML();case 17:case"end":return e.stop()}}),e)}))),a.loadHTML=Object(i.a)(n.a.mark((function e(){var t,r,i,s,o,c,l,m,u,f,p,h,v,d;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.props.match.params,r=t.username,i=t.repository,s=t.path,o=a.state,c=o.isBinary,l=o.exists,m=o.isOversize,u=o.lastCommit.commitHash,f=a.getFileNameFromPath(s),e.next=5,C.g.rawFile({username:r},{name:i},s,u);case 5:if(null===(p=e.sent)){e.next=13;break}return e.next=9,F.b.transformBlobToString(p);case 9:h=e.sent,v="",!l||m||c||(a.isMarkdown(f)?(v=S.a.makeHtml(h),(d=document.createElement("div")).innerHTML=v,d.querySelectorAll("pre code").forEach((function(e){return B.a.highlightBlock(e)})),v=d.innerHTML):v=a.getHighlightedHtml(h)),a.setState({html:v});case 13:case"end":return e.stop()}}),e)}))),a.onRawFileButtonClick=Object(i.a)(n.a.mark((function e(){var t,r,i,s,o,c;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.props.match.params,r=t.username,i=t.repository,s=t.path,o=a.state.lastCommit.commitHash,e.next=4,C.g.rawFile({username:r},{name:i},s,o);case 4:null!==(c=e.sent)&&a.startDownload(c);case 6:case"end":return e.stop()}}),e)}))),a.startDownload=function(e){var t=a.props.match.params.path,r=URL.createObjectURL(e);F.b.startDownload(r,Object(O.basename)(t)),URL.revokeObjectURL(r)},a.getFileNameFromPath=function(e){var t=e.split("/");return t[t.length-1]},a.getHighlightedHtml=function(e){if(!a.state.isBinary){var t=document.createElement("pre"),r=document.createElement("div");return r.append(t),t.innerText=e,e.length<=51200?(B.a.highlightBlock(t),r.innerHTML):r.innerHTML}return e},a.isMarkdown=function(e){var t=N.a.extname(e);return".md"===t||".markdown"===t},a.state={exists:!0,isBinary:!1,isOversize:!1,lastCommit:new E.b("","","",0,"",""),loading:!0,html:""},a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=Object(i.a)(n.a.mark((function e(){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({loading:!0}),e.next=3,this.loadLastCommit();case 3:return e.next=5,this.loadFileInfo();case 5:this.setState({loading:!1});case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(i.a)(n.a.mark((function e(t,a,r){var i,s;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.props.location.pathname,s=t.location.pathname,i===s){e.next=5;break}return e.next=5,this.componentDidMount();case 5:case"end":return e.stop()}}),e,this)})));return function(t,a,r){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.props.match.params.path,t=this.state,a=t.isBinary,r=t.exists,n=t.isOversize,i=t.lastCommit,s=t.loading,o=t.html,c=this.getFileNameFromPath(e);return f.a.createElement(_,{html:o,exists:r,isBinary:a,isOversize:n,lastCommit:i,fileName:c,loading:s,onRawFileButtonClick:this.onRawFileButtonClick})}}]),t}(u.PureComponent),R=Object(x.f)(H);a.d(t,"default",(function(){return R}))}}]);
//# sourceMappingURL=28.2da5742a.chunk.js.map