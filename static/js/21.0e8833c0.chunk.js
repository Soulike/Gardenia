(this["webpackJsonpsoulike-git"]=this["webpackJsonpsoulike-git"]||[]).push([[21],{1145:function(e,t,a){(function(e){function a(e,t){for(var a=0,n=e.length-1;n>=0;n--){var r=e[n];"."===r?e.splice(n,1):".."===r?(e.splice(n,1),a++):a&&(e.splice(n,1),a--)}if(t)for(;a--;a)e.unshift("..");return e}function n(e,t){if(e.filter)return e.filter(t);for(var a=[],n=0;n<e.length;n++)t(e[n],n,e)&&a.push(e[n]);return a}t.resolve=function(){for(var t="",r=!1,s=arguments.length-1;s>=-1&&!r;s--){var i=s>=0?arguments[s]:e.cwd();if("string"!==typeof i)throw new TypeError("Arguments to path.resolve must be strings");i&&(t=i+"/"+t,r="/"===i.charAt(0))}return(r?"/":"")+(t=a(n(t.split("/"),(function(e){return!!e})),!r).join("/"))||"."},t.normalize=function(e){var s=t.isAbsolute(e),i="/"===r(e,-1);return(e=a(n(e.split("/"),(function(e){return!!e})),!s).join("/"))||s||(e="."),e&&i&&(e+="/"),(s?"/":"")+e},t.isAbsolute=function(e){return"/"===e.charAt(0)},t.join=function(){var e=Array.prototype.slice.call(arguments,0);return t.normalize(n(e,(function(e,t){if("string"!==typeof e)throw new TypeError("Arguments to path.join must be strings");return e})).join("/"))},t.relative=function(e,a){function n(e){for(var t=0;t<e.length&&""===e[t];t++);for(var a=e.length-1;a>=0&&""===e[a];a--);return t>a?[]:e.slice(t,a-t+1)}e=t.resolve(e).substr(1),a=t.resolve(a).substr(1);for(var r=n(e.split("/")),s=n(a.split("/")),i=Math.min(r.length,s.length),o=i,c=0;c<i;c++)if(r[c]!==s[c]){o=c;break}var m=[];for(c=o;c<r.length;c++)m.push("..");return(m=m.concat(s.slice(o))).join("/")},t.sep="/",t.delimiter=":",t.dirname=function(e){if("string"!==typeof e&&(e+=""),0===e.length)return".";for(var t=e.charCodeAt(0),a=47===t,n=-1,r=!0,s=e.length-1;s>=1;--s)if(47===(t=e.charCodeAt(s))){if(!r){n=s;break}}else r=!1;return-1===n?a?"/":".":a&&1===n?"/":e.slice(0,n)},t.basename=function(e,t){var a=function(e){"string"!==typeof e&&(e+="");var t,a=0,n=-1,r=!0;for(t=e.length-1;t>=0;--t)if(47===e.charCodeAt(t)){if(!r){a=t+1;break}}else-1===n&&(r=!1,n=t+1);return-1===n?"":e.slice(a,n)}(e);return t&&a.substr(-1*t.length)===t&&(a=a.substr(0,a.length-t.length)),a},t.extname=function(e){"string"!==typeof e&&(e+="");for(var t=-1,a=0,n=-1,r=!0,s=0,i=e.length-1;i>=0;--i){var o=e.charCodeAt(i);if(47!==o)-1===n&&(r=!1,n=i+1),46===o?-1===t?t=i:1!==s&&(s=1):-1!==t&&(s=-1);else if(!r){a=i+1;break}}return-1===t||-1===n||0===s||1===s&&t===n-1&&t===a+1?"":e.slice(t,n)};var r="b"==="ab".substr(-1)?function(e,t,a){return e.substr(t,a)}:function(e,t,a){return t<0&&(t=e.length+t),e.substr(t,a)}}).call(this,a(92))},1170:function(e,t){e.exports=function(e){if("string"!==typeof e)return!1;var t=e.match(a);if(!t)return!1;var s=t[1];if(!s)return!1;if(n.test(s)||r.test(s))return!0;return!1};var a=/^(?:\w+:)?\/\/(\S+)$/,n=/^localhost[\:?\d]*(?:[^\:?\d]\S*)?$/,r=/^[^\s\.]+\.\S{2,}$/},1171:function(e,t,a){e.exports={CommitInfoBar:"Style_CommitInfoBar__AogMa",left:"Style_left__3aqnY",right:"Style_right__XNYqn",avatar:"Style_avatar__2CYzj",name:"Style_name__3WHXI"}},1183:function(e,t,a){"use strict";a(351);var n=a(164),r=a(0),s=a.n(r),i=a(1171),o=a.n(i),c=a(14),m=a(139),l=a(25),u=a(98),p=a(359);var f=Object(m.f)(s.a.memo((function(e){var t=e.lastCommit,a=t.committerName,r=t.commitHash,i=t.message,m=t.timestamp,f=t.committerEmail,h=e.match.params,d=h.username,b=h.repository;return s.a.createElement("div",{className:o.a.CommitInfoBar},s.a.createElement("div",{className:o.a.left},s.a.createElement(p.a,{committerEmail:f,committerName:a}),s.a.createElement("div",{className:o.a.message},i)),s.a.createElement("div",{className:o.a.right},s.a.createElement("div",{className:o.a.time},u.b.parseTimestampToDifference(m)),s.a.createElement(n.a,{title:r},s.a.createElement("div",{className:o.a.commitHash},"\u6700\u540e\u63d0\u4ea4\uff1a",s.a.createElement(c.b,{to:l.Function.generateRepositoryCommitRoute({username:d,repository:b,commitHash:r})},r.slice(0,7))))))})));a.d(t,"a",(function(){return f}))},1184:function(e,t,a){"use strict";var n=a(0),r=a.n(n),s=a(139),i=a(25),o=a(354),c=a(1170),m=a.n(c),l=a(16),u=a(1145),p=a.n(u),f=a(257);class h extends n.PureComponent{constructor(e){super(e),this.objectURLs=[],this.loadMainBranchName=async()=>new Promise(async e=>{const{match:{params:{username:t,repository:a}}}=this.props,n=await o.a.branches({username:t,name:a});if(null!==n){const{branches:t}=n;for(const{name:a,isDefault:n}of t)if(n){this.setState({mainBranchName:a},()=>e());break}}}),this.processHTML=async e=>{const t=document.implementation.createHTMLDocument().createElement("div");t.innerHTML=e;const a=t.getElementsByTagName("a"),n=t.getElementsByTagName("img"),r=[];for(const s of a){const e=s.getAttribute("href");null!==e&&r.push((async()=>{s.setAttribute("href",await this.getCompleteLink(e))})())}for(const s of n){const e=s.getAttribute("src");null!==e&&r.push((async()=>{const t=await this.getImageURL(e);this.objectURLs.push(t),s.setAttribute("src",t)})())}return await Promise.all(r),t.innerHTML},this.getCompleteLink=async e=>{if(0===e.length||m()(e)||p.a.isAbsolute(e)||"#"===e.charAt(0)||"?"===e.charAt(0))return e;{const{match:{params:{username:t,repository:a,objectType:n,branch:r,path:s}}}=this.props,{mainBranchName:c}=this.state,m=s?n===l.b.BLOB?p.a.join(p.a.dirname(s),e):p.a.join(s,e):p.a.join("",e),u=await o.a.fileInfo({username:t},{name:a},m,r||c);if(null!==u){const{exists:e,type:n}=u;return e&&n!==l.b.BLOB?i.Function.generateRepositoryCodeRoute({username:t,repository:a,branch:r||c,path:m,objectType:l.b.TREE}):i.Function.generateRepositoryCodeRoute({username:t,repository:a,branch:r||c,path:m,objectType:l.b.BLOB})}return i.Function.generateRepositoryCodeRoute({username:t,repository:a,branch:r||c,path:m,objectType:l.b.BLOB})}},this.getImageURL=async e=>{if(m()(e)||p.a.isAbsolute(e))return e;{const{match:{params:{username:t,repository:a,objectType:n,branch:r,path:s}}}=this.props,{mainBranchName:i}=this.state,c=s?n===l.b.BLOB?p.a.join(p.a.dirname(s),e):p.a.join(s,e):p.a.join("",e),m=await o.a.rawFile({username:t},{name:a},c,r||i);return null!==m?URL.createObjectURL(m):e}},this.state={mainBranchName:"",loading:!1}}async componentDidMount(){const{match:{params:{branch:e}}}=this.props;this.setState({loading:!0}),"string"!==typeof e&&await this.loadMainBranchName(),this.setState({loading:!1})}async componentDidUpdate(e,t,a){const{markdown:n}=this.props,{markdown:r}=e;n!==r&&await this.componentDidMount()}componentWillUnmount(){this.objectURLs.forEach(e=>URL.revokeObjectURL(e))}render(){const{loading:e}=this.state,{markdown:t}=this.props;return r.a.createElement(f.a,{markdown:t,processHTML:this.processHTML,loading:e})}}var d=Object(s.f)(h);a.d(t,"a",(function(){return d}))},1283:function(e,t,a){e.exports={FileReader:"Style_FileReader__3UwbJ",commitInfoBar:"Style_commitInfoBar__Q8via",contentWrapper:"Style_contentWrapper__WXjet",fileInfoBar:"Style_fileInfoBar__2tYVI",fileName:"Style_fileName__CCvcF",readerWrapper:"Style_readerWrapper__1-Blo",content:"Style_content___R5vO"}},1284:function(e,t,a){e.exports={CodeReader:"Style_CodeReader__yNPpi",line:"Style_line__2xQ8V",lineNumber:"Style_lineNumber__nX9YT",code:"Style_code__19ilK"}},1285:function(e,t,a){e.exports={MarkdownReader:"Style_MarkdownReader__2lNN5"}},1337:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),s=a(5),i=a(47),o=a(48),c=a(50),m=a(49),l=a(51),u=a(0),p=a.n(u),f=(a(121),a(60)),h=(a(91),a(20)),d=a(1283),b=a.n(d),v=a(1183),y=a(25),g=a(14),w=a(139),_=(a(353),a(166));var E=p.a.memo((function(){return p.a.createElement(_.a,{type:"warning",showIcon:!0,message:"\u4e8c\u8fdb\u5236\u6587\u4ef6\u65e0\u6cd5\u663e\u793a",description:"\u4f60\u53ef\u4ee5\u76f4\u63a5\u4e0b\u8f7d\u67e5\u770b\u539f\u6587\u4ef6"})}));var C=p.a.memo((function(){return p.a.createElement(_.a,{type:"warning",showIcon:!0,message:"\u6587\u4ef6\u8fc7\u5927\uff0c\u4e0d\u80fd\u76f4\u63a5\u67e5\u770b",description:"\u4f60\u53ef\u4ee5\u76f4\u63a5\u4e0b\u8f7d\u67e5\u770b\u539f\u6587\u4ef6"})})),j=a(1145),k=a(1284),N=a.n(k),B=a(98);var O=p.a.memo((function(e){var t=e.code,a=B.a.getHighlightedCodeLines(t);return p.a.createElement("table",{className:"".concat(N.a.CodeReader," hljs")},p.a.createElement("tbody",null,a.map((function(e,t){return p.a.createElement("tr",{key:t,className:N.a.line},p.a.createElement("td",null,p.a.createElement("div",{className:N.a.lineNumber},t+1)),p.a.createElement("td",null,p.a.createElement("pre",{className:N.a.code},p.a.createElement("code",{dangerouslySetInnerHTML:{__html:e}}))))}))))})),R=a(1285),x=a.n(R),L=a(1184);var S=p.a.memo((function(e){const{markdown:t}=e;return p.a.createElement("div",{className:x.a.MarkdownReader},p.a.createElement(L.a,{markdown:t}))}));var F=Object(w.f)(p.a.memo((function(e){const t=[".json"],a=[".md",".markdown",".mdwn"],{isBinary:n,isOversize:r,fileName:s,lastCommit:i,loading:o,onRawFileButtonClick:c,fileContent:m,match:{params:{username:l,repository:u,branch:d,path:w}}}=e,_=Object(j.extname)(s).toLowerCase();return p.a.createElement("div",{className:b.a.FileReader},p.a.createElement(f.a,{spinning:o},p.a.createElement("div",{className:b.a.commitInfoBar},p.a.createElement(v.a,{lastCommit:i})),p.a.createElement("div",{className:b.a.contentWrapper},p.a.createElement("div",{className:b.a.fileInfoBar},p.a.createElement("div",{className:b.a.fileName},s),p.a.createElement(h.a.Group,{className:b.a.buttonWrapper},p.a.createElement(h.a,null,p.a.createElement(g.b,{to:y.Function.generateRepositoryCommitsRoute({username:l,repository:u,branch:d,path:w})},"\u5386\u53f2")),p.a.createElement(h.a,{onClick:c},"\u4e0b\u8f7d"))),p.a.createElement("div",{className:b.a.readerWrapper},n?p.a.createElement(E,null):r?p.a.createElement(C,null):t.includes(_)?p.a.createElement(O,{code:m}):a.includes(_)?p.a.createElement(S,{markdown:m}):p.a.createElement(O,{code:m})))))}))),I=a(149),T=a(33),A=y.CONFIG.PAGE_ID_TO_ROUTE,U=y.CONFIG.PAGE_ID,M=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).loadLastCommit=Object(s.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(s.a)(r.a.mark((function e(t){var n,s,i,o,c,m;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.props.match.params,s=n.username,i=n.repository,o=n.path,c=n.branch,e.next=3,T.h.lastBranchCommit({username:s},{name:i},c,o);case 3:null!==(m=e.sent)&&a.setState({lastCommit:m},(function(){return t()}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)}))),a.loadFileInfo=Object(s.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(s.a)(r.a.mark((function e(t){var n,s,i,o,c,m,l,u,p,f,h;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.state.lastCommit.commitHash,s=a.props,i=s.match.params,o=i.username,c=i.repository,m=i.path,l=s.history,e.next=4,T.h.fileInfo({username:o},{name:c},m,n);case 4:if(null===(u=e.sent)){e.next=12;break}if(p=u.exists,f=u.size,h=u.isBinary,p){e.next=11;break}return e.abrupt("return",l.replace(A[U.NOT_FOUND]));case 11:!h&&f>1048576?a.setState({isOversize:!0,isBinary:h},(function(){return t()})):a.setState({isOversize:!1,isBinary:h},(function(){return t()}));case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)}))),a.loadFileContent=Object(s.a)(r.a.mark((function e(){var t,n,s,i,o,c;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.props.match.params,n=t.username,s=t.repository,i=t.path,o=a.state.lastCommit.commitHash,e.next=4,T.h.rawFile({username:n},{name:s},i,o);case 4:if(null===(c=e.sent)){e.next=12;break}return e.t0=a,e.next=9,B.c.transformBlobToString(c);case 9:e.t1=e.sent,e.t2={fileContent:e.t1},e.t0.setState.call(e.t0,e.t2);case 12:case"end":return e.stop()}}),e)}))),a.onRawFileButtonClick=Object(s.a)(r.a.mark((function e(){var t,n,s,i,o,c;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.props.match.params,n=t.username,s=t.repository,i=t.path,o=a.state.lastCommit.commitHash,e.next=4,T.h.rawFile({username:n},{name:s},i,o);case 4:null!==(c=e.sent)&&a.startDownload(c);case 6:case"end":return e.stop()}}),e)}))),a.startDownload=function(e){var t=a.props.match.params.path,n=URL.createObjectURL(e);B.c.startDownload(n,Object(j.basename)(t)),URL.revokeObjectURL(n)},a.getFileNameFromPath=function(e){var t=e.split("/");return t[t.length-1]},a.state={isBinary:!1,isOversize:!1,lastCommit:new I.b("","","",0,"",""),loading:!0,fileContent:""},a}return Object(l.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=Object(s.a)(r.a.mark((function e(){var t,a,n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({loading:!0}),e.next=3,this.loadLastCommit();case 3:return e.next=5,this.loadFileInfo();case 5:if(t=this.state,a=t.isBinary,n=t.isOversize,a||n){e.next=9;break}return e.next=9,this.loadFileContent();case 9:this.setState({loading:!1});case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(s.a)(r.a.mark((function e(t,a,n){var s,i;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=this.props.location.pathname,i=t.location.pathname,s===i){e.next=5;break}return e.next=5,this.componentDidMount();case 5:case"end":return e.stop()}}),e,this)})));return function(t,a,n){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.props.match.params.path,t=this.state,a=t.isBinary,n=t.isOversize,r=t.lastCommit,s=t.loading,i=t.fileContent,o=this.getFileNameFromPath(e);return p.a.createElement(F,{fileContent:i,isBinary:a,isOversize:n,lastCommit:r,fileName:o,loading:s,onRawFileButtonClick:this.onRawFileButtonClick})}}]),t}(u.PureComponent),D=Object(w.f)(M);a.d(t,"default",(function(){return D}))}}]);
//# sourceMappingURL=21.0e8833c0.chunk.js.map