(this["webpackJsonpsoulike-git"]=this["webpackJsonpsoulike-git"]||[]).push([[37],{1119:function(e,t,n){"use strict";var a=n(0),r=n.n(a),o=n(15);t.a=r.a.memo((function(e){return r.a.createElement(o.b,Object.assign({},e,{target:"_blank",rel:"noopener norefferrer"}))}))},1123:function(e,t,n){"use strict";var a=n(1119);n.d(t,"a",(function(){return a.a}))},1230:function(e,t,n){e.exports={Conflict:"Style_Conflict__3Vamq",conflictsWrapper:"Style_conflictsWrapper__1FN4k",conflictWrapper:"Style_conflictWrapper__2qm8Q",buttonWrapper:"Style_buttonWrapper__1QhqS"}},1233:function(e,t,n){e.exports={ConflictEditor:"Style_ConflictEditor__p1WcR",header:"Style_header__3Oayj",filePath:"Style_filePath__1iCwK",checkboxWrapper:"Style_checkboxWrapper__VLdFN",text:"Style_text__3S4yB"}},1344:function(e,t,n){"use strict";n.r(t);var a=n(3),r=n.n(a),o=(n(95),n(42)),c=n(7),s=n(1113),i=n(1114),l=n(1116),u=n(1115),p=n(1117),f=n(0),m=n.n(f),h=(n(142),n(73)),d=(n(344),n(150)),b=(n(94),n(25)),v=(n(341),n(157)),g=n(1230),y=n.n(g),C=n(1123),k=n(32),E=n(20),R=(n(1231),n(1324)),x=n(1233),_=n.n(x),w=m.a.lazy((function(){return Promise.all([n.e(9),n.e(50)]).then(n.bind(null,1329))}));var O=m.a.memo((function(e){var t=e.conflict.filePath,n=e.code,a=e.onCodeChange,r=e.onResolvedCheckboxChange,o=e.resolved;return m.a.createElement("div",{className:_.a.ConflictEditor},m.a.createElement("div",{className:_.a.header},m.a.createElement("code",{className:_.a.filePath},t),m.a.createElement("label",{className:_.a.checkboxWrapper},m.a.createElement(R.a,{onChange:r,checked:o}),m.a.createElement("div",{className:_.a.text},"\u5df2\u89e3\u51b3"))),m.a.createElement("div",{className:_.a.codeWrapper,style:o?{position:"fixed",top:"99999999px"}:{}},m.a.createElement(w,{onBeforeChange:a,value:n,options:{lineNumbers:!0,indentUnit:0}})))})),N=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).onCodeChange=function(e,t,a){n.setState({code:a})},n.onResolvedCheckboxChange=function(e){var t=n.state.code,a=n.props.conflict.filePath;-1!==t.search(/^<<<<<<< .+$/m)||-1!==t.search(/^=======$/m)||-1!==t.search(/^>>>>>>> .+$/m)?o.a.warning({message:m.a.createElement("div",null,m.a.createElement("code",null,a)," \u4e2d\u4ecd\u5b58\u5728\u51b2\u7a81"),description:"\u8bf7\u89e3\u51b3\u51b2\u7a81\uff0c\u5e76\u5220\u9664\u6240\u6709\u7684\u51b2\u7a81\u6807\u8bb0"}):n.setState({resolved:e.target.checked})},n.state={code:"",resolved:!1},n}return Object(p.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.conflict.content;this.setState({code:e})}},{key:"componentDidUpdate",value:function(){var e=Object(c.a)(r.a.mark((function e(t,n,a){var o,c,s,i,l,u,p,f,m;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=this.props.conflict,c=t.conflict,o===c){e.next=5;break}return e.next=5,this.componentDidMount();case 5:if("function"!==typeof(s=this.props.onChange)){e.next=13;break}if(i=this.state,l=i.code,u=i.resolved,p=o.filePath,f=n.code,m=n.resolved,l===f&&u===m){e.next=13;break}return e.next=13,s(p,u,l);case 13:case"end":return e.stop()}}),e,this)})));return function(t,n,a){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state,t=e.code,n=e.resolved,a=this.props.conflict;return m.a.createElement(O,{conflict:a,code:t,onCodeChange:this.onCodeChange,resolved:n,onResolvedCheckboxChange:this.onResolvedCheckboxChange})}}]),t}(f.PureComponent);var S=m.a.memo((function(e){var t=e.loading,n=e.pullRequest,a=n.sourceRepositoryUsername,r=n.sourceRepositoryName,o=n.sourceRepositoryBranchName,c=n.targetRepositoryUsername,s=n.targetRepositoryName,i=n.targetRepositoryBranchName,l=e.conflicts,u=e.onConflictChange,p=e.onSubmitButtonClick;return m.a.createElement("div",{className:y.a.Conflict},m.a.createElement(h.a,{spinning:t},m.a.createElement("div",{className:y.a.alert},m.a.createElement(v.a,{type:"info",banner:!0,showIcon:!0,message:m.a.createElement("div",null,"\u6b63\u5728\u89e3\u51b3 ",m.a.createElement(C.a,{to:k.Function.generateRepositoryCodeRoute({username:a,repository:r,objectType:E.b.TREE,branch:o})},m.a.createElement("code",null,a,"/",r,":",o))," \u5230 ",m.a.createElement(C.a,{to:k.Function.generateRepositoryCodeRoute({username:c,repository:s,objectType:E.b.TREE,branch:i})},m.a.createElement("code",null,c,"/",s,":",i))," \u7684\u5408\u5e76\u51b2\u7a81")}),m.a.createElement(v.a,{type:"warning",banner:!0,showIcon:!0,message:m.a.createElement("div",null,"\u6240\u505a\u7684\u4fee\u6539\u5c06\u88ab\u63d0\u4ea4\u5230 ",m.a.createElement("code",null,a,"/",r,":",o))})),m.a.createElement("div",{className:y.a.conflictsWrapper},l.map((function(e){return m.a.createElement("div",{key:e.filePath,className:y.a.conflictWrapper},m.a.createElement(N,{conflict:e,onChange:u}))}))),m.a.createElement("div",{className:y.a.buttonWrapper},m.a.createElement(d.a,{onConfirm:p,disabled:t,title:m.a.createElement("div",null,"\u786e\u8ba4\u51b2\u7a81\u89e3\u51b3\uff1f",m.a.createElement("br",null),m.a.createElement("strong",null,"\u4ee5\u4e0a\u4fee\u6539\u90fd\u5c06\u88ab\u63d0\u4ea4\u5230 ",m.a.createElement("code",null,a,"/",r,":",o)))},m.a.createElement(b.a,{type:"primary",size:"large",disabled:t,loading:t},"\u63d0\u4ea4")))))})),P=n(132),j=n(115),q=n(45),F=k.CONFIG.PAGE_ID,W=k.CONFIG.PAGE_ID_TO_ROUTE,B=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).checkURL=function(){var e=n.props,t=e.match.params.no,a=e.history,r=Number.parseInt(t);Number.isNaN(r)&&a.replace(W[F.NOT_FOUND])},n.loadPullRequest=Object(c.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(c.a)(r.a.mark((function e(t){var a,c,s,i,l,u,p,f;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.props,c=a.match.params,s=c.username,i=c.repository,l=c.no,u=a.history,p=Number.parseInt(l),e.next=4,q.f.get({username:s,name:i},{no:p});case 4:if(null===(f=e.sent)){e.next=14;break}if(f.status===E.c.OPEN){e.next=11;break}return o.a.warn({message:"Pull Request #".concat(p," \u5df2\u5173\u95ed\u6216\u5408\u5e76")}),u.replace(k.Function.generateRepositoryPullRequestRoute({username:s,repository:i,no:l})),e.abrupt("return",t());case 11:n.setState({pullRequest:f},(function(){return t()})),e.next=15;break;case 14:t();case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)}))),n.loadConflicts=Object(c.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(c.a)(r.a.mark((function e(t){var a,c,s,i,l,u,p,f,m,h;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.state.pullRequest,c=a.id,e.next=4,q.f.getConflicts({id:c});case 4:if(null===(s=e.sent)){e.next=18;break}if(i=s.conflicts,l=n.props,u=l.match.params,p=u.username,f=u.repository,m=u.no,h=l.history,0!==i.length){e.next=14;break}return o.a.warn({message:"".concat(p,"/").concat(f," #").concat(m," \u6ca1\u6709\u5408\u5e76\u51b2\u7a81"),description:"\u60a8\u53ef\u76f4\u63a5\u6267\u884c\u5408\u5e76\u64cd\u4f5c"}),h.replace(k.Function.generateRepositoryPullRequestRoute({username:p,repository:f,no:m})),e.abrupt("return",t());case 14:i.forEach((function(e){if(e.isBinary)return o.a.warn({message:"\u5b58\u5728\u4e8c\u8fdb\u5236\u6587\u4ef6\u51b2\u7a81",description:"\u8bf7\u4f7f\u7528\u547d\u4ee4\u884c\u89e3\u51b3\u51b2\u7a81"}),h.replace(k.Function.generateRepositoryPullRequestRoute({username:p,repository:f,no:m})),t()}));case 15:n.setState({conflicts:i},(function(){return t()})),e.next=19;break;case 18:t();case 19:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)}))),n.onConflictChange=function(e,t,a){for(var r=n.state,o=r.conflicts,c=r.resolvedFilePath,s=0;s<o.length;s++){var i=o[s],l=i.filePath,u=i.isBinary,p=i.content;l===e&&a!==p&&(o[s]=new j.c(e,u,a)),t?c.add(e):c.delete(e)}},n.onSubmitButtonClick=Object(c.a)(r.a.mark((function e(){var t,a,c,s,i,l,u,p,f,m;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.state,a=t.pullRequest.id,c=t.resolvedFilePath,s=t.conflicts,s.map((function(e){return e.filePath})).length===c.size){e.next=6;break}o.a.error({message:"\u8bf7\u89e3\u51b3\u6240\u6709\u51b2\u7a81\u540e\u518d\u63d0\u4ea4"}),e.next=12;break;case 6:return n.setState({loading:!0}),e.next=9,q.f.resolveConflicts({id:a},s);case 9:null!==e.sent&&(o.a.success({message:"\u89e3\u51b3\u51b2\u7a81\u6210\u529f"}),i=n.props,l=i.history,u=i.match.params,p=u.username,f=u.repository,m=u.no,l.push(k.Function.generateRepositoryPullRequestRoute({username:p,repository:f,no:m}))),n.setState({loading:!1});case 12:case"end":return e.stop()}}),e)}))),n.state={pullRequest:new j.g(0,0,"","","","","","","","",0,0,"","",E.c.CLOSED),conflicts:[],loading:!1,resolvedFilePath:new Set},n}return Object(p.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=Object(c.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.checkURL(),this.setState({loading:!0}),e.next=4,this.loadPullRequest();case 4:this.setState({loading:!1});case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(c.a)(r.a.mark((function e(t,n,a){var o,c,s;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=this.props.location.pathname,c=this.props.location.pathname,o===c){e.next=5;break}return e.next=5,this.componentDidMount();case 5:if(s=this.state.pullRequest.id,n.pullRequest.id===s){e.next=12;break}return this.setState({loading:!0}),e.next=11,this.loadConflicts();case 11:this.setState({loading:!1});case 12:case"end":return e.stop()}}),e,this)})));return function(t,n,a){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state,t=e.loading,n=e.pullRequest,a=e.conflicts;return m.a.createElement(S,{loading:t,pullRequest:n,conflicts:a,onConflictChange:this.onConflictChange,onSubmitButtonClick:this.onSubmitButtonClick})}}]),t}(f.PureComponent),D=Object(P.f)(B);n.d(t,"default",(function(){return D}))}}]);
//# sourceMappingURL=37.d7d548d4.chunk.js.map