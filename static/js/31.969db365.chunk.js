(this["webpackJsonpsoulike-git"]=this["webpackJsonpsoulike-git"]||[]).push([[31],{1137:function(e,t,a){e.exports={SettingsTitle:"Style_SettingsTitle__rgD4i"}},1138:function(e,t,a){"use strict";var n=a(0),r=a.n(n),i=a(1137),l=a.n(i);var c=r.a.memo((function(e){var t=e.children;return r.a.createElement("h2",{className:l.a.SettingsTitle},t)}));a.d(t,"a",(function(){return c}))},1155:function(e,t,a){"use strict";var n=a(0),r=a.n(n),i=a(358);var l=r.a.memo((function(){return r.a.createElement(i.a,{avatar:""})}));a.d(t,"a",(function(){return l}))},1270:function(e,t,a){e.exports={Avatar:"Style_Avatar__2TmQb",body:"Style_body__eN9Pm",avatarWrapper:"Style_avatarWrapper__3wqvg",avatar:"Style_avatar__hT7wZ",fileInput:"Style_fileInput__1gSjB",buttonWrapper:"Style_buttonWrapper__1rFvY"}},1361:function(e,t,a){"use strict";a.r(t);a(97);var n=a(42),r=a(2),i=a.n(r),l=a(5),c=a(64),o=a(65),s=a(67),u=a(66),p=a(68),f=a(0),v=a.n(f),m=(a(96),a(25)),d=(a(129),a(69)),g=(a(349),a(162)),h=a(1270),b=a.n(h),_=a(1138),k=a(1155);var C=v.a.memo((function(e){var t=e.avatar,a=e.loading,n=e.fileInputRef,r=e.onAvatarClick,i=e.onAvatarInputChange,l=e.fileChanged,c=e.onUploadButtonClick;return v.a.createElement("div",{className:b.a.Avatar},v.a.createElement(_.a,null,"\u5934\u50cf"),v.a.createElement("div",{className:b.a.body},v.a.createElement(d.a,{spinning:a},v.a.createElement(g.a,{title:"\u70b9\u51fb\u66f4\u6362\u5934\u50cf"},v.a.createElement("div",{className:b.a.avatarWrapper,onClick:r},t?v.a.createElement("img",{src:t,alt:"avatar",className:b.a.avatar}):v.a.createElement(k.a,null)))),v.a.createElement("input",{type:"file",accept:"image/*",multiple:!1,className:b.a.fileInput,ref:n,onChange:i}),v.a.createElement("div",{className:b.a.buttonWrapper},v.a.createElement(m.a,{type:"primary",block:!0,disabled:a||!l,loading:a,onClick:c},"\u4e0a\u4f20"))))})),S=a(38),y=a(24),E=a(220),A=y.CONFIG.PAGE_ID,I=y.CONFIG.PAGE_ID_TO_ROUTE,O=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).fileInputRef=v.a.createRef(),a.setStatePromise=Object(E.promisify)(a.setState),a.loadAvatar=Object(l.a)(i.a.mark((function e(){var t,n,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.e.get();case 2:if(null===(t=e.sent)){e.next=9;break}return n=t.avatar,e.next=7,a.setStatePromise({avatar:n});case 7:e.next=11;break;case 9:return r=a.props.history,e.abrupt("return",r.replace(I[A.NOT_FOUND]));case 11:case"end":return e.stop()}}),e)}))),a.onAvatarClick=function(){var e=a.fileInputRef.current;null!==e&&e.click()},a.onAvatarInputChange=function(e){var t=e.target.files;if(null!==t&&t.length>0){var n=t[0];a.setState({file:n,avatar:URL.createObjectURL(n)})}},a.onUploadButtonClick=Object(l.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==(t=a.state.file)){e.next=5;break}n.a.warn({message:"\u8bf7\u5148\u9009\u62e9\u5934\u50cf"}),e.next=11;break;case 5:return a.setState({loading:!0}),e.next=8,S.e.uploadAvatar(t);case 8:null!==e.sent&&(n.a.success({message:"\u4e0a\u4f20\u5934\u50cf\u6210\u529f"}),setTimeout((function(){window.location.reload()}),1e3)),a.setState({loading:!1});case 11:case"end":return e.stop()}}),e)}))),a.state={avatar:"",loading:!1,file:null},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=Object(l.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.setStatePromise({loading:!0});case 2:return e.next=4,this.loadAvatar();case 4:return e.next=6,this.setStatePromise({loading:!1});case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state,t=e.avatar,a=e.loading,n=e.file;return v.a.createElement(C,{onAvatarInputChange:this.onAvatarInputChange,onAvatarClick:this.onAvatarClick,fileInputRef:this.fileInputRef,avatar:t,loading:a,fileChanged:null!==n,onUploadButtonClick:this.onUploadButtonClick})}}]),t}(f.PureComponent);a.d(t,"default",(function(){return O}))}}]);
//# sourceMappingURL=31.969db365.chunk.js.map