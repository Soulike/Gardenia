(this["webpackJsonpsoulike-git"]=this["webpackJsonpsoulike-git"]||[]).push([[40],{1067:function(p,y,e){p.exports={Notifications:"Style_Notifications__D-xOu",loadMoreButtonWrapper:"Style_loadMoreButtonWrapper__3BI5A"}},1068:function(p,y,e){p.exports={Notification:"Style_Notification__2Atwy",left:"Style_left__2q6SK",right:"Style_right__jEYSy",unconfirmedDotWrapper:"Style_unconfirmedDotWrapper__2Vdk3",unconfirmedDot:"Style_unconfirmedDot__3iNX4",iconWrapper:"Style_iconWrapper__2S6sF",contentWrapper:"Style_contentWrapper__lH-PF",typeWrapper:"Style_typeWrapper__3XsAt",timeWrapper:"Style_timeWrapper__1qIiV",buttonWrapper:"Style_buttonWrapper__23C0M"}},1404:function(p,y,e){"use strict";e.r(y),e.d(y,"default",function(){return Y});var h=e(0),t=e.n(h),W=e(1067),S=e.n(W),D=e(965),M=e(953),F=e(1428),v=e(102),I=e(180),T=e(1068),s=e.n(T),N=e(173),R=e(970),U=e(986),L=e(954),A=e(3),k={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M909.1 209.3l-56.4 44.1C775.8 155.1 656.2 92 521.9 92 290 92 102.3 279.5 102 511.5 101.7 743.7 289.8 932 521.9 932c181.3 0 335.8-115 394.6-276.1 1.5-4.2-.7-8.9-4.9-10.3l-56.7-19.5a8 8 0 00-10.1 4.8c-1.8 5-3.8 10-5.9 14.9-17.3 41-42.1 77.8-73.7 109.4A344.77 344.77 0 01655.9 829c-42.3 17.9-87.4 27-133.8 27-46.5 0-91.5-9.1-133.8-27A341.5 341.5 0 01279 755.2a342.16 342.16 0 01-73.7-109.4c-17.9-42.4-27-87.4-27-133.9s9.1-91.5 27-133.9c17.3-41 42.1-77.8 73.7-109.4 31.6-31.6 68.4-56.4 109.3-73.8 42.3-17.9 87.4-27 133.8-27 46.5 0 91.5 9.1 133.8 27a341.5 341.5 0 01109.3 73.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.6 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c-.1-6.6-7.8-10.3-13-6.2z"}}]},name:"reload",theme:"outlined"},x=k,j=e(9),O=function(n,a){return h.createElement(j.a,Object(A.a)(Object(A.a)({},n),{},{ref:a,icon:x}))};O.displayName="ReloadOutlined";var z=h.forwardRef(O),P=e(68);function G(r){const{notification:{id:n,confirmed:a,content:c,type:l,timestamp:d},onConfirmButtonClickFactory:o,onUnconfirmButtonClickFactory:i}=r;return t.a.createElement(F.b.Item,null,t.a.createElement("div",{className:s.a.Notification},t.a.createElement("div",{className:s.a.left},t.a.createElement("div",{className:s.a.unconfirmedDotWrapper},a?null:t.a.createElement("span",{className:s.a.unconfirmedDot})),t.a.createElement("div",{className:s.a.iconWrapper},t.a.createElement(U.a,null)),t.a.createElement("div",{className:s.a.contentWrapper},c)),t.a.createElement("div",{className:s.a.right},t.a.createElement("div",{className:s.a.typeWrapper},l),t.a.createElement("div",{className:s.a.timeWrapper},t.a.createElement(N.a,{title:P.b.parseTimestampToDate(d)},t.a.createElement("span",null,P.b.parseTimestampToDifference(d)))),t.a.createElement("div",{className:s.a.buttonWrapper},t.a.createElement(R.b,{size:-1},t.a.createElement(N.a,{title:"\u786E\u8BA4\u6D88\u606F"},t.a.createElement(v.a,{onClick:o(n),size:"small",disabled:a},t.a.createElement(L.a,null))),t.a.createElement(N.a,{title:"\u64A4\u9500\u786E\u8BA4\u6D88\u606F"},t.a.createElement(v.a,{onClick:i(n),size:"small",disabled:!a},t.a.createElement(z,null))))))))}var V=t.a.memo(G);function J(r){const{notifications:n,unconfirmedNotificationCount:a,onConfirmButtonClickFactory:c,onUnconfirmButtonClickFactory:l,onLoadMoreButtonClick:d,loading:o}=r;return t.a.createElement("div",{className:S.a.Notifications},t.a.createElement(D.a,{title:t.a.createElement("div",null,"\u6D88\u606F (",a," \u6761\u672A\u786E\u8BA4)")},t.a.createElement(M.a,{spinning:o},n.length>0?t.a.createElement(t.a.Fragment,null,t.a.createElement(F.b,{bordered:!0,size:"small"},n.map(i=>t.a.createElement(V,{notification:i,onConfirmButtonClickFactory:c,onUnconfirmButtonClickFactory:l,key:i.id}))),t.a.createElement("div",{className:S.a.loadMoreButtonWrapper},t.a.createElement(v.a,{type:"primary",disabled:o,loading:o,onClick:d},"\u52A0\u8F7D\u66F4\u591A"))):t.a.createElement(I.a,{description:"\u6CA1\u6709\u6D88\u606F"}))))}var X=t.a.memo(J),H=e(134),E=e(27),K=e(97),B=e(345),m=(r,n,a)=>new Promise((c,l)=>{var d=u=>{try{i(a.next(u))}catch(f){l(f)}},o=u=>{try{i(a.throw(u))}catch(f){l(f)}},i=u=>u.done?c(u.value):Promise.resolve(u.value).then(d,o);i((a=a.apply(r,n)).next())});const C=class extends h.PureComponent{constructor(r){super(r);this.setStatePromise=Object(K.promisify)(this.setState),this.loadNotificationCount=()=>m(this,null,function*(){const n=yield E.f.getCount({confirmed:!1});if(n!==null){const{count:a}=n;yield this.setStatePromise({unconfirmedNotificationCount:a})}}),this.onSetConfirmedButtonClickFactory=(n,a)=>()=>m(this,null,function*(){if(yield this.setStatePromise({loading:!0}),(yield E.f.setConfirmed([{id:n}],a))!==null){const{notifications:l,unconfirmedNotificationCount:d}=this.state,o=[...l];for(let i=0;i<o.length;i++)if(o[i].id===n){const{id:u,timestamp:f,content:Q,type:Z,username:$}=o[i];o[i]=new H.f(u,$,Q,Z,f,a);break}yield this.setStatePromise({notifications:o,unconfirmedNotificationCount:d+(a?-1:1)})}yield this.setStatePromise({loading:!1})}),this.onConfirmButtonClickFactory=n=>this.onSetConfirmedButtonClickFactory(n,!0),this.onUnconfirmButtonClickFactory=n=>this.onSetConfirmedButtonClickFactory(n,!1),this.onLoadMoreButtonClick=()=>m(this,null,function*(){yield this.loadMoreNotifications()}),this.loadMoreNotifications=()=>m(this,null,function*(){const{loadEnd:n,lastLoadPosition:a}=this.state;if(n)B.a.success({message:"\u5DF2\u52A0\u8F7D\u6240\u6709\u6D88\u606F"});else{yield this.setStatePromise({loading:!0});const c=yield E.f.get({},a,C.NOTIFICATION_AMOUNT_PER_PAGE);if(c!==null){const{notifications:l}=c;l.length<C.NOTIFICATION_AMOUNT_PER_PAGE&&(B.a.success({message:"\u5DF2\u52A0\u8F7D\u6240\u6709\u6D88\u606F"}),yield this.setStatePromise({loadEnd:!0})),yield this.setStatePromise({notifications:[...this.state.notifications,...l],loading:!1,lastLoadPosition:a+C.NOTIFICATION_AMOUNT_PER_PAGE})}}}),this.state={notifications:[],loading:!1,lastLoadPosition:0,loadEnd:!1,unconfirmedNotificationCount:0}}componentDidMount(){return m(this,null,function*(){yield this.setStatePromise({loading:!0}),yield Promise.all([this.loadNotificationCount(),this.loadMoreNotifications()]),yield this.setStatePromise({loading:!1})})}render(){const{notifications:r,loading:n,unconfirmedNotificationCount:a}=this.state;return t.a.createElement(X,{notifications:r,unconfirmedNotificationCount:a,loading:n,onConfirmButtonClickFactory:this.onConfirmButtonClickFactory,onUnconfirmButtonClickFactory:this.onUnconfirmButtonClickFactory,onLoadMoreButtonClick:this.onLoadMoreButtonClick})}};let g=C;g.NOTIFICATION_AMOUNT_PER_PAGE=20;var Y=g}}]);

//# sourceMappingURL=40.3b8d6188.chunk.js.map