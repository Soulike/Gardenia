(this["webpackJsonpsoulike-git"]=this["webpackJsonpsoulike-git"]||[]).push([[43],{1035:function(e,t,n){e.exports={Conflict:"Style_Conflict__3Vamq",conflictsWrapper:"Style_conflictsWrapper__1FN4k",conflictWrapper:"Style_conflictWrapper__2qm8Q",buttonWrapper:"Style_buttonWrapper__1QhqS"}},1036:function(e,t,n){e.exports={ConflictEditor:"Style_ConflictEditor__p1WcR",header:"Style_header__3Oayj",filePath:"Style_filePath__1iCwK",checkboxWrapper:"Style_checkboxWrapper__VLdFN",text:"Style_text__3S4yB"}},1305:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return le}));var a=n(2),r=n.n(a),c=n(6),o=n(14),s=n(15),i=n(39),l=n(38),u=n(0),p=n.n(u),d=n(1035),f=n.n(d),h=n(836),b=n(851),v=n(840),m=n(108),j=n(263),y=n(57),O=n(30),x=n(1036),g=n.n(x),k=n(4),C=n(5),N=n(8),w=n.n(N),R=n(44),P=n(7),S=n(16),_=n(19),E=n(21),q=n(22),F=function(e){Object(E.a)(n,e);var t=Object(q.a)(n);function n(e){var a;Object(S.a)(this,n),(a=t.call(this,e)).handleChange=function(e){var t=a.props,n=t.disabled,r=t.onChange;n||("checked"in a.props||a.setState({checked:e.target.checked}),r&&r({target:Object(P.a)(Object(P.a)({},a.props),{},{checked:e.target.checked}),stopPropagation:function(){e.stopPropagation()},preventDefault:function(){e.preventDefault()},nativeEvent:e.nativeEvent}))},a.saveInput=function(e){a.input=e};var r="checked"in e?e.checked:e.defaultChecked;return a.state={checked:r},a}return Object(_.a)(n,[{key:"focus",value:function(){this.input.focus()}},{key:"blur",value:function(){this.input.blur()}},{key:"render",value:function(){var e,t=this.props,n=t.prefixCls,a=t.className,r=t.style,c=t.name,o=t.id,s=t.type,i=t.disabled,l=t.readOnly,u=t.tabIndex,d=t.onClick,f=t.onFocus,h=t.onBlur,b=t.onKeyDown,v=t.onKeyPress,m=t.onKeyUp,j=t.autoFocus,y=t.value,O=t.required,x=Object(R.a)(t,["prefixCls","className","style","name","id","type","disabled","readOnly","tabIndex","onClick","onFocus","onBlur","onKeyDown","onKeyPress","onKeyUp","autoFocus","value","required"]),g=Object.keys(x).reduce((function(e,t){return"aria-"!==t.substr(0,5)&&"data-"!==t.substr(0,5)&&"role"!==t||(e[t]=x[t]),e}),{}),N=this.state.checked,P=w()(n,a,(e={},Object(k.a)(e,"".concat(n,"-checked"),N),Object(k.a)(e,"".concat(n,"-disabled"),i),e));return p.a.createElement("span",{className:P,style:r},p.a.createElement("input",Object(C.a)({name:c,id:o,type:s,required:O,readOnly:l,disabled:i,tabIndex:u,className:"".concat(n,"-input"),checked:!!N,onClick:d,onFocus:f,onBlur:h,onKeyUp:m,onKeyDown:b,onKeyPress:v,onChange:this.handleChange,autoFocus:j,ref:this.saveInput,value:y},g)),p.a.createElement("span",{className:"".concat(n,"-inner")}))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return"checked"in e?Object(P.a)(Object(P.a)({},t),{},{checked:e.checked}):null}}]),n}(u.Component);F.defaultProps={prefixCls:"rc-checkbox",className:"",style:{},type:"checkbox",defaultChecked:!1,onFocus:function(){},onBlur:function(){},onChange:function(){},onKeyDown:function(){},onKeyPress:function(){},onKeyUp:function(){}};var D=F,B=n(17),K=n(10),W=n(45),I=n(100),U=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n},M=u.createContext(null),V=function(e){var t=e.defaultValue,n=e.children,a=e.options,r=void 0===a?[]:a,c=e.prefixCls,o=e.className,s=e.style,i=e.onChange,l=U(e,["defaultValue","children","options","prefixCls","className","style","onChange"]),p=u.useContext(I.b),d=p.getPrefixCls,f=p.direction,h=u.useState(l.value||t||[]),b=Object(K.a)(h,2),v=b[0],m=b[1],j=u.useState([]),y=Object(K.a)(j,2),O=y[0],x=y[1];u.useEffect((function(){"value"in l&&m(l.value||[])}),[l.value]);var g=function(){return r.map((function(e){return"string"===typeof e?{label:e,value:e}:e}))},N=d("checkbox",c),R="".concat(N,"-group"),P=Object(W.a)(l,["value","disabled"]);r&&r.length>0&&(n=g().map((function(e){return u.createElement($,{prefixCls:N,key:e.value.toString(),disabled:"disabled"in e?e.disabled:l.disabled,value:e.value,checked:-1!==v.indexOf(e.value),onChange:e.onChange,className:"".concat(R,"-item"),style:e.style},e.label)})));var S={toggleOption:function(e){var t=v.indexOf(e.value),n=Object(B.a)(v);if(-1===t?n.push(e.value):n.splice(t,1),"value"in l||m(n),i){var a=g();i(n.filter((function(e){return-1!==O.indexOf(e)})).sort((function(e,t){return a.findIndex((function(t){return t.value===e}))-a.findIndex((function(e){return e.value===t}))})))}},value:v,disabled:l.disabled,name:l.name,registerValue:function(e){x((function(t){return[].concat(Object(B.a)(t),[e])}))},cancelValue:function(e){x((function(t){return t.filter((function(t){return t!==e}))}))}},_=w()(R,Object(k.a)({},"".concat(R,"-rtl"),"rtl"===f),o);return u.createElement("div",Object(C.a)({className:_,style:s},P),u.createElement(M.Provider,{value:S},n))},L=u.memo(V),T=n(66),z=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n},G=function(e,t){var n,a=e.prefixCls,r=e.className,c=e.children,o=e.indeterminate,s=void 0!==o&&o,i=e.style,l=e.onMouseEnter,p=e.onMouseLeave,d=e.skipGroup,f=void 0!==d&&d,h=z(e,["prefixCls","className","children","indeterminate","style","onMouseEnter","onMouseLeave","skipGroup"]),b=u.useContext(I.b),v=b.getPrefixCls,m=b.direction,j=u.useContext(M),y=u.useRef(h.value);u.useEffect((function(){null===j||void 0===j||j.registerValue(h.value),Object(T.a)("checked"in h||!!j||!("value"in h),"Checkbox","`value` is not a valid prop, do you mean `checked`?")}),[]),u.useEffect((function(){if(!f)return h.value!==y.current&&(null===j||void 0===j||j.cancelValue(y.current),null===j||void 0===j||j.registerValue(h.value)),function(){return null===j||void 0===j?void 0:j.cancelValue(h.value)}}),[h.value]);var O=v("checkbox",a),x=Object(C.a)({},h);j&&!f&&(x.onChange=function(){h.onChange&&h.onChange.apply(h,arguments),j.toggleOption&&j.toggleOption({label:c,value:h.value})},x.name=j.name,x.checked=-1!==j.value.indexOf(h.value),x.disabled=h.disabled||j.disabled);var g=w()((n={},Object(k.a)(n,"".concat(O,"-wrapper"),!0),Object(k.a)(n,"".concat(O,"-rtl"),"rtl"===m),Object(k.a)(n,"".concat(O,"-wrapper-checked"),x.checked),Object(k.a)(n,"".concat(O,"-wrapper-disabled"),x.disabled),n),r),N=w()(Object(k.a)({},"".concat(O,"-indeterminate"),s));return u.createElement("label",{className:g,style:i,onMouseEnter:l,onMouseLeave:p},u.createElement(D,Object(C.a)({},x,{prefixCls:O,className:N,ref:t})),void 0!==c&&u.createElement("span",null,c))},H=u.forwardRef(G);H.displayName="Checkbox";var $=H,J=$;J.Group=L,J.__ANT_CHECKBOX=!0;var Q=J,A=n(1),X=p.a.lazy((function(){return Promise.all([n.e(10),n.e(47)]).then(n.bind(null,1342))}));function Y(e){var t=e.conflict.filePath,n=e.code,a=e.onCodeChange,r=e.onResolvedCheckboxChange,c=e.resolved;return Object(A.jsxs)("div",{className:g.a.ConflictEditor,children:[Object(A.jsxs)("div",{className:g.a.header,children:[Object(A.jsx)("code",{className:g.a.filePath,children:t}),Object(A.jsxs)("label",{className:g.a.checkboxWrapper,children:[Object(A.jsx)(Q,{onChange:r,checked:c}),Object(A.jsx)("div",{className:g.a.text,children:"\u5df2\u89e3\u51b3"})]})]}),Object(A.jsx)("div",{className:g.a.codeWrapper,style:c?{position:"fixed",top:"99999999px"}:{},children:Object(A.jsx)(X,{onBeforeChange:a,value:n,options:{lineNumbers:!0,indentUnit:0}})})]})}var Z=p.a.memo(Y),ee=n(327),te=function(e){Object(i.a)(n,e);var t=Object(l.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).onCodeChange=function(e,t,n){a.setState({code:n})},a.onResolvedCheckboxChange=function(e){var t=a.state.code,n=a.props.conflict.filePath;-1!==t.search(/^<<<<<<< .+$/m)||-1!==t.search(/^=======$/m)||-1!==t.search(/^>>>>>>> .+$/m)?ee.a.warning({message:Object(A.jsxs)("div",{children:[Object(A.jsx)("code",{children:n})," \u4e2d\u4ecd\u5b58\u5728\u51b2\u7a81"]}),description:"\u8bf7\u89e3\u51b3\u51b2\u7a81\uff0c\u5e76\u5220\u9664\u6240\u6709\u7684\u51b2\u7a81\u6807\u8bb0"}):a.setState({resolved:e.target.checked})},a.state={code:"",resolved:!1},a}return Object(s.a)(n,[{key:"componentDidMount",value:function(){var e=this.props.conflict.content;this.setState({code:e})}},{key:"componentDidUpdate",value:function(){var e=Object(c.a)(r.a.mark((function e(t,n,a){var c,o,s,i,l,u,p,d,f;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=this.props.conflict,o=t.conflict,c===o){e.next=5;break}return e.next=5,this.componentDidMount();case 5:if("function"!==typeof(s=this.props.onChange)){e.next=13;break}if(i=this.state,l=i.code,u=i.resolved,p=c.filePath,d=n.code,f=n.resolved,l===d&&u===f){e.next=13;break}return e.next=13,s(p,u,l);case 13:case"end":return e.stop()}}),e,this)})));return function(t,n,a){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state,t=e.code,n=e.resolved,a=this.props.conflict;return Object(A.jsx)(Z,{conflict:a,code:t,onCodeChange:this.onCodeChange,resolved:n,onResolvedCheckboxChange:this.onResolvedCheckboxChange})}}]),n}(u.PureComponent);function ne(e){var t=e.loading,n=e.pullRequest,a=n.sourceRepositoryUsername,r=n.sourceRepositoryName,c=n.sourceRepositoryBranchName,o=n.targetRepositoryUsername,s=n.targetRepositoryName,i=n.targetRepositoryBranchName,l=e.conflicts,u=e.onConflictChange,p=e.onSubmitButtonClick;return Object(A.jsx)("div",{className:f.a.Conflict,children:Object(A.jsxs)(h.a,{spinning:t,children:[Object(A.jsxs)("div",{className:f.a.alert,children:[Object(A.jsx)(b.a,{type:"info",banner:!0,showIcon:!0,message:Object(A.jsxs)("div",{children:["\u6b63\u5728\u89e3\u51b3 ",Object(A.jsx)(j.a,{to:y.Function.generateRepositoryCodeRoute({username:a,repositoryName:r,objectType:O.b.TREE,commitHash:c}),children:Object(A.jsxs)("code",{children:[a,"/",r,":",c]})})," \u5230 ",Object(A.jsx)(j.a,{to:y.Function.generateRepositoryCodeRoute({username:o,repositoryName:s,objectType:O.b.TREE,commitHash:i}),children:Object(A.jsxs)("code",{children:[o,"/",s,":",i]})})," \u7684\u5408\u5e76\u51b2\u7a81"]})}),Object(A.jsx)(b.a,{type:"warning",banner:!0,showIcon:!0,message:Object(A.jsxs)("div",{children:["\u6240\u505a\u7684\u4fee\u6539\u5c06\u88ab\u63d0\u4ea4\u5230 ",Object(A.jsxs)("code",{children:[a,"/",r,":",c]})]})})]}),Object(A.jsx)("div",{className:f.a.conflictsWrapper,children:l.map((function(e){return Object(A.jsx)("div",{className:f.a.conflictWrapper,children:Object(A.jsx)(te,{conflict:e,onChange:u})},e.filePath)}))}),Object(A.jsx)("div",{className:f.a.buttonWrapper,children:Object(A.jsx)(v.a,{onConfirm:p,disabled:t,title:Object(A.jsxs)("div",{children:["\u786e\u8ba4\u51b2\u7a81\u89e3\u51b3\uff1f",Object(A.jsx)("br",{}),Object(A.jsxs)("strong",{children:["\u4ee5\u4e0a\u4fee\u6539\u90fd\u5c06\u88ab\u63d0\u4ea4\u5230 ",Object(A.jsxs)("code",{children:[a,"/",r,":",c]})]})]}),children:Object(A.jsx)(m.a,{type:"primary",size:"large",disabled:t,loading:t,children:"\u63d0\u4ea4"})})})]})})}var ae=p.a.memo(ne),re=n(56),ce=n(135),oe=n(32),se=n(3),ie=function(e){Object(i.a)(n,e);var t=Object(l.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).checkURL=function(){var e=a.props,t=e.match.params.no,n=e.history,r=Number.parseInt(t);if(Number.isNaN(r))return n.replace(se.d[se.b.NOT_FOUND])},a.loadPullRequest=Object(c.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(c.a)(r.a.mark((function e(t){var n,c,o,s,i,l,u,p;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.props,c=n.match.params,o=c.username,s=c.repositoryName,i=c.no,l=n.history,u=Number.parseInt(i),e.next=4,oe.h.get({username:o,name:s},{no:u});case 4:if(null===(p=e.sent)){e.next=14;break}if(p.status===O.c.OPEN){e.next=11;break}return ee.a.warn({message:"Pull Request #".concat(u," \u5df2\u5173\u95ed\u6216\u5408\u5e76")}),t(),e.abrupt("return",l.replace(y.Function.generateRepositoryPullRequestRoute({username:o,repositoryName:s,no:i})));case 11:a.setState({pullRequest:p},(function(){return t()})),e.next=16;break;case 14:return t(),e.abrupt("return",l.replace(se.d[se.b.NOT_FOUND]));case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)}))),a.loadConflicts=Object(c.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(c.a)(r.a.mark((function e(t){var n,c,o,s,i,l,u,p,d,f;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.state.pullRequest,c=n.id,e.next=4,oe.h.getConflicts({id:c});case 4:if(null===(o=e.sent)){e.next=18;break}if(s=o.conflicts,i=a.props,l=i.match.params,u=l.username,p=l.repositoryName,d=l.no,f=i.history,0!==s.length){e.next=14;break}return ee.a.warn({message:"".concat(u,"/").concat(p," #").concat(d," \u6ca1\u6709\u5408\u5e76\u51b2\u7a81"),description:"\u60a8\u53ef\u76f4\u63a5\u6267\u884c\u5408\u5e76\u64cd\u4f5c"}),t(),e.abrupt("return",f.replace(y.Function.generateRepositoryPullRequestRoute({username:u,repositoryName:p,no:d})));case 14:s.forEach((function(e){if(e.isBinary)return ee.a.warn({message:"\u5b58\u5728\u4e8c\u8fdb\u5236\u6587\u4ef6\u51b2\u7a81",description:"\u8bf7\u4f7f\u7528\u547d\u4ee4\u884c\u89e3\u51b3\u51b2\u7a81"}),t(),f.replace(y.Function.generateRepositoryPullRequestRoute({username:u,repositoryName:p,no:d}))}));case 15:a.setState({conflicts:s},(function(){return t()})),e.next=19;break;case 18:t();case 19:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)}))),a.onConflictChange=function(e,t,n){for(var r=a.state,c=r.conflicts,o=r.resolvedFilePath,s=0;s<c.length;s++){var i=c[s],l=i.filePath,u=i.isBinary,p=i.content;l===e&&n!==p&&(c[s]=new ce.c(e,u,n)),t?o.add(e):o.delete(e)}},a.onSubmitButtonClick=Object(c.a)(r.a.mark((function e(){var t,n,c,o,s,i,l,u,p,d;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.state,n=t.pullRequest.id,c=t.resolvedFilePath,o=t.conflicts,o.map((function(e){return e.filePath})).length===c.size){e.next=6;break}ee.a.error({message:"\u8bf7\u89e3\u51b3\u6240\u6709\u51b2\u7a81\u540e\u518d\u63d0\u4ea4"}),e.next=15;break;case 6:return a.setState({loading:!0}),e.next=9,oe.h.resolveConflicts({id:n},o);case 9:if(null===e.sent){e.next=14;break}return ee.a.success({message:"\u89e3\u51b3\u51b2\u7a81\u6210\u529f"}),s=a.props,i=s.history,l=s.match.params,u=l.username,p=l.repositoryName,d=l.no,e.abrupt("return",i.push(y.Function.generateRepositoryPullRequestRoute({username:u,repositoryName:p,no:d})));case 14:a.setState({loading:!1});case 15:case"end":return e.stop()}}),e)}))),a.state={pullRequest:new ce.h(0,0,"","","","","","","","",0,0,"","",O.c.CLOSED),conflicts:[],loading:!1,resolvedFilePath:new Set},a}return Object(s.a)(n,[{key:"componentDidMount",value:function(){var e=Object(c.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.checkURL(),this.setState({loading:!0}),e.next=4,this.loadPullRequest();case 4:this.setState({loading:!1});case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(c.a)(r.a.mark((function e(t,n,a){var c,o,s;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=this.props.location.pathname,o=this.props.location.pathname,c===o){e.next=5;break}return e.next=5,this.componentDidMount();case 5:if(s=this.state.pullRequest.id,n.pullRequest.id===s){e.next=12;break}return this.setState({loading:!0}),e.next=11,this.loadConflicts();case 11:this.setState({loading:!1});case 12:case"end":return e.stop()}}),e,this)})));return function(t,n,a){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state,t=e.loading,n=e.pullRequest,a=e.conflicts;return Object(A.jsx)(ae,{loading:t,pullRequest:n,conflicts:a,onConflictChange:this.onConflictChange,onSubmitButtonClick:this.onSubmitButtonClick})}}]),n}(u.PureComponent),le=Object(re.j)(ie)}}]);
//# sourceMappingURL=43.53ec8e66.chunk.js.map