(this["webpackJsonpsoulike-git"]=this["webpackJsonpsoulike-git"]||[]).push([[13],{1016:function(e,t,a){e.exports={CommitInfoBar:"Style_CommitInfoBar__AogMa",left:"Style_left__3aqnY",right:"Style_right__XNYqn",message:"Style_message__3Jq3M"}},1028:function(e,t,a){"use strict";a.d(t,"a",(function(){return f}));var n=a(0),r=a.n(n),o=a(1016),c=a.n(o),i=a(26),s=a(67),m=a(68),u=a(191),l=a(86),p=a(340);var f=Object(s.j)(r.a.memo((function(e){var t=e.lastCommit,a=t.committerName,n=t.commitHash,o=t.message,s=t.timestamp,f=t.committerEmail,d=e.match.params,b=d.username,h=d.repositoryName;return r.a.createElement("div",{className:c.a.CommitInfoBar},r.a.createElement("div",{className:c.a.left},r.a.createElement(p.a,{committerEmail:f,committerName:a}),r.a.createElement("div",{className:c.a.message},o)),r.a.createElement("div",{className:c.a.right},r.a.createElement("div",{className:c.a.time},l.b.parseTimestampToDifference(s)),r.a.createElement(u.a,{title:n},r.a.createElement("div",{className:c.a.commitHash},"\u6700\u540e\u63d0\u4ea4\uff1a",r.a.createElement(i.b,{to:m.Function.generateRepositoryCommitRoute({username:b,repositoryName:h,commitHash:n})},n.slice(0,7))))))})))},1029:function(e,t,a){"use strict";a.d(t,"a",(function(){return N}));var n=a(1),r=a.n(n),o=a(224),c=a(4),i=a(16),s=a(18),m=a(43),u=a(42),l=a(0),p=a.n(l),f=a(67),d=a(68),b=a(338),h=a(1015),v=a.n(h),C=a(29),E=a(965),y=a.n(E),j=a(252),O=function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).objectURLs=[],n.loadMainBranchName=Object(c.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(c.a)(r.a.mark((function e(t){var a,c,i,s,m,u,l,p,f;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.props.match.params,c=a.username,i=a.repositoryName,e.next=3,b.a.branches({username:c,name:i});case 3:if(null===(s=e.sent)){e.next=24;break}m=s.branches,u=Object(o.a)(m),e.prev=7,u.s();case 9:if((l=u.n()).done){e.next=16;break}if(p=l.value,f=p.name,!p.isDefault){e.next=14;break}return n.setState({mainBranchName:f},(function(){return t()})),e.abrupt("break",16);case 14:e.next=9;break;case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(7),u.e(e.t0);case 21:return e.prev=21,u.f(),e.finish(21);case 24:case"end":return e.stop()}}),e,null,[[7,18,21,24]])})));return function(t){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)}))),n.processHTML=function(){var e=Object(c.a)(r.a.mark((function e(t){var a,i,s,m,u,l,p,f,d,b,h;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=document.implementation.createHTMLDocument(),(i=a.createElement("div")).innerHTML=t,s=i.getElementsByTagName("a"),m=i.getElementsByTagName("img"),u=[],l=Object(o.a)(s);try{for(f=function(){var e=p.value,t=e.getAttribute("href");null!==t&&u.push(Object(c.a)(r.a.mark((function a(){return r.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.t0=e,a.next=3,n.getCompleteLink(t);case 3:a.t1=a.sent,a.t0.setAttribute.call(a.t0,"href",a.t1);case 5:case"end":return a.stop()}}),a)})))())},l.s();!(p=l.n()).done;)f()}catch(v){l.e(v)}finally{l.f()}d=Object(o.a)(m);try{for(h=function(){var e=b.value,t=e.getAttribute("src");null!==t&&u.push(Object(c.a)(r.a.mark((function a(){var o;return r.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,n.getImageURL(t);case 2:o=a.sent,n.objectURLs.push(o),e.setAttribute("src",o);case 5:case"end":return a.stop()}}),a)})))())},d.s();!(b=d.n()).done;)h()}catch(v){d.e(v)}finally{d.f()}return e.next=12,Promise.all(u);case 12:return e.abrupt("return",i.innerHTML);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.getCompleteLink=function(){var e=Object(c.a)(r.a.mark((function e(t){var a,o,c,i,s,m,u,l,p,f;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==t.length&&!v()(t)&&!y.a.isAbsolute(t)&&"#"!==t.charAt(0)&&"?"!==t.charAt(0)){e.next=4;break}return e.abrupt("return",t);case 4:return a=n.props.match.params,o=a.username,c=a.repositoryName,i=a.objectType,s=a.commitHash,m=a.path,u=n.state.mainBranchName,l=m?i===C.b.BLOB?y.a.join(y.a.dirname(m),t):y.a.join(m,t):y.a.join("",t),e.next=9,b.a.fileInfo({username:o},{name:c},l,s||u);case 9:if(null===(p=e.sent)){e.next=23;break}if((f=p.objectType)!==C.b.BLOB){e.next=16;break}return e.abrupt("return",d.Function.generateRepositoryCodeRoute({username:o,repositoryName:c,commitHash:s||u,path:l,objectType:C.b.BLOB}));case 16:if(f!==C.b.TREE){e.next=20;break}return e.abrupt("return",d.Function.generateRepositoryCodeRoute({username:o,repositoryName:c,commitHash:s||u,path:l,objectType:C.b.TREE}));case 20:return e.abrupt("return",d.Function.generateRepositoryCodeRoute({username:o,repositoryName:c,commitHash:s||u,path:l,objectType:C.b.COMMIT}));case 21:e.next=24;break;case 23:return e.abrupt("return",d.Function.generateRepositoryCodeRoute({username:o,repositoryName:c,commitHash:s||u,path:l,objectType:C.b.BLOB}));case 24:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.getImageURL=function(){var e=Object(c.a)(r.a.mark((function e(t){var a,o,c,i,s,m,u,l,p;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!v()(t)&&!y.a.isAbsolute(t)){e.next=4;break}return e.abrupt("return",t);case 4:return a=n.props.match.params,o=a.username,c=a.repositoryName,i=a.objectType,s=a.commitHash,m=a.path,u=n.state.mainBranchName,l=m?i===C.b.BLOB?y.a.join(y.a.dirname(m),t):y.a.join(m,t):y.a.join("",t),e.next=9,b.a.rawFile({username:o},{name:c},l,s||u);case 9:if(null===(p=e.sent)){e.next=14;break}return e.abrupt("return",URL.createObjectURL(p));case 14:return e.abrupt("return",t);case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.state={mainBranchName:"",loading:!1},n}return Object(s.a)(a,[{key:"componentDidMount",value:function(){var e=Object(c.a)(r.a.mark((function e(){var t;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.props.match.params.commitHash,this.setState({loading:!0}),"string"===typeof t){e.next=5;break}return e.next=5,this.loadMainBranchName();case 5:this.setState({loading:!1});case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(c.a)(r.a.mark((function e(t,a,n){var o,c;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=this.props.markdown,c=t.markdown,o===c){e.next=5;break}return e.next=5,this.componentDidMount();case 5:case"end":return e.stop()}}),e,this)})));return function(t,a,n){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){this.objectURLs.forEach((function(e){return URL.revokeObjectURL(e)}))}},{key:"render",value:function(){var e=this.state.loading,t=this.props.markdown;return p.a.createElement(j.a,{markdown:t,processHTML:this.processHTML,loading:e})}}]),a}(l.PureComponent),N=Object(f.j)(O)},1326:function(e,t,a){e.exports={FileReader:"Style_FileReader__3UwbJ",commitInfoBar:"Style_commitInfoBar__Q8via",contentWrapper:"Style_contentWrapper__WXjet",readerWrapper:"Style_readerWrapper__1-Blo",content:"Style_content___R5vO"}},1327:function(e,t,a){e.exports={CodeReader:"Style_CodeReader__yNPpi",line:"Style_line__2xQ8V",commentIcon:"Style_commentIcon__1fmDD",lineNumber:"Style_lineNumber__nX9YT",codeWrapper:"Style_codeWrapper__3J8o_",code:"Style_code__19ilK"}},1328:function(e,t,a){e.exports={MarkdownReader:"Style_MarkdownReader__2lNN5"}},1329:function(e,t,a){e.exports={CodeCommentDrawer:"Style_CodeCommentDrawer__1vYKD",top:"Style_top__1ZUZE",mid:"Style_mid__zKGSd",bottom:"Style_bottom__2avbu"}},1330:function(e,t,a){e.exports={CodeCommentForm:"Style_CodeCommentForm__1HwIU",textarea:"Style_textarea__3fx1d",buttonWrapper:"Style_buttonWrapper__3C6ZC"}},1331:function(e,t,a){e.exports={CodeCommentList:"Style_CodeCommentList__1G5Oh",itemWrapper:"Style_itemWrapper__3kY6G"}},1332:function(e,t,a){e.exports={CardTitle:"Style_CardTitle__271oV",modificationTimeWrapper:"Style_modificationTimeWrapper__2u105"}},1333:function(e,t,a){e.exports={CodeCommentItem:"Style_CodeCommentItem__3jXfA",contentWrapper:"Style_contentWrapper__3lLjk",bottomWrapper:"Style_bottomWrapper__AzNXW"}},1334:function(e,t,a){e.exports={CardBottom:"Style_CardBottom__52kk2"}},1335:function(e,t,a){e.exports={FileInfoBar:"Style_FileInfoBar__2_PqD",fileInfoWrapper:"Style_fileInfoWrapper__11WJK",fileNameWrapper:"Style_fileNameWrapper__AgwR-",fileName:"Style_fileName__3sh6Z"}},1339:function(e,t){},1340:function(e,t){},1341:function(e,t){},1342:function(e,t){},1343:function(e,t){},1346:function(e,t,a){e.exports={PDFReader:"Style_PDFReader__38Q-s",control:"Style_control__tcrMH"}},1347:function(e,t,a){e.exports={ImageViewer:"Style_ImageViewer__uLVEm",image:"Style_image__3l2_a"}},1395:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return Je}));var n={};a.r(n),a.d(n,"CODE_COMMENT_CHANGE",(function(){return q}));var r=a(1),o=a.n(r),c=a(4),i=a(92),s=a(0),m=a.n(s),u=a(1326),l=a.n(u),p=a(1407),f=a(1028),d=a(929);var b=m.a.memo((function(){return m.a.createElement(d.a,{type:"warning",showIcon:!0,message:"\u4e8c\u8fdb\u5236\u6587\u4ef6\u65e0\u6cd5\u663e\u793a",description:"\u4f60\u53ef\u4ee5\u76f4\u63a5\u4e0b\u8f7d\u67e5\u770b\u539f\u6587\u4ef6"})}));var h=m.a.memo((function(){return m.a.createElement(d.a,{type:"warning",showIcon:!0,message:"\u6587\u4ef6\u8fc7\u5927\uff0c\u4e0d\u80fd\u76f4\u63a5\u67e5\u770b",description:"\u4f60\u53ef\u4ee5\u76f4\u63a5\u4e0b\u8f7d\u67e5\u770b\u539f\u6587\u4ef6"})})),v=a(965),C=a.n(v),E=a(1327),y=a.n(E),j=a(1437),O=a(917),N=a(191);var _=m.a.memo((function(e){var t=e.processing,a=e.highlightedCodeLines,n=e.onCodeLineClickFactory,r=e.hasCommentLineNumbers,o=e.hasComment,c=e.hasLineNumber;return m.a.createElement(O.a,{spinning:t},m.a.createElement("table",{className:"".concat(y.a.CodeReader," hljs")},m.a.createElement("tbody",null,a.map((function(e,t){var a=m.a.createElement("tr",{key:t,className:y.a.line,style:o?{}:{cursor:"auto"},onClick:"function"===typeof n?n(t+1):void 0},m.a.createElement("td",{className:y.a.commentIcon},Array.isArray(r)&&r.includes(t+1)?m.a.createElement(j.a,null):null),c?m.a.createElement("td",null,m.a.createElement("code",{className:y.a.lineNumber},t+1)):null,m.a.createElement("td",{className:y.a.codeWrapper},m.a.createElement("pre",{className:y.a.code},m.a.createElement("code",{dangerouslySetInnerHTML:{__html:e}}))));return o?m.a.createElement(N.a,{key:t,title:"\u70b9\u51fb\u67e5\u770b\u548c\u6dfb\u52a0\u6279\u6ce8",placement:"left"},a):a})))))})),g=a(86);var k=m.a.memo((function(e){var t=e.fileContent,a=e.hasLineNumber,n=e.hasComment,r=e.onCodeLineClickFactory,o=e.hasCommentLineNumbers,c=Object(s.useState)([]),u=Object(i.a)(c,2),l=u[0],p=u[1],f=Object(s.useState)(!1),d=Object(i.a)(f,2),b=d[0],h=d[1];return Object(s.useEffect)((function(){h(!0),(t instanceof Blob?g.c.transformBlobToString(t):Promise.resolve(t)).then((function(e){return g.a.getHighlightedCodeLines(e)})).then((function(e){return p(e)})).finally((function(){return h(!1)}))}),[t]),m.a.createElement(_,{processing:b,hasLineNumber:a,hasComment:n,onCodeLineClickFactory:r,hasCommentLineNumbers:o,highlightedCodeLines:l})})),x=a(1328),w=a.n(x),S=a(1029);var L=m.a.memo((function(e){var t=e.markdown,a=e.loading;return m.a.createElement("div",{className:w.a.MarkdownReader},m.a.createElement(O.a,{spinning:a},m.a.createElement(S.a,{markdown:t})))}));var T=m.a.memo((function(e){var t=Object(s.useState)(""),a=Object(i.a)(t,2),n=a[0],r=a[1],u=Object(s.useState)(!0),l=Object(i.a)(u,2),p=l[0],f=l[1],d=e.fileContent;return Object(s.useEffect)((function(){(function(){var e=Object(c.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=r,e.next=3,g.c.transformBlobToString(d);case 3:e.t1=e.sent,(0,e.t0)(e.t1),f(!1);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()().then((function(){return f(!1)})),f(!0)}),[d]),m.a.createElement(L,{markdown:n,loading:p})})),R=a(1329),H=a.n(R),D=a(1415),M=a(16),B=a(18),U=a(43),W=a(42),P=a(1330),F=a.n(P),I=a(923),A=a(116);var z=m.a.memo((function(e){var t=e.onSubmit,a=e.codeComment,n=e.onCodeCommentChange,r=e.submitting;return m.a.createElement("form",{className:F.a.CodeCommentForm,onSubmit:t},m.a.createElement(I.a.TextArea,{onChange:n,value:a,autoFocus:!0,placeholder:"\u60f3\u8981\u8865\u5145\u4e9b\u4ec0\u4e48\uff1f",className:F.a.textarea,disabled:r}),m.a.createElement("div",{className:F.a.buttonWrapper},m.a.createElement(A.a,{htmlType:"submit",type:"primary",disabled:r,loading:r},"\u63d0\u4ea4")))})),G=a(120),V=a(67),J=a(337),X=a(37),Y=a(156),q="CODE_COMMENT_CHANGE",K=new Y.EventEmitter,Q=a(172),Z=function(e){Object(U.a)(a,e);var t=Object(W.a)(a);function a(e){var r;return Object(M.a)(this,a),(r=t.call(this,e)).setStatePromise=Object(G.promisify)(r.setState),r.init=Object(c.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.setStatePromise({codeComment:""});case 2:case"end":return e.stop()}}),e)}))),r.onCodeCommentChange=function(e){r.setState({codeComment:e.target.value})},r.onSubmit=function(){var e=Object(c.a)(o.a.mark((function e(t){var a,c,i,s,m,u,l,p;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),a=r.state.codeComment,Q.b.Repository.codeCommentContent(a)){e.next=6;break}J.a.error({message:Q.a.Repository.CODE_COMMENT_CONTENT}),e.next=19;break;case 6:return c=r.props,i=c.match.params,s=i.username,m=i.repositoryName,u=i.path,l=c.lineNumber,p=c.commitHash,e.next=9,r.setStatePromise({submitting:!0});case 9:return e.next=11,X.b.add({repositoryUsername:s,repositoryName:m,filePath:u,columnNumber:l,creationCommitHash:p,content:a});case 11:if(null===e.sent){e.next=17;break}return J.a.success({message:"\u4ee3\u7801\u6279\u6ce8\u6dfb\u52a0\u6210\u529f"}),e.next=16,r.init();case 16:K.emit(n.CODE_COMMENT_CHANGE);case 17:return e.next=19,r.setStatePromise({submitting:!1});case 19:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),r.state={codeComment:"",submitting:!1},r}return Object(B.a)(a,[{key:"componentDidMount",value:function(){var e=Object(c.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.init();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(c.a)(o.a.mark((function e(t,a,n){var r,c,i,s,m,u,l;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.props,c=r.commitHash,i=r.lineNumber,s=r.match.params.path,m=t.commitHash,u=t.lineNumber,l=t.match.params.path,c===m&&i===u&&s===l){e.next=5;break}return e.next=5,this.componentDidMount();case 5:case"end":return e.stop()}}),e,this)})));return function(t,a,n){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state,t=e.codeComment,a=e.submitting;return m.a.createElement(z,{submitting:a,codeComment:t,onSubmit:this.onSubmit,onCodeCommentChange:this.onCodeCommentChange})}}]),a}(s.PureComponent),$=Object(V.j)(Z),ee=a(1331),te=a.n(ee),ae=a(1436),ne=a(195),re=a(925),oe=a(1332),ce=a.n(oe),ie=a(340);var se=m.a.memo((function(e){var t=e.profile,a=t.username,n=t.email,r=e.modificationTimestamp,o=e.loading;return m.a.createElement(O.a,{spinning:o},m.a.createElement("div",{className:ce.a.CardTitle},m.a.createElement("div",{className:ce.a.personalCenterLinkWrapper},m.a.createElement(ie.a,{committerName:a,committerEmail:n})),m.a.createElement("div",{className:ce.a.modificationTimeWrapper},"\u6700\u540e\u7f16\u8f91\u4e8e ",g.b.parseTimestampToDate(r))))})),me=a(155),ue=function(e){Object(U.a)(a,e);var t=Object(W.a)(a);function a(e){var n;return Object(M.a)(this,a),(n=t.call(this,e)).setStatePromise=Object(G.promisify)(n.setState),n.loadProfile=Object(c.a)(o.a.mark((function e(){var t,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.props.creatorUsername,e.next=3,X.g.get({username:t});case 3:if(null===(a=e.sent)){e.next=7;break}return e.next=7,n.setStatePromise({profile:a});case 7:case"end":return e.stop()}}),e)}))),n.state={profile:new me.g("","","",""),loading:!1},n}return Object(B.a)(a,[{key:"componentDidMount",value:function(){var e=Object(c.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.setStatePromise({loading:!0});case 2:return e.next=4,this.loadProfile();case 4:return e.next=6,this.setStatePromise({loading:!1});case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(c.a)(o.a.mark((function e(t,a,n){var r,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.props.creatorUsername,c=t.creatorUsername,r===c){e.next=5;break}return e.next=5,this.componentDidMount();case 5:case"end":return e.stop()}}),e,this)})));return function(t,a,n){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state,t=e.profile,a=e.loading,n=this.props.modificationTimestamp;return m.a.createElement(se,{loading:a,profile:t,modificationTimestamp:n})}}]),a}(s.PureComponent),le=a(1333),pe=a.n(le),fe=a(1334),de=a.n(fe),be=a(918);var he=m.a.memo((function(e){var t=e.onDeleteButtonClick,a=e.loading;return m.a.createElement("div",{className:de.a.CardBottom},m.a.createElement("div",{className:de.a.buttonWrapper},m.a.createElement(be.a,{title:"\u786e\u8ba4\u5220\u9664\u4ee3\u7801\u6807\u6ce8\uff1f",placement:"topLeft",onConfirm:t,disabled:a},m.a.createElement(A.a,{size:"small",type:"primary",danger:!0,disabled:a,loading:a},"\u5220\u9664"))))})),ve=function(e){Object(U.a)(a,e);var t=Object(W.a)(a);function a(e){var r;return Object(M.a)(this,a),(r=t.call(this,e)).setStatePromise=Object(G.promisify)(r.setState),r.onDeleteButtonClick=Object(c.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.props.id,e.next=3,r.setStatePromise({loading:!0});case 3:return e.next=5,X.b.del({id:t});case 5:return null!==e.sent&&(J.a.success({message:"\u5220\u9664\u6807\u6ce8\u6210\u529f"}),K.emit(n.CODE_COMMENT_CHANGE)),e.next=9,r.setStatePromise({loading:!1});case 9:case"end":return e.stop()}}),e)}))),r.state={loading:!1},r}return Object(B.a)(a,[{key:"render",value:function(){var e=this.state.loading;return m.a.createElement(he,{loading:e,onDeleteButtonClick:this.onDeleteButtonClick})}}]),a}(s.PureComponent);var Ce=m.a.memo((function(e){var t=e.codeComment,a=t.creatorUsername,n=t.modificationTimestamp,r=t.content,o=t.id;return m.a.createElement("div",{className:pe.a.CodeCommentItem},m.a.createElement(re.a,{title:m.a.createElement(ue,{creatorUsername:a,modificationTimestamp:n})},m.a.createElement("div",{className:pe.a.contentWrapper},r),m.a.createElement("div",{className:pe.a.bottomWrapper},m.a.createElement(ve,{id:o}))))}));var Ee=m.a.memo((function(e){var t=e.codeComments,a=e.loading;return m.a.createElement("div",{className:te.a.CodeCommentList},m.a.createElement(ae.b,{loading:a,locale:{emptyText:m.a.createElement(ne.a,{description:"\u6ca1\u6709\u6279\u6ce8"})},dataSource:t,renderItem:function(e){return m.a.createElement("div",{className:te.a.itemWrapper,key:e.id},m.a.createElement(Ce,{codeComment:e}))}}))})),ye=function(e){Object(U.a)(a,e);var t=Object(W.a)(a);function a(e){var r;return Object(M.a)(this,a),(r=t.call(this,e)).setStatePromise=Object(G.promisify)(r.setState),r.onListChange=Object(c.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.componentDidMount();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),r.loadCodeComments=Object(c.a)(o.a.mark((function e(){var t,a,n,c,i,s,m,u,l;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.props,a=t.lineNumber,n=t.commitHash,c=t.match.params,i=c.repositoryName,s=c.path,m=c.username,e.next=3,X.b.get({repositoryUsername:m,repositoryName:i,columnNumber:a,filePath:s},n);case 3:if(null===(u=e.sent)){e.next=8;break}return l=u.codeComments,e.next=8,r.setStatePromise({codeComments:l});case 8:case"end":return e.stop()}}),e)}))),r.state={codeComments:[],loading:!1},K.on(n.CODE_COMMENT_CHANGE,r.onListChange),r}return Object(B.a)(a,[{key:"componentDidMount",value:function(){var e=Object(c.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.setStatePromise({loading:!0});case 2:return e.next=4,this.loadCodeComments();case 4:return e.next=6,this.setStatePromise({loading:!1});case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(c.a)(o.a.mark((function e(t,a,n){var r,c,i,s,m,u,l;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.props,c=r.lineNumber,i=r.commitHash,s=r.match.params.path,m=t.lineNumber,u=t.commitHash,l=t.match.params.path,c===m&&i===u&&s===l){e.next=5;break}return e.next=5,this.componentDidMount();case 5:case"end":return e.stop()}}),e,this)})));return function(t,a,n){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){K.removeListener(n.CODE_COMMENT_CHANGE,this.onListChange)}},{key:"render",value:function(){var e=this.state,t=e.loading,a=e.codeComments;return m.a.createElement(Ee,{loading:t,codeComments:a})}}]),a}(s.PureComponent),je=Object(V.j)(ye);var Oe=m.a.memo((function(e){var t=e.visible,a=e.fileName,n=e.code,r=e.onClose,o=e.lineNumber,c=e.commitHash;return m.a.createElement(D.a,{destroyOnClose:!0,title:m.a.createElement("div",{className:H.a.title},"\u4ee3\u7801\u6279\u6ce8 - ",a,":",o),visible:t,placement:"right",onClose:r,width:"33%"},m.a.createElement("div",{className:H.a.CodeCommentDrawer},m.a.createElement("div",{className:H.a.top},m.a.createElement(k,{fileContent:n,hasLineNumber:!1,hasComment:!1})),m.a.createElement("div",{className:H.a.mid},m.a.createElement(je,{commitHash:c,lineNumber:o})),m.a.createElement("div",{className:H.a.bottom},m.a.createElement($,{lineNumber:o,commitHash:c}))))})),Ne=a(1335),_e=a.n(Ne),ge=a(26),ke=a(68),xe=a(931),we=a(1438),Se=a(1393),Le=a(29);var Te=Object(V.j)((function(e){var t=e.fileSize,a=e.onRawFileButtonClick,n=e.match.params,r=n.username,o=n.repositoryName,c=n.commitHash,i=n.path,s=C.a.basename(i);return m.a.createElement("div",{className:_e.a.FileInfoBar},m.a.createElement("div",{className:_e.a.fileInfoWrapper},m.a.createElement("div",{className:_e.a.backLinkWrapper},m.a.createElement(ge.b,{to:ke.Function.generateRepositoryCodeRoute({username:r,repositoryName:o,commitHash:c,objectType:Le.b.TREE,path:C.a.join(i,"..")})},m.a.createElement(A.a,{size:"small"},m.a.createElement(we.a,null)))),m.a.createElement("div",{className:_e.a.fileNameWrapper},m.a.createElement(Se.a,null),m.a.createElement("div",{className:_e.a.fileName}," ",s)),m.a.createElement("div",{className:_e.a.fileSize},g.c.parseFileSize(t))),m.a.createElement(xe.b,{size:-1,className:_e.a.buttonWrapper},m.a.createElement(A.a,null,m.a.createElement(ge.b,{to:ke.Function.generateRepositoryCommitsRoute({username:r,repositoryName:o,commitHash:c,path:i})},"\u5386\u53f2")),m.a.createElement(A.a,{onClick:a},"\u4e0b\u8f7d")))})),Re=a(338);var He=m.a.memo((function(e){var t=e.fileSize,a=e.lastCommitHash,n=Object(V.i)().params,r=n.username,i=n.repositoryName,s=n.path,u=function(e){var t=URL.createObjectURL(e);g.c.startDownload(t,C.a.basename(s)),URL.revokeObjectURL(t)},l=function(){var e=Object(c.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Re.a.rawFile({username:r},{name:i},s,a);case 2:null!==(t=e.sent)&&u(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return m.a.createElement(Te,{fileSize:t,onRawFileButtonClick:l})})),De=a(1019);a(1345);De.c.GlobalWorkerOptions.workerSrc="/pdf.worker.min.js";var Me=a(1346),Be=a.n(Me),Ue=a(1387);var We=m.a.memo((function(e){var t=e.pdfURL,a=e.pageNumber,n=e.onPDFLoadSuccess,r=e.pageAmount,o=e.onPaginationChange;return m.a.createElement("div",{className:Be.a.PDFReader},m.a.createElement(De.a,{file:t,loading:m.a.createElement(O.a,{spinning:!0}),error:m.a.createElement(O.a,{spinning:!0}),onLoadSuccess:n},m.a.createElement(De.b,{pageNumber:a})),m.a.createElement("div",{className:Be.a.control},m.a.createElement(Ue.a,{pageSize:1,showSizeChanger:!1,showQuickJumper:!0,current:a,total:r,onChange:o})))}));var Pe=m.a.memo((function(e){var t=e.fileContent,a=Object(s.useState)(0),n=Object(i.a)(a,2),r=n[0],o=n[1],c=Object(s.useState)(1),u=Object(i.a)(c,2),l=u[0],p=u[1],f=Object(s.useState)(""),d=Object(i.a)(f,2),b=d[0],h=d[1];return Object(s.useEffect)((function(){h(URL.createObjectURL(t))}),[t]),Object(s.useEffect)((function(){return function(){return URL.revokeObjectURL(b)}}),[b]),m.a.createElement(We,{pageNumber:l,pdfURL:b,pageAmount:r,onPaginationChange:function(e){p(e)},onPDFLoadSuccess:function(e){var t=e.numPages;o(t)}})})),Fe=a(1347),Ie=a.n(Fe);var Ae=m.a.memo((function(e){var t=e.url,a=e.loading;return m.a.createElement("div",{className:Ie.a.ImageViewer},m.a.createElement(O.a,{spinning:a},m.a.createElement("img",{src:t,alt:"file preview",className:Ie.a.image})))}));var ze=m.a.memo((function(e){var t=Object(s.useState)(""),a=Object(i.a)(t,2),n=a[0],r=a[1],o=e.fileContent,c=e.loading;return Object(s.useLayoutEffect)((function(){var e=URL.createObjectURL(o);return r(e),function(){return URL.revokeObjectURL(e)}}),[o]),m.a.createElement(Ae,{url:n,loading:c})}));var Ge=m.a.memo((function(e){var t=[".md",".markdown",".mdwn"],a=e.isOversize,n=e.lastCommit,r=e.loading,o=e.fileContent,c=e.fileType,i=e.fileSize,s=e.fileName,u=e.onCodeLineClickFactory,d=e.hasCommentLineNumbers,v=e.drawerCode,E=e.drawerLineNumber,y=e.drawerVisible,j=e.onDrawerClose,O=C.a.extname(s).toLowerCase(),N=c.toLowerCase(),_=N.includes("text");return m.a.createElement(m.a.Fragment,null,m.a.createElement("div",{className:l.a.FileReader},m.a.createElement(p.a,{loading:r,active:!0},m.a.createElement("div",{className:l.a.commitInfoBar},m.a.createElement(f.a,{lastCommit:n})),m.a.createElement("div",{className:l.a.contentWrapper},m.a.createElement("div",{className:l.a.fileInfoBarWrapper},m.a.createElement(He,{fileSize:i,lastCommitHash:n.commitHash})),m.a.createElement("div",{className:l.a.readerWrapper},a?m.a.createElement(h,null):_&&t.includes(O)?m.a.createElement(T,{fileContent:o}):N.includes("pdf")?m.a.createElement(Pe,{fileContent:o}):_||N.includes("json")?m.a.createElement(k,{fileContent:o,hasComment:!0,hasLineNumber:!0,onCodeLineClickFactory:u,hasCommentLineNumbers:d}):N.includes("image")?m.a.createElement(ze,{loading:r,fileContent:o}):m.a.createElement(b,null))))),m.a.createElement(Oe,{lineNumber:E,code:v,visible:y,fileName:s,onClose:j,commitHash:n.commitHash}))})),Ve=a(347);var Je=m.a.memo((function(){var e=Object(s.useState)(!1),t=Object(i.a)(e,2),a=t[0],r=t[1],u=Object(s.useState)(new me.b("","","",0,"","")),l=Object(i.a)(u,2),p=l[0],f=l[1],d=Object(s.useState)(!1),b=Object(i.a)(d,2),h=b[0],C=b[1],E=Object(s.useState)(!1),y=Object(i.a)(E,2),j=y[0],O=y[1],N=Object(s.useState)("text"),_=Object(i.a)(N,2),k=_[0],x=_[1],w=Object(s.useState)(new Blob),S=Object(i.a)(w,2),L=S[0],T=S[1],R=Object(s.useState)(0),H=Object(i.a)(R,2),D=H[0],M=H[1],B=Object(s.useState)([]),U=Object(i.a)(B,2),W=U[0],P=U[1],F=Object(s.useState)(!1),I=Object(i.a)(F,2),A=I[0],z=I[1],G=Object(s.useState)(""),J=Object(i.a)(G,2),Y=J[0],q=J[1],Q=Object(s.useState)(0),Z=Object(i.a)(Q,2),$=Z[0],ee=Z[1],te=Object(V.i)().params,ae=te.username,ne=te.repositoryName,re=te.path,oe=te.commitHash,ce=Object(V.f)(),ie=Object(s.useMemo)((function(){return W.map((function(e){return e.columnNumber}))}),[W]),se=Object(s.useMemo)((function(){return Object(c.a)(o.a.mark((function e(){var t,a,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return O(!0),t=p.commitHash,e.next=4,X.b.get({repositoryUsername:ae,repositoryName:ne,filePath:re},t);case 4:null!==(a=e.sent)&&(n=a.codeComments,P(n)),O(!1);case 7:case"end":return e.stop()}}),e)})))}),[p,ae,ne,re]);Object(s.useEffect)((function(){var e=function(){var e=Object(c.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,se();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return K.on(n.CODE_COMMENT_CHANGE,e),function(){K.removeListener(n.CODE_COMMENT_CHANGE,e)}}),[se]),Object(s.useEffect)((function(){var e=function(){var e=Object(c.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,X.j.lastBranchCommit({username:ae},{name:ne},oe,re);case 2:null!==(t=e.sent)&&f(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();O(!0),C(!1),e().then((function(){return C(!0)})).finally((function(){return O(!1)}))}),[ae,ne,re,oe]),Object(s.useEffect)((function(){var e=function(){var e=Object(c.a)(o.a.mark((function e(){var t,a,n,c,i,s;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=p.commitHash,e.next=3,X.j.fileInfo({username:ae},{name:ne},re,t);case 3:if(null===(a=e.sent)){e.next=15;break}if(n=a.fileType,c=a.objectType,i=a.fileSize,null!==c){e.next=10;break}return e.abrupt("return",ce.replace(Ve.c[Ve.a.NOT_FOUND]));case 10:M(i),x(n),s=n.toLowerCase().includes("text"),r(s?i>131072:i>5242880);case 15:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();h&&(O(!0),e().finally((function(){return O(!1)})))}),[p,ae,ne,re,ce,h,5242880,131072]),Object(s.useEffect)((function(){h&&(O(!0),se().finally((function(){return O(!1)})))}),[se,h]),Object(s.useEffect)((function(){var e=function(){var e=Object(c.a)(o.a.mark((function e(){var t,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=p.commitHash,e.next=3,X.j.rawFile({username:ae},{name:ne},re,t);case 3:null!==(a=e.sent)&&T(a);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();!a&&h&&(O(!0),e().finally((function(){return O(!1)})))}),[a,ae,ne,re,p,h]);var ue=Object(s.useCallback)((function(e){return Object(c.a)(o.a.mark((function t(){var a;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return ee(e),t.next=3,g.c.transformBlobToString(L);case 3:a=t.sent.split("\n"),q(a[e-1].trim()),z(!0);case 6:case"end":return t.stop()}}),t)})))}),[L]),le=Object(v.basename)(re);return m.a.createElement(Ge,{fileSize:D,fileContent:L,fileType:k,fileName:le,isOversize:a,lastCommit:p,loading:j,hasCommentLineNumbers:ie,onCodeLineClickFactory:ue,drawerCode:Y,drawerLineNumber:$,drawerVisible:A,onDrawerClose:function(){z(!1)}})}))}}]);
//# sourceMappingURL=13.11cd2bc7.chunk.js.map