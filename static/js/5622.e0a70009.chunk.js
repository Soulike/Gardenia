"use strict";(self.webpackChunksoulike_git=self.webpackChunksoulike_git||[]).push([[5622],{75622:function(ee,S,r){r.r(S),r.d(S,{default:function(){return Q}});var e=r(89526),E={PullRequests:"Style_PullRequests__wwkBX",list:"Style_list__zJ981",header:"Style_header__fj1uT",statusFilter:"Style_statusFilter__n1zCD",tag:"Style_tag__5Y-WO",pageButtonWrapper:"Style_pageButtonWrapper__wl6F1"},W=r(5892),v=r(65293),P=r(30592),R=r(75113),G=r(565),f=r(65092),A=r(18440),a=r(76320),C={PullRequests:"Style_PullRequests__8QJ+p",emptyWrapper:"Style_emptyWrapper__8UG8J"},y={PullRequest:"Style_PullRequest__ufBzR",titleWrapper:"Style_titleWrapper__Pw+Mf",iconWrapper:"Style_iconWrapper__LBaE9",info:"Style_info__N9lfl"},q=r(14006),Z=r(17431),B=r(90566),O=r(70281),k=r(57428);function F(o){const{pullRequest:{title:t,status:l,creationTime:s,no:n,sourceRepositoryUsername:u,targetRepositoryUsername:i,targetRepositoryName:m}}=o;return e.createElement("div",{className:y.PullRequest},e.createElement("div",{className:y.titleWrapper},e.createElement("div",{className:y.iconWrapper,style:{color:M(l)}},I(l)),e.createElement(k.Z,{to:A.Function.generateRepositoryPullRequestRoute({username:i,repositoryName:m,no:n.toString()})},e.createElement("div",{className:y.title},t))),e.createElement("div",{className:y.info},"#",n," \u7531 ",e.createElement("b",null,u)," \u4E8E ",q.Ej.parseTimestampToDifference(s)," \u521B\u5EFA"))}function I(o){switch(o){case a.El.CLOSED:return e.createElement(Z.Z,null);case a.El.MERGED:return e.createElement(B.Z,null);case a.El.OPEN:return e.createElement(O.Z,null)}}function M(o){switch(o){case a.El.CLOSED:return"red";case a.El.MERGED:return"purple";case a.El.OPEN:return"green"}}var L=e.memo(F),b=r(37109);function z(o){const{pullRequests:t}=o;return e.createElement("div",{className:C.PullRequests},t.length>0?t.map(l=>e.createElement(L,{pullRequest:l,key:l.id})):e.createElement("div",{className:C.emptyWrapper},e.createElement(b.Z,{description:"\u6CA1\u6709\u7B26\u5408\u6761\u4EF6\u7684 Pull Request"})))}var T=e.memo(z),x=r(30421),U=r(58047);function J(o){const{branches:t,loading:l,match:{params:{username:s,repositoryName:n}},openAmount:u,closedAmount:i,mergedAmount:m,onStatusButtonClick:c,currentStatus:h,currentPageNumber:X,pullRequests:Y,onNextButtonClick:w,onPrevButtonClick:H,noNextPage:K}=o;let g="";for(const{isDefault:$,name:_}of t)$&&(g=_);return e.createElement("div",{className:E.PullRequests},e.createElement(W.Z,{spinning:l},e.createElement("div",{className:E.list},e.createElement("div",{className:E.header},e.createElement("div",{className:E.statusFilter},e.createElement(v.Z,{size:-1},e.createElement(P.Z,{size:"small",type:"link",style:{color:"unset",fontWeight:h===void 0?"bolder":"inherit"},onClick:c(void 0)},e.createElement(x.Z,null)," \u6240\u6709",e.createElement(R.Z,{className:E.tag},u+i+m)),e.createElement(P.Z,{size:"small",type:"link",style:{color:"green",fontWeight:h===a.El.OPEN?"bolder":"inherit"},onClick:c(a.El.OPEN)},e.createElement(O.Z,null)," \u5F00\u542F\u7684",e.createElement(R.Z,{className:E.tag},u)),e.createElement(P.Z,{size:"small",type:"link",style:{color:"red",fontWeight:h===a.El.CLOSED?"bolder":"inherit"},onClick:c(a.El.CLOSED)},e.createElement(Z.Z,null)," \u5DF2\u5173\u95ED",e.createElement(R.Z,{className:E.tag},i)),e.createElement(P.Z,{size:"small",type:"link",style:{color:"purple",fontWeight:h===a.El.MERGED?"bolder":"inherit"},onClick:c(a.El.MERGED)},e.createElement(B.Z,null)," \u5DF2\u5408\u5E76",e.createElement(R.Z,{className:E.tag},m)))),e.createElement("div",{className:E.buttonWrapper},e.createElement(G.rU,{to:A.Function.generateRepositoryCompareRoute({sourceRepositoryUsername:s,sourceRepositoryName:n,sourceRepositoryBranch:g,targetRepositoryBranch:g,repositoryName:n,username:s})},e.createElement(P.Z,{type:"primary"},e.createElement(U.Z,null),"\u521B\u5EFA Pull Request")))),e.createElement("div",{className:E.pullRequestListWrapper},e.createElement(T,{pullRequests:Y}))),e.createElement("div",{className:E.pageButtonWrapper},e.createElement(v.Z,{size:-1},e.createElement(P.Z,{disabled:X===0,onClick:H},"\u4E0A\u4E00\u9875"),e.createElement(P.Z,{onClick:w,disabled:K},"\u4E0B\u4E00\u9875")))))}var V=(0,f.EN)(e.memo(J)),j=r(19237),N=r(62371),p=(o,t,l)=>new Promise((s,n)=>{var u=c=>{try{m(l.next(c))}catch(h){n(h)}},i=c=>{try{m(l.throw(c))}catch(h){n(h)}},m=c=>c.done?s(c.value):Promise.resolve(c.value).then(u,i);m((l=l.apply(o,t)).next())});const d=class extends e.PureComponent{constructor(o){super(o);this.onStatusButtonClick=t=>()=>p(this,null,function*(){switch(this.setState({currentStatus:t,loading:!0,currentPageNumber:0}),t){case a.El.OPEN:{yield this.loadOpenAmount();break}case a.El.MERGED:{yield this.loadMergedAmount();break}case a.El.CLOSED:{yield this.loadClosedAmount();break}default:{yield Promise.all([this.loadOpenAmount(),this.loadClosedAmount(),this.loadMergedAmount()]);break}}yield this.loadPullRequests(t,0,d.SIZE_PER_PAGE),this.setState({loading:!1})}),this.onPrevButtonClick=()=>p(this,null,function*(){const{currentPageNumber:t,currentStatus:l}=this.state;t>0&&(this.setState({loading:!0}),yield this.loadPullRequests(l,(t-1)*d.SIZE_PER_PAGE,d.SIZE_PER_PAGE),this.setState({currentPageNumber:t-1,loading:!1}),window.scrollTo({top:0,behavior:"smooth"}))}),this.onNextButtonClick=()=>p(this,null,function*(){const{currentPageNumber:t,currentStatus:l}=this.state;this.setState({loading:!0}),yield this.loadPullRequests(l,(t+1)*d.SIZE_PER_PAGE,d.SIZE_PER_PAGE),this.setState({currentPageNumber:t+1,loading:!1}),window.scrollTo({top:0,behavior:"smooth"})}),this.loadPullRequests=(t,l,s)=>p(this,null,function*(){const{match:{params:{username:n,repositoryName:u}}}=this.props,i=yield N.i7.getByRepository({username:n,name:u},t,l,s);if(i!==null){const{pullRequests:m}=i;this.setState({pullRequests:m})}}),this.loadBranches=()=>p(this,null,function*(){const{match:{params:{username:t,repositoryName:l}}}=this.props,s=yield j.C.branches({username:t,name:l});if(s!==null){const{branches:n}=s;this.setState({branches:n})}}),this.loadOpenAmount=()=>p(this,null,function*(){const{match:{params:{username:t,repositoryName:l}}}=this.props,s=yield N.i7.getPullRequestAmount({username:t,name:l},a.El.OPEN);if(s!==null){const{amount:n}=s;this.setState({openAmount:n})}}),this.loadClosedAmount=()=>p(this,null,function*(){const{match:{params:{username:t,repositoryName:l}}}=this.props,s=yield N.i7.getPullRequestAmount({username:t,name:l},a.El.CLOSED);if(s!==null){const{amount:n}=s;this.setState({closedAmount:n})}}),this.loadMergedAmount=()=>p(this,null,function*(){const{match:{params:{username:t,repositoryName:l}}}=this.props,s=yield N.i7.getPullRequestAmount({username:t,name:l},a.El.MERGED);if(s!==null){const{amount:n}=s;this.setState({mergedAmount:n})}}),this.setNoNextPage=()=>{const{currentStatus:t,currentPageNumber:l,openAmount:s,closedAmount:n,mergedAmount:u}=this.state;switch(t){case a.El.CLOSED:return(l+1)*d.SIZE_PER_PAGE>=n;case a.El.MERGED:return(l+1)*d.SIZE_PER_PAGE>=u;case a.El.OPEN:return(l+1)*d.SIZE_PER_PAGE>=s;default:return(l+1)*d.SIZE_PER_PAGE>=s+n+u}},this.state={branches:[],loading:!1,openAmount:0,closedAmount:0,mergedAmount:0,pullRequests:[],currentStatus:a.El.OPEN,currentPageNumber:0}}componentDidMount(){return p(this,null,function*(){this.setState({loading:!0}),yield Promise.all([this.loadBranches(),this.loadOpenAmount(),this.loadClosedAmount(),this.loadMergedAmount(),this.loadPullRequests(a.El.OPEN,0,d.SIZE_PER_PAGE)]),this.setState({loading:!1})})}componentDidUpdate(o,t,l){return p(this,null,function*(){const{match:{params:{username:s,repositoryName:n}}}=this.props,{match:{params:{username:u,repositoryName:i}}}=o;(s!==u||n!==i)&&(yield this.componentDidMount())})}render(){const{branches:o,loading:t,closedAmount:l,mergedAmount:s,openAmount:n,pullRequests:u,currentStatus:i,currentPageNumber:m}=this.state;return e.createElement(V,{branches:o,loading:t,closedAmount:l,mergedAmount:s,openAmount:n,pullRequests:u,currentStatus:i,currentPageNumber:m,onStatusButtonClick:this.onStatusButtonClick,onNextButtonClick:this.onNextButtonClick,onPrevButtonClick:this.onPrevButtonClick,noNextPage:this.setNoNextPage()})}};let D=d;D.SIZE_PER_PAGE=20;var Q=(0,f.EN)(D)}}]);

//# sourceMappingURL=5622.e0a70009.chunk.js.map