(self.webpackChunksoulike_git=self.webpackChunksoulike_git||[]).push([[9681],{83538:function(Ce,V,s){"use strict";s.d(V,{Z:function(){return X}});var e=s(89526),g={CommitInfoBar:"Style_CommitInfoBar__pCbNv",left:"Style_left__A3Sb6",right:"Style_right__HAMLz",message:"Style_message__YDsy6"},M=s(565),Z=s(65092),z=s(18440),x=s(43546),B=s(14006),k=s(55291);function F(S){const{lastCommit:{committerName:w,commitHash:W,message:P,timestamp:N,committerEmail:d},match:{params:{username:E,repositoryName:f}}}=S;return e.createElement("div",{className:g.CommitInfoBar},e.createElement("div",{className:g.left},e.createElement(k.Z,{committerEmail:d,committerName:w}),e.createElement("div",{className:g.message},P)),e.createElement("div",{className:g.right},e.createElement("div",{className:g.time},B.Ej.parseTimestampToDifference(N)),e.createElement(x.Z,{title:W},e.createElement("div",{className:g.commitHash},"\u6700\u540E\u63D0\u4EA4\uFF1A",e.createElement(M.rU,{to:z.Function.generateRepositoryCommitRoute({username:E,repositoryName:f,commitHash:W})},W.slice(0,7))))))}var X=(0,Z.EN)(e.memo(F))},42419:function(Ce,V,s){"use strict";s.r(V),s.d(V,{default:function(){return Dt}});var e=s(89526),g={FileReader:"Style_FileReader__VYWMk",commitInfoBar:"Style_commitInfoBar__pc96f",contentWrapper:"Style_contentWrapper__1QyzE",readerWrapper:"Style_readerWrapper__sskDO",content:"Style_content__b0lNF"},M=s(97025),Z=s(83538),z=s(53546);function x(){return e.createElement(z.Z,{type:"warning",showIcon:!0,message:"\u4E8C\u8FDB\u5236\u6587\u4EF6\u65E0\u6CD5\u663E\u793A",description:"\u4F60\u53EF\u4EE5\u76F4\u63A5\u4E0B\u8F7D\u67E5\u770B\u539F\u6587\u4EF6"})}var B=e.memo(x);function k(){return e.createElement(z.Z,{type:"warning",showIcon:!0,message:"\u6587\u4EF6\u8FC7\u5927\uFF0C\u4E0D\u80FD\u76F4\u63A5\u67E5\u770B",description:"\u4F60\u53EF\u4EE5\u76F4\u63A5\u4E0B\u8F7D\u67E5\u770B\u539F\u6587\u4EF6"})}var F=e.memo(k),X=s(89368),S=s.n(X),w={CodeReader:"Style_CodeReader__5j23m",line:"Style_line__xH01W",commentIcon:"Style_commentIcon__z4nnu",lineNumber:"Style_lineNumber__eJtk2",codeWrapper:"Style_codeWrapper__V2+Ya",code:"Style_code__f+42a"},W=s(97028),P=s(5892),N=s(43546);function d(m){const{processing:o,highlightedCodeLines:t,onCodeLineClickFactory:r,hasCommentLineNumbers:a,hasComment:i,hasLineNumber:u}=m;return e.createElement(P.Z,{spinning:o},e.createElement("table",{className:`${w.CodeReader} hljs`},e.createElement("tbody",null,t.map((l,n)=>{const c=e.createElement("tr",{key:n,className:w.line,style:i?{}:{cursor:"auto"},onClick:typeof r=="function"?r(n+1):void 0},e.createElement("td",{className:w.commentIcon},Array.isArray(a)&&a.includes(n+1)?e.createElement(W.Z,null):null),u?e.createElement("td",null,e.createElement("code",{className:w.lineNumber},n+1)):null,e.createElement("td",{className:w.codeWrapper},e.createElement("pre",{className:w.code},e.createElement("code",{dangerouslySetInnerHTML:{__html:l}}))));return i?e.createElement(N.Z,{key:n,title:"\u70B9\u51FB\u67E5\u770B\u548C\u6DFB\u52A0\u6279\u6CE8",placement:"left"},c):c}))))}var E=e.memo(d),f=s(14006);function R(m){const{fileContent:o,hasLineNumber:t,hasComment:r,onCodeLineClickFactory:a,hasCommentLineNumbers:i}=m,[u,l]=(0,e.useState)([]),[n,c]=(0,e.useState)(!1);return(0,e.useEffect)(()=>{c(!0);let T;o instanceof Blob?T=f.$B.transformBlobToString(o):T=Promise.resolve(o),T.then(y=>f.EK.getHighlightedCodeLines(y)).then(y=>l(y)).finally(()=>c(!1))},[o]),e.createElement(E,{processing:n,hasLineNumber:t,hasComment:r,onCodeLineClickFactory:a,hasCommentLineNumbers:i,highlightedCodeLines:u})}var p=e.memo(R),C={MarkdownReader:"Style_MarkdownReader__KdJHV"},h=s(55327);function v(m){const{markdown:o,loading:t}=m;return e.createElement("div",{className:C.MarkdownReader},e.createElement(P.Z,{spinning:t},e.createElement(h.Z,{markdown:o})))}var D=e.memo(v),ee=(m,o,t)=>new Promise((r,a)=>{var i=n=>{try{l(t.next(n))}catch(c){a(c)}},u=n=>{try{l(t.throw(n))}catch(c){a(c)}},l=n=>n.done?r(n.value):Promise.resolve(n.value).then(i,u);l((t=t.apply(m,o)).next())});function we(m){const[o,t]=(0,e.useState)(""),[r,a]=(0,e.useState)(!0),{fileContent:i}=m;return(0,e.useEffect)(()=>{(()=>ee(this,null,function*(){t(yield f.$B.transformBlobToString(i)),a(!1)}))().then(()=>a(!1)),a(!0)},[i]),e.createElement(D,{markdown:o,loading:r})}var De=e.memo(we),Q={CodeCommentDrawer:"Style_CodeCommentDrawer__1aLLG",top:"Style_top__67MPV",mid:"Style_mid__LZdRC",bottom:"Style_bottom__OKUbn"},be=s(37136),se={CodeCommentForm:"Style_CodeCommentForm__DLtYy",textarea:"Style_textarea__xbhrc",buttonWrapper:"Style_buttonWrapper__jpzWt"},Me=s(32014),_=s(30592);function Ae(m){const{onSubmit:o,codeComment:t,onCodeCommentChange:r,submitting:a}=m;return e.createElement("form",{className:se.CodeCommentForm,onSubmit:o},e.createElement(Me.Z.TextArea,{onChange:r,value:t,autoFocus:!0,placeholder:"\u60F3\u8981\u8865\u5145\u4E9B\u4EC0\u4E48\uFF1F",className:se.textarea,disabled:a}),e.createElement("div",{className:se.buttonWrapper},e.createElement(_.Z,{htmlType:"submit",type:"primary",disabled:a,loading:a},"\u63D0\u4EA4")))}var He=e.memo(Ae),te=s(85663),Y=s(65092),ie=s(24315),A=s(62371),Ue=s(5939);const $="CODE_COMMENT_CHANGE";var G=new Ue.EventEmitter,Ze=s(50526),We=s(52518),ne=(m,o,t)=>new Promise((r,a)=>{var i=n=>{try{l(t.next(n))}catch(c){a(c)}},u=n=>{try{l(t.throw(n))}catch(c){a(c)}},l=n=>n.done?r(n.value):Promise.resolve(n.value).then(i,u);l((t=t.apply(m,o)).next())});class je extends e.PureComponent{constructor(o){super(o);this.setStatePromise=(0,te.promisify)(this.setState),this.init=()=>ne(this,null,function*(){yield this.setStatePromise({codeComment:""})}),this.onCodeCommentChange=t=>{this.setState({codeComment:t.target.value})},this.onSubmit=t=>ne(this,null,function*(){t.preventDefault();const{codeComment:r}=this.state;if(!Ze.codeCommentContent(r))ie.Z.error({message:We.YW});else{const{match:{params:{username:a,repositoryName:i,path:u}},lineNumber:l,commitHash:n}=this.props;yield this.setStatePromise({submitting:!0}),(yield A.Ay.add({repositoryUsername:a,repositoryName:i,filePath:u,columnNumber:l,creationCommitHash:n,content:r}))!==null&&(ie.Z.success({message:"\u4EE3\u7801\u6279\u6CE8\u6DFB\u52A0\u6210\u529F"}),yield this.init(),G.emit($)),yield this.setStatePromise({submitting:!1})}}),this.state={codeComment:"",submitting:!1}}componentDidMount(){return ne(this,null,function*(){yield this.init()})}componentDidUpdate(o,t,r){return ne(this,null,function*(){const{commitHash:a,lineNumber:i,match:{params:{path:u}}}=this.props,{commitHash:l,lineNumber:n,match:{params:{path:c}}}=o;(a!==l||i!==n||u!==c)&&(yield this.componentDidMount())})}render(){const{codeComment:o,submitting:t}=this.state;return e.createElement(He,{submitting:t,codeComment:o,onSubmit:this.onSubmit,onCodeCommentChange:this.onCodeCommentChange})}}var Oe=(0,Y.EN)(je),ve={CodeCommentList:"Style_CodeCommentList__Lb0-t",itemWrapper:"Style_itemWrapper__zuwD1"},Ve=s(39207),ze=s(37109),xe=s(34405),me={CardTitle:"Style_CardTitle__H598x",modificationTimeWrapper:"Style_modificationTimeWrapper__b-UNw"},Xe=s(55291);function Ye(m){const{profile:{username:o,email:t},modificationTimestamp:r,loading:a}=m;return e.createElement(P.Z,{spinning:a},e.createElement("div",{className:me.CardTitle},e.createElement("div",{className:me.personalCenterLinkWrapper},e.createElement(Xe.Z,{committerName:o,committerEmail:t})),e.createElement("div",{className:me.modificationTimeWrapper},"\u6700\u540E\u7F16\u8F91\u4E8E ",f.Ej.parseTimestampToDate(r))))}var $e=e.memo(Ye),ye=s(60269),le=(m,o,t)=>new Promise((r,a)=>{var i=n=>{try{l(t.next(n))}catch(c){a(c)}},u=n=>{try{l(t.throw(n))}catch(c){a(c)}},l=n=>n.done?r(n.value):Promise.resolve(n.value).then(i,u);l((t=t.apply(m,o)).next())});class Ge extends e.PureComponent{constructor(o){super(o);this.setStatePromise=(0,te.promisify)(this.setState),this.loadProfile=()=>le(this,null,function*(){const{creatorUsername:t}=this.props,r=yield A.NZ.get({username:t});r!==null&&(yield this.setStatePromise({profile:r}))}),this.state={profile:new ye.NZ("","","",""),loading:!1}}componentDidMount(){return le(this,null,function*(){yield this.setStatePromise({loading:!0}),yield this.loadProfile(),yield this.setStatePromise({loading:!1})})}componentDidUpdate(o,t,r){return le(this,null,function*(){const{creatorUsername:a}=this.props,{creatorUsername:i}=o;a!==i&&(yield this.componentDidMount())})}render(){const{profile:o,loading:t}=this.state,{modificationTimestamp:r}=this.props;return e.createElement($e,{loading:t,profile:o,modificationTimestamp:r})}}var Je=Ge,ce={CodeCommentItem:"Style_CodeCommentItem__ZmjbC",contentWrapper:"Style_contentWrapper__jG0wY",bottomWrapper:"Style_bottomWrapper__coFeD"},Ee={CardBottom:"Style_CardBottom__Jygm2"},Ke=s(23377);function ke(m){const{onDeleteButtonClick:o,loading:t}=m;return e.createElement("div",{className:Ee.CardBottom},e.createElement("div",{className:Ee.buttonWrapper},e.createElement(Ke.Z,{title:"\u786E\u8BA4\u5220\u9664\u4EE3\u7801\u6807\u6CE8\uFF1F",placement:"topLeft",onConfirm:o,disabled:t},e.createElement(_.Z,{size:"small",type:"primary",danger:!0,disabled:t,loading:t},"\u5220\u9664"))))}var Qe=e.memo(ke),_e=(m,o,t)=>new Promise((r,a)=>{var i=n=>{try{l(t.next(n))}catch(c){a(c)}},u=n=>{try{l(t.throw(n))}catch(c){a(c)}},l=n=>n.done?r(n.value):Promise.resolve(n.value).then(i,u);l((t=t.apply(m,o)).next())});class qe extends e.PureComponent{constructor(o){super(o);this.setStatePromise=(0,te.promisify)(this.setState),this.onDeleteButtonClick=()=>_e(this,null,function*(){const{id:t}=this.props;yield this.setStatePromise({loading:!0}),(yield A.Ay.del({id:t}))!==null&&(ie.Z.success({message:"\u5220\u9664\u6807\u6CE8\u6210\u529F"}),G.emit($)),yield this.setStatePromise({loading:!1})}),this.state={loading:!1}}render(){const{loading:o}=this.state;return e.createElement(Qe,{loading:o,onDeleteButtonClick:this.onDeleteButtonClick})}}var et=qe;function tt(m){const{codeComment:{creatorUsername:o,modificationTimestamp:t,content:r,id:a}}=m;return e.createElement("div",{className:ce.CodeCommentItem},e.createElement(xe.Z,{title:e.createElement(Je,{creatorUsername:o,modificationTimestamp:t})},e.createElement("div",{className:ce.contentWrapper},r),e.createElement("div",{className:ce.bottomWrapper},e.createElement(et,{id:a}))))}var nt=e.memo(tt);function ot(m){const{codeComments:o,loading:t}=m;return e.createElement("div",{className:ve.CodeCommentList},e.createElement(Ve.ZP,{loading:t,locale:{emptyText:e.createElement(ze.Z,{description:"\u6CA1\u6709\u6279\u6CE8"})},dataSource:o,renderItem:r=>e.createElement("div",{className:ve.itemWrapper,key:r.id},e.createElement(nt,{codeComment:r}))}))}var at=e.memo(ot),oe=(m,o,t)=>new Promise((r,a)=>{var i=n=>{try{l(t.next(n))}catch(c){a(c)}},u=n=>{try{l(t.throw(n))}catch(c){a(c)}},l=n=>n.done?r(n.value):Promise.resolve(n.value).then(i,u);l((t=t.apply(m,o)).next())});class rt extends e.PureComponent{constructor(o){super(o);this.setStatePromise=(0,te.promisify)(this.setState),this.onListChange=()=>oe(this,null,function*(){return yield this.componentDidMount()}),this.loadCodeComments=()=>oe(this,null,function*(){const{lineNumber:t,commitHash:r,match:{params:{repositoryName:a,path:i,username:u}}}=this.props,l=yield A.Ay.get({repositoryUsername:u,repositoryName:a,columnNumber:t,filePath:i},r);if(l!==null){const{codeComments:n}=l;yield this.setStatePromise({codeComments:n})}}),this.state={codeComments:[],loading:!1},G.on($,this.onListChange)}componentDidMount(){return oe(this,null,function*(){yield this.setStatePromise({loading:!0}),yield this.loadCodeComments(),yield this.setStatePromise({loading:!1})})}componentDidUpdate(o,t,r){return oe(this,null,function*(){const{lineNumber:a,commitHash:i,match:{params:{path:u}}}=this.props,{lineNumber:l,commitHash:n,match:{params:{path:c}}}=o;(a!==l||i!==n||u!==c)&&(yield this.componentDidMount())})}componentWillUnmount(){G.removeListener($,this.onListChange)}render(){const{loading:o,codeComments:t}=this.state;return e.createElement(at,{loading:o,codeComments:t})}}var st=(0,Y.EN)(rt);function it(m){const{visible:o,fileName:t,code:r,onClose:a,lineNumber:i,commitHash:u}=m;return e.createElement(be.Z,{destroyOnClose:!0,title:e.createElement("div",{className:Q.title},"\u4EE3\u7801\u6279\u6CE8 - ",t,":",i),visible:o,placement:"right",onClose:a,width:"33%"},e.createElement("div",{className:Q.CodeCommentDrawer},e.createElement("div",{className:Q.top},e.createElement(p,{fileContent:r,hasLineNumber:!1,hasComment:!1})),e.createElement("div",{className:Q.mid},e.createElement(st,{commitHash:u,lineNumber:i})),e.createElement("div",{className:Q.bottom},e.createElement(Oe,{lineNumber:i,commitHash:u}))))}var mt=e.memo(it),j={FileInfoBar:"Style_FileInfoBar__af0Fh",fileInfoWrapper:"Style_fileInfoWrapper__zKI-0",fileNameWrapper:"Style_fileNameWrapper__NlUvm",fileName:"Style_fileName__c6RLD",fileSize:"Style_fileSize__hk0X4"},Se=s(565),Ne=s(18440),lt=s(65293),ct=s(93948),ut=s(57132),dt=s(76320);function ft(m){const{fileSize:o,onRawFileButtonClick:t,match:{params:{username:r,repositoryName:a,commitHash:i,path:u}}}=m,l=S().basename(u);return e.createElement("div",{className:j.FileInfoBar},e.createElement("div",{className:j.fileInfoWrapper},e.createElement("div",{className:j.backLinkWrapper},e.createElement(Se.rU,{to:Ne.Function.generateRepositoryCodeRoute({username:r,repositoryName:a,commitHash:i,objectType:dt.LP.TREE,path:S().join(u,"..")})},e.createElement(_.Z,{size:"small"},e.createElement(ct.Z,null)))),e.createElement("div",{className:j.fileNameWrapper},e.createElement(ut.Z,null),e.createElement("div",{className:j.fileName}," ",l)),e.createElement("div",{className:j.fileSize},f.$B.parseFileSize(o))),e.createElement(lt.Z,{size:-1,className:j.buttonWrapper},e.createElement(_.Z,null,e.createElement(Se.rU,{to:Ne.Function.generateRepositoryCommitsRoute({username:r,repositoryName:a,commitHash:i,path:u})},"\u5386\u53F2")),e.createElement(_.Z,{onClick:t},"\u4E0B\u8F7D")))}var ht=(0,Y.EN)(ft),pt=s(19237),Ct=(m,o,t)=>new Promise((r,a)=>{var i=n=>{try{l(t.next(n))}catch(c){a(c)}},u=n=>{try{l(t.throw(n))}catch(c){a(c)}},l=n=>n.done?r(n.value):Promise.resolve(n.value).then(i,u);l((t=t.apply(m,o)).next())});function vt(m){const{fileSize:o,lastCommitHash:t}=m,{params:{username:r,repositoryName:a,path:i}}=(0,Y.$B)(),u=n=>{const c=URL.createObjectURL(n);f.$B.startDownload(c,S().basename(i)),URL.revokeObjectURL(c)},l=()=>Ct(this,null,function*(){const n=yield pt.C.rawFile({username:r},{name:a},i,t);n!==null&&u(n)});return e.createElement(ht,{fileSize:o,onRawFileButtonClick:l})}var yt=e.memo(vt),ue=s(61764),Xt=s(70451);ue.v0.GlobalWorkerOptions.workerSrc="/pdf.worker.min.js";var Le={PDFReader:"Style_PDFReader__l23wi",control:"Style_control__1y0hg"},Et=s(96446);function St(m){const{pdfURL:o,pageNumber:t,onPDFLoadSuccess:r,pageAmount:a,onPaginationChange:i}=m;return e.createElement("div",{className:Le.PDFReader},e.createElement(ue.BB,{file:o,loading:e.createElement(P.Z,{spinning:!0}),error:e.createElement(P.Z,{spinning:!0}),onLoadSuccess:r},e.createElement(ue.T3,{pageNumber:t})),e.createElement("div",{className:Le.control},e.createElement(Et.Z,{pageSize:1,showSizeChanger:!1,showQuickJumper:!0,current:t,total:a,onChange:i})))}var Nt=e.memo(St);function Lt(m){const{fileContent:o}=m,[t,r]=(0,e.useState)(0),[a,i]=(0,e.useState)(1),[u,l]=(0,e.useState)("");(0,e.useEffect)(()=>{l(URL.createObjectURL(o))},[o]),(0,e.useEffect)(()=>()=>URL.revokeObjectURL(u),[u]);const n=T=>{const{numPages:y}=T;r(y)},c=T=>{i(T)};return e.createElement(Nt,{pageNumber:a,pdfURL:u,pageAmount:t,onPaginationChange:c,onPDFLoadSuccess:n})}var gt=e.memo(Lt),ge={ImageViewer:"Style_ImageViewer__2RibX",image:"Style_image__rBtQf"};function Ft(m){const{url:o,loading:t}=m;return e.createElement("div",{className:ge.ImageViewer},e.createElement(P.Z,{spinning:t},e.createElement("img",{src:o,alt:"file preview",className:ge.image})))}var Rt=e.memo(Ft);function Bt(m){const[o,t]=(0,e.useState)(""),{fileContent:r,loading:a}=m;return(0,e.useLayoutEffect)(()=>{const i=URL.createObjectURL(r);return t(i),()=>URL.revokeObjectURL(i)},[r]),e.createElement(Rt,{url:o,loading:a})}var Pt=e.memo(Bt);function Tt(m){const o=[".md",".markdown",".mdwn"],{isOversize:t,lastCommit:r,loading:a,fileContent:i,fileType:u,fileSize:l,fileName:n,onCodeLineClickFactory:c,hasCommentLineNumbers:T,drawerCode:y,drawerLineNumber:de,drawerVisible:fe,onDrawerClose:q}=m,he=S().extname(n).toLowerCase(),K=u.toLowerCase(),ae=K.includes("text");return e.createElement(e.Fragment,null,e.createElement("div",{className:g.FileReader},e.createElement(M.Z,{loading:a,active:!0},e.createElement("div",{className:g.commitInfoBar},e.createElement(Z.Z,{lastCommit:r})),e.createElement("div",{className:g.contentWrapper},e.createElement("div",{className:g.fileInfoBarWrapper},e.createElement(yt,{fileSize:l,lastCommitHash:r.commitHash})),e.createElement("div",{className:g.readerWrapper},(()=>t?e.createElement(F,null):ae&&o.includes(he)?e.createElement(De,{fileContent:i}):K.includes("pdf")?e.createElement(gt,{fileContent:i}):ae||K.includes("json")?e.createElement(p,{fileContent:i,hasComment:!0,hasLineNumber:!0,onCodeLineClickFactory:c,hasCommentLineNumbers:T}):K.includes("image")?e.createElement(Pt,{loading:a,fileContent:i}):e.createElement(B,null))())))),e.createElement(mt,{lineNumber:de,code:y,visible:fe,fileName:n,onClose:q,commitHash:r.commitHash}))}var It=e.memo(Tt),Fe=s(84259),J=(m,o,t)=>new Promise((r,a)=>{var i=n=>{try{l(t.next(n))}catch(c){a(c)}},u=n=>{try{l(t.throw(n))}catch(c){a(c)}},l=n=>n.done?r(n.value):Promise.resolve(n.value).then(i,u);l((t=t.apply(m,o)).next())});function wt(){const[t,r]=(0,e.useState)(!1),[a,i]=(0,e.useState)(!1),[u,l]=(0,e.useState)(!1),[n,c]=(0,e.useState)(new ye.HL("","","",0,"","")),[T,y]=(0,e.useState)(!1),[de,fe]=(0,e.useState)("text"),[q,he]=(0,e.useState)(new Blob),[K,ae]=(0,e.useState)(0),[Re,bt]=(0,e.useState)([]),[Mt,Be]=(0,e.useState)(!1),[At,Ht]=(0,e.useState)(""),[Ut,Zt]=(0,e.useState)(0),{params:{username:H,repositoryName:U,path:b,commitHash:Pe}}=(0,Y.$B)(),Te=(0,Y.k6)(),Wt=(0,e.useMemo)(()=>Re.map(({columnNumber:L})=>L),[Re]),re=(0,e.useMemo)(()=>()=>J(this,null,function*(){y(!0);const{commitHash:L}=n,I=yield A.Ay.get({repositoryUsername:H,repositoryName:U,filePath:b},L);if(I!==null){const{codeComments:O}=I;bt(O)}y(!1)}),[n,H,U,b]);(0,e.useEffect)(()=>{const L=()=>J(this,null,function*(){yield re()});return G.on($,L),()=>{G.removeListener($,L)}},[re]),(0,e.useEffect)(()=>{const L=()=>J(this,null,function*(){const I=yield A.CB.lastBranchCommit({username:H},{name:U},Pe,b);I!==null&&c(I)});y(!0),r(!1),L().then(()=>r(!0)).finally(()=>y(!1))},[H,U,b,Pe]),(0,e.useEffect)(()=>{const L=()=>J(this,null,function*(){const{commitHash:I}=n,O=yield A.CB.fileInfo({username:H},{name:U},b,I);if(O!==null){const{fileType:Ie,objectType:zt,fileSize:pe}=O;if(zt===null)return Te.replace(Fe.yt[Fe.DV.NOT_FOUND]);{ae(pe),fe(Ie);const xt=Ie.toLowerCase().includes("text")?pe>131072:pe>5242880;l(xt)}}});t&&(y(!0),L().then(()=>i(!0)).finally(()=>y(!1)))},[n,H,U,b,Te,t,5242880,131072]),(0,e.useEffect)(()=>{t&&a&&(y(!0),re().finally(()=>y(!1)))},[re,t,a]),(0,e.useEffect)(()=>{const L=()=>J(this,null,function*(){const{commitHash:I}=n,O=yield A.CB.rawFile({username:H},{name:U},b,I);O!==null&&he(O)});!u&&t&&a&&(y(!0),L().finally(()=>y(!1)))},[u,H,U,b,n,t,a]);const jt=(0,e.useCallback)(L=>()=>J(this,null,function*(){Zt(L);const I=(yield f.$B.transformBlobToString(q)).split(`
`);Ht(I[L-1].trim()),Be(!0)}),[q]),Ot=()=>{Be(!1)},Vt=(0,X.basename)(b);return e.createElement(It,{fileSize:K,fileContent:q,fileType:de,fileName:Vt,isOversize:u,lastCommit:n,loading:T,hasCommentLineNumbers:Wt,onCodeLineClickFactory:jt,drawerCode:At,drawerLineNumber:Ut,drawerVisible:Mt,onDrawerClose:Ot})}var Dt=e.memo(wt)},55327:function(Ce,V,s){"use strict";s.d(V,{Z:function(){return W}});var e=s(89526),g=s(65092),M=s(18440),Z=s(19237),z=s(84143),x=s.n(z),B=s(76320),k=s(89368),F=s.n(k),X=s(47365),S=(P,N,d)=>new Promise((E,f)=>{var R=h=>{try{C(d.next(h))}catch(v){f(v)}},p=h=>{try{C(d.throw(h))}catch(v){f(v)}},C=h=>h.done?E(h.value):Promise.resolve(h.value).then(R,p);C((d=d.apply(P,N)).next())});class w extends e.PureComponent{constructor(N){super(N);this.objectURLs=[],this.loadMainBranchName=()=>S(this,null,function*(){return new Promise(d=>S(this,null,function*(){const{match:{params:{username:E,repositoryName:f}}}=this.props,R=yield Z.C.branches({username:E,name:f});if(R!==null){const{branches:p}=R;for(const{name:C,isDefault:h}of p)if(h){this.setState({mainBranchName:C},()=>d());break}}}))}),this.processHTML=d=>S(this,null,function*(){const f=document.implementation.createHTMLDocument().createElement("div");f.innerHTML=d;const R=f.getElementsByTagName("a"),p=f.getElementsByTagName("img"),C=[];for(const h of R){const v=h.getAttribute("href");v!==null&&C.push((()=>S(this,null,function*(){h.setAttribute("href",yield this.getCompleteLink(v))}))())}for(const h of p){const v=h.getAttribute("src");v!==null&&C.push((()=>S(this,null,function*(){const D=yield this.getImageURL(v);this.objectURLs.push(D),h.setAttribute("src",D)}))())}return yield Promise.all(C),f.innerHTML}),this.getCompleteLink=d=>S(this,null,function*(){if(d.length===0||x()(d)||F().isAbsolute(d)||d.charAt(0)==="#"||d.charAt(0)==="?")return d;{const{match:{params:{username:E,repositoryName:f,objectType:R,commitHash:p,path:C}}}=this.props,{mainBranchName:h}=this.state,v=C?R===B.LP.BLOB?F().join(F().dirname(C),d):F().join(C,d):F().join("",d),D=yield Z.C.fileInfo({username:E},{name:f},v,p||h);if(D!==null){const{objectType:ee}=D;return ee===B.LP.BLOB?M.Function.generateRepositoryCodeRoute({username:E,repositoryName:f,commitHash:p||h,path:v,objectType:B.LP.BLOB}):ee===B.LP.TREE?M.Function.generateRepositoryCodeRoute({username:E,repositoryName:f,commitHash:p||h,path:v,objectType:B.LP.TREE}):M.Function.generateRepositoryCodeRoute({username:E,repositoryName:f,commitHash:p||h,path:v,objectType:B.LP.COMMIT})}else return M.Function.generateRepositoryCodeRoute({username:E,repositoryName:f,commitHash:p||h,path:v,objectType:B.LP.BLOB})}}),this.getImageURL=d=>S(this,null,function*(){if(x()(d)||F().isAbsolute(d))return d;{const{match:{params:{username:E,repositoryName:f,objectType:R,commitHash:p,path:C}}}=this.props,{mainBranchName:h}=this.state,v=C?R===B.LP.BLOB?F().join(F().dirname(C),d):F().join(C,d):F().join("",d),D=yield Z.C.rawFile({username:E},{name:f},v,p||h);return D!==null?URL.createObjectURL(D):d}}),this.state={mainBranchName:"",loading:!1}}componentDidMount(){return S(this,null,function*(){const{match:{params:{commitHash:N}}}=this.props;this.setState({loading:!0}),typeof N!="string"&&(yield this.loadMainBranchName()),this.setState({loading:!1})})}componentDidUpdate(N,d,E){return S(this,null,function*(){const{markdown:f}=this.props,{markdown:R}=N;f!==R&&(yield this.componentDidMount())})}componentWillUnmount(){this.objectURLs.forEach(N=>URL.revokeObjectURL(N))}render(){const{loading:N}=this.state,{markdown:d}=this.props;return e.createElement(X.Z,{markdown:d,processHTML:this.processHTML,loading:N})}}var W=(0,g.EN)(w)},14601:function(){},32767:function(){},28251:function(){},57677:function(){},1543:function(){},87324:function(){}}]);

//# sourceMappingURL=9681.d7618c37.chunk.js.map