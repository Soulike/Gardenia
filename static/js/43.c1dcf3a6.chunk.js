(this["webpackJsonpsoulike-git"]=this["webpackJsonpsoulike-git"]||[]).push([[43],{1081:function(U,G,s){U.exports={Conflict:"Style_Conflict__3Vamq",conflictsWrapper:"Style_conflictsWrapper__1FN4k",conflictWrapper:"Style_conflictWrapper__2qm8Q",buttonWrapper:"Style_buttonWrapper__1QhqS"}},1082:function(U,G,s){U.exports={ConflictEditor:"Style_ConflictEditor__p1WcR",header:"Style_header__3Oayj",filePath:"Style_filePath__1iCwK",checkboxWrapper:"Style_checkboxWrapper__VLdFN",text:"Style_text__3S4yB"}},1396:function(U,G,s){"use strict";s.r(G),s.d(G,"default",function(){return Te});var h=s(0),l=s.n(h),de=s(1081),W=s.n(de),fe=s(955),ee=s(970),he=s(959),pe=s(103),te=s(279),R=s(49),M=s(22),ve=s(1082),S=s.n(ve),E=s(4),T=s(2),me=s(5),L=s.n(me),Ce=s(16),w=s(3),ye=s(15),ge=s(21),be=s(23),Ee=s(24),ne=function(i){Object(be.a)(n,i);var o=Object(Ee.a)(n);function n(e){var t;Object(ye.a)(this,n),t=o.call(this,e),t.handleChange=function(r){var u=t.props,c=u.disabled,d=u.onChange;c||("checked"in t.props||t.setState({checked:r.target.checked}),d&&d({target:Object(w.a)(Object(w.a)({},t.props),{},{checked:r.target.checked}),stopPropagation:function(){r.stopPropagation()},preventDefault:function(){r.preventDefault()},nativeEvent:r.nativeEvent}))},t.saveInput=function(r){t.input=r};var a="checked"in e?e.checked:e.defaultChecked;return t.state={checked:a},t}return Object(ge.a)(n,[{key:"focus",value:function(){this.input.focus()}},{key:"blur",value:function(){this.input.blur()}},{key:"render",value:function(){var t,a=this.props,r=a.prefixCls,u=a.className,c=a.style,d=a.name,p=a.id,v=a.type,x=a.disabled,k=a.readOnly,m=a.tabIndex,B=a.onClick,j=a.onFocus,O=a.onBlur,f=a.onKeyDown,D=a.onKeyPress,y=a.onKeyUp,g=a.autoFocus,A=a.value,V=a.required,H=Object(Ce.a)(a,["prefixCls","className","style","name","id","type","disabled","readOnly","tabIndex","onClick","onFocus","onBlur","onKeyDown","onKeyPress","onKeyUp","autoFocus","value","required"]),Z=Object.keys(H).reduce(function(I,N){return(N.substr(0,5)==="aria-"||N.substr(0,5)==="data-"||N==="role")&&(I[N]=H[N]),I},{}),J=this.state.checked,Q=L()(r,u,(t={},Object(E.a)(t,"".concat(r,"-checked"),J),Object(E.a)(t,"".concat(r,"-disabled"),x),t));return l.a.createElement("span",{className:Q,style:c},l.a.createElement("input",Object(T.a)({name:d,id:p,type:v,required:V,readOnly:k,disabled:x,tabIndex:m,className:"".concat(r,"-input"),checked:!!J,onClick:B,onFocus:j,onBlur:O,onKeyUp:y,onKeyDown:f,onKeyPress:D,onChange:this.handleChange,autoFocus:g,ref:this.saveInput,value:A},Z)),l.a.createElement("span",{className:"".concat(r,"-inner")}))}}],[{key:"getDerivedStateFromProps",value:function(t,a){return"checked"in t?Object(w.a)(Object(w.a)({},a),{},{checked:t.checked}):null}}]),n}(h.Component);ne.defaultProps={prefixCls:"rc-checkbox",className:"",style:{},type:"checkbox",defaultChecked:!1,onFocus:function(){},onBlur:function(){},onChange:function(){},onKeyDown:function(){},onKeyPress:function(){},onKeyUp:function(){}};var xe=ne,ae=s(10),oe=s(6),Oe=s(36),re=s(96),Pe=function(i,o){var n={};for(var e in i)Object.prototype.hasOwnProperty.call(i,e)&&o.indexOf(e)<0&&(n[e]=i[e]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var t=0,e=Object.getOwnPropertySymbols(i);t<e.length;t++)o.indexOf(e[t])<0&&Object.prototype.propertyIsEnumerable.call(i,e[t])&&(n[e[t]]=i[e[t]]);return n},se=h.createContext(null),Ne=function(o,n){var e=o.defaultValue,t=o.children,a=o.options,r=a===void 0?[]:a,u=o.prefixCls,c=o.className,d=o.style,p=o.onChange,v=Pe(o,["defaultValue","children","options","prefixCls","className","style","onChange"]),x=h.useContext(re.b),k=x.getPrefixCls,m=x.direction,B=h.useState(v.value||e||[]),j=Object(oe.a)(B,2),O=j[0],f=j[1],D=h.useState([]),y=Object(oe.a)(D,2),g=y[0],A=y[1];h.useEffect(function(){"value"in v&&f(v.value||[])},[v.value]);var V=function(){return r.map(function(b){return typeof b=="string"?{label:b,value:b}:b})},H=function(b){A(function(K){return K.filter(function($){return $!==b})})},Z=function(b){A(function(K){return[].concat(Object(ae.a)(K),[b])})},J=function(b){var K=O.indexOf(b.value),$=Object(ae.a)(O);K===-1?$.push(b.value):$.splice(K,1),"value"in v||f($);var ie=V();p==null||p($.filter(function(q){return g.indexOf(q)!==-1}).sort(function(q,ze){var He=ie.findIndex(function(_){return _.value===q}),Je=ie.findIndex(function(_){return _.value===ze});return He-Je}))},Q=k("checkbox",u),I="".concat(Q,"-group"),N=Object(Oe.a)(v,["value","disabled"]);r&&r.length>0&&(t=V().map(function(C){return h.createElement(ce,{prefixCls:Q,key:C.value.toString(),disabled:"disabled"in C?C.disabled:v.disabled,value:C.value,checked:O.indexOf(C.value)!==-1,onChange:C.onChange,className:"".concat(I,"-item"),style:C.style},C.label)}));var Le={toggleOption:J,value:O,disabled:v.disabled,name:v.name,registerValue:Z,cancelValue:H},we=L()(I,Object(E.a)({},"".concat(I,"-rtl"),m==="rtl"),c);return h.createElement("div",Object(T.a)({className:we,style:d},N,{ref:n}),h.createElement(se.Provider,{value:Le},t))},Re=h.forwardRef(Ne),Se=h.memo(Re),Fe=s(54),ke=function(i,o){var n={};for(var e in i)Object.prototype.hasOwnProperty.call(i,e)&&o.indexOf(e)<0&&(n[e]=i[e]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var t=0,e=Object.getOwnPropertySymbols(i);t<e.length;t++)o.indexOf(e[t])<0&&Object.prototype.propertyIsEnumerable.call(i,e[t])&&(n[e[t]]=i[e[t]]);return n},Be=function(o,n){var e,t=o.prefixCls,a=o.className,r=o.children,u=o.indeterminate,c=u===void 0?!1:u,d=o.style,p=o.onMouseEnter,v=o.onMouseLeave,x=o.skipGroup,k=x===void 0?!1:x,m=ke(o,["prefixCls","className","children","indeterminate","style","onMouseEnter","onMouseLeave","skipGroup"]),B=h.useContext(re.b),j=B.getPrefixCls,O=B.direction,f=h.useContext(se),D=h.useRef(m.value);h.useEffect(function(){f==null||f.registerValue(m.value),Object(Fe.a)("checked"in m||!!f||!("value"in m),"Checkbox","`value` is not a valid prop, do you mean `checked`?")},[]),h.useEffect(function(){if(!k)return m.value!==D.current&&(f==null||f.cancelValue(D.current),f==null||f.registerValue(m.value)),function(){return f==null?void 0:f.cancelValue(m.value)}},[m.value]);var y=j("checkbox",t),g=Object(T.a)({},m);f&&!k&&(g.onChange=function(){m.onChange&&m.onChange.apply(m,arguments),f.toggleOption&&f.toggleOption({label:r,value:m.value})},g.name=f.name,g.checked=f.value.indexOf(m.value)!==-1,g.disabled=m.disabled||f.disabled);var A=L()((e={},Object(E.a)(e,"".concat(y,"-wrapper"),!0),Object(E.a)(e,"".concat(y,"-rtl"),O==="rtl"),Object(E.a)(e,"".concat(y,"-wrapper-checked"),g.checked),Object(E.a)(e,"".concat(y,"-wrapper-disabled"),g.disabled),e),a),V=L()(Object(E.a)({},"".concat(y,"-indeterminate"),c));return h.createElement("label",{className:A,style:d,onMouseEnter:p,onMouseLeave:v},h.createElement(xe,Object(T.a)({},g,{prefixCls:y,className:V,ref:n})),r!==void 0&&h.createElement("span",null,r))},le=h.forwardRef(Be);le.displayName="Checkbox";var ce=le,X=ce;X.Group=Se,X.__ANT_CHECKBOX=!0;var je=X;const De=l.a.lazy(()=>Promise.all([s.e(10),s.e(47)]).then(s.bind(null,1434)));function Ae(i){const{conflict:{filePath:o},code:n,onCodeChange:e,onResolvedCheckboxChange:t,resolved:a}=i;return l.a.createElement("div",{className:S.a.ConflictEditor},l.a.createElement("div",{className:S.a.header},l.a.createElement("code",{className:S.a.filePath},o),l.a.createElement("label",{className:S.a.checkboxWrapper},l.a.createElement(je,{onChange:t,checked:a}),l.a.createElement("div",{className:S.a.text},"\u5DF2\u89E3\u51B3"))),l.a.createElement("div",{className:S.a.codeWrapper,style:a?{position:"fixed",top:"99999999px"}:{}},l.a.createElement(De,{onBeforeChange:e,value:n,options:{lineNumbers:!0,indentUnit:0}})))}var Ve=l.a.memo(Ae),F=s(349),Ie=(i,o,n)=>new Promise((e,t)=>{var a=c=>{try{u(n.next(c))}catch(d){t(d)}},r=c=>{try{u(n.throw(c))}catch(d){t(d)}},u=c=>c.done?e(c.value):Promise.resolve(c.value).then(a,r);u((n=n.apply(i,o)).next())});class Ke extends h.PureComponent{constructor(o){super(o);this.onCodeChange=(n,e,t)=>{this.setState({code:t})},this.onResolvedCheckboxChange=n=>{const{code:e}=this.state,{conflict:{filePath:t}}=this.props;e.search(/^<<<<<<< .+$/m)!==-1||e.search(/^=======$/m)!==-1||e.search(/^>>>>>>> .+$/m)!==-1?F.a.warning({message:l.a.createElement("div",null,l.a.createElement("code",null,t)," \u4E2D\u4ECD\u5B58\u5728\u51B2\u7A81"),description:"\u8BF7\u89E3\u51B3\u51B2\u7A81\uFF0C\u5E76\u5220\u9664\u6240\u6709\u7684\u51B2\u7A81\u6807\u8BB0"}):this.setState({resolved:n.target.checked})},this.state={code:"",resolved:!1}}componentDidMount(){const{conflict:{content:o}}=this.props;this.setState({code:o})}componentDidUpdate(o,n,e){return Ie(this,null,function*(){const{conflict:t}=this.props,{conflict:a}=o;t!==a&&(yield this.componentDidMount());const{onChange:r}=this.props;if(typeof r=="function"){const{code:u,resolved:c}=this.state,{filePath:d}=t,{code:p,resolved:v}=n;(u!==p||c!==v)&&(yield r(d,c,u))}})}render(){const{code:o,resolved:n}=this.state,{conflict:e}=this.props;return l.a.createElement(Ve,{conflict:e,code:o,onCodeChange:this.onCodeChange,resolved:n,onResolvedCheckboxChange:this.onResolvedCheckboxChange})}}var $e=Ke;function We(i){const{loading:o,pullRequest:{sourceRepositoryUsername:n,sourceRepositoryName:e,sourceRepositoryBranchName:t,targetRepositoryUsername:a,targetRepositoryName:r,targetRepositoryBranchName:u},conflicts:c,onConflictChange:d,onSubmitButtonClick:p}=i;return l.a.createElement("div",{className:W.a.Conflict},l.a.createElement(fe.a,{spinning:o},l.a.createElement("div",{className:W.a.alert},l.a.createElement(ee.a,{type:"info",banner:!0,showIcon:!0,message:l.a.createElement("div",null,"\u6B63\u5728\u89E3\u51B3 ",l.a.createElement(te.a,{to:R.Function.generateRepositoryCodeRoute({username:n,repositoryName:e,objectType:M.b.TREE,commitHash:t})},l.a.createElement("code",null,n,"/",e,":",t))," \u5230 ",l.a.createElement(te.a,{to:R.Function.generateRepositoryCodeRoute({username:a,repositoryName:r,objectType:M.b.TREE,commitHash:u})},l.a.createElement("code",null,a,"/",r,":",u))," \u7684\u5408\u5E76\u51B2\u7A81")}),l.a.createElement(ee.a,{type:"warning",banner:!0,showIcon:!0,message:l.a.createElement("div",null,"\u6240\u505A\u7684\u4FEE\u6539\u5C06\u88AB\u63D0\u4EA4\u5230 ",l.a.createElement("code",null,n,"/",e,":",t))})),l.a.createElement("div",{className:W.a.conflictsWrapper},c.map(v=>l.a.createElement("div",{key:v.filePath,className:W.a.conflictWrapper},l.a.createElement($e,{conflict:v,onChange:d})))),l.a.createElement("div",{className:W.a.buttonWrapper},l.a.createElement(he.a,{onConfirm:p,disabled:o,title:l.a.createElement("div",null,"\u786E\u8BA4\u51B2\u7A81\u89E3\u51B3\uFF1F",l.a.createElement("br",null),l.a.createElement("strong",null,"\u4EE5\u4E0A\u4FEE\u6539\u90FD\u5C06\u88AB\u63D0\u4EA4\u5230 ",l.a.createElement("code",null,n,"/",e,":",t)))},l.a.createElement(pe.a,{type:"primary",size:"large",disabled:o,loading:o},"\u63D0\u4EA4")))))}var Ue=l.a.memo(We),Ge=s(47),ue=s(134),Y=s(27),z=s(1),P=(i,o,n)=>new Promise((e,t)=>{var a=c=>{try{u(n.next(c))}catch(d){t(d)}},r=c=>{try{u(n.throw(c))}catch(d){t(d)}},u=c=>c.done?e(c.value):Promise.resolve(c.value).then(a,r);u((n=n.apply(i,o)).next())});class Me extends h.PureComponent{constructor(o){super(o);this.checkURL=()=>{const{match:{params:{no:n}},history:e}=this.props,t=Number.parseInt(n);if(Number.isNaN(t))return e.replace(z.d[z.b.NOT_FOUND])},this.loadPullRequest=()=>P(this,null,function*(){return new Promise(n=>P(this,null,function*(){const{match:{params:{username:e,repositoryName:t,no:a}},history:r}=this.props,u=Number.parseInt(a),c=yield Y.h.get({username:e,name:t},{no:u});if(c!==null){const{status:d}=c;if(d!==M.c.OPEN)return F.a.warn({message:`Pull Request #${u} \u5DF2\u5173\u95ED\u6216\u5408\u5E76`}),n(),r.replace(R.Function.generateRepositoryPullRequestRoute({username:e,repositoryName:t,no:a}));this.setState({pullRequest:c},()=>n())}else return n(),r.replace(z.d[z.b.NOT_FOUND])}))}),this.loadConflicts=()=>P(this,null,function*(){return new Promise(n=>P(this,null,function*(){const{pullRequest:e}=this.state,{id:t}=e,a=yield Y.h.getConflicts({id:t});if(a!==null){const{conflicts:r}=a,{match:{params:{username:u,repositoryName:c,no:d}},history:p}=this.props;if(r.length===0)return F.a.warn({message:`${u}/${c} #${d} \u6CA1\u6709\u5408\u5E76\u51B2\u7A81`,description:"\u60A8\u53EF\u76F4\u63A5\u6267\u884C\u5408\u5E76\u64CD\u4F5C"}),n(),p.replace(R.Function.generateRepositoryPullRequestRoute({username:u,repositoryName:c,no:d}));r.forEach(({isBinary:v})=>{if(v)return F.a.warn({message:"\u5B58\u5728\u4E8C\u8FDB\u5236\u6587\u4EF6\u51B2\u7A81",description:"\u8BF7\u4F7F\u7528\u547D\u4EE4\u884C\u89E3\u51B3\u51B2\u7A81"}),n(),p.replace(R.Function.generateRepositoryPullRequestRoute({username:u,repositoryName:c,no:d}))}),this.setState({conflicts:r},()=>n())}else n()}))}),this.onConflictChange=(n,e,t)=>{const{conflicts:a,resolvedFilePath:r}=this.state;for(let u=0;u<a.length;u++){const{filePath:c,isBinary:d,content:p}=a[u];c===n&&t!==p&&(a[u]=new ue.c(n,d,t)),e?r.add(n):r.delete(n)}},this.onSubmitButtonClick=()=>P(this,null,function*(){const{pullRequest:{id:n},resolvedFilePath:e,conflicts:t}=this.state;if(t.map(({filePath:r})=>r).length!==e.size)F.a.error({message:"\u8BF7\u89E3\u51B3\u6240\u6709\u51B2\u7A81\u540E\u518D\u63D0\u4EA4"});else{if(this.setState({loading:!0}),(yield Y.h.resolveConflicts({id:n},t))!==null){F.a.success({message:"\u89E3\u51B3\u51B2\u7A81\u6210\u529F"});const{history:u,match:{params:{username:c,repositoryName:d,no:p}}}=this.props;return u.push(R.Function.generateRepositoryPullRequestRoute({username:c,repositoryName:d,no:p}))}this.setState({loading:!1})}}),this.state={pullRequest:new ue.h(0,0,"","","","","","","","",0,0,"","",M.c.CLOSED),conflicts:[],loading:!1,resolvedFilePath:new Set}}componentDidMount(){return P(this,null,function*(){this.checkURL(),this.setState({loading:!0}),yield this.loadPullRequest(),this.setState({loading:!1})})}componentDidUpdate(o,n,e){return P(this,null,function*(){const{location:{pathname:t}}=this.props,{location:{pathname:a}}=this.props;t!==a&&(yield this.componentDidMount());const{pullRequest:{id:r}}=this.state,{pullRequest:{id:u}}=n;u!==r&&(this.setState({loading:!0}),yield this.loadConflicts(),this.setState({loading:!1}))})}render(){const{loading:o,pullRequest:n,conflicts:e}=this.state;return l.a.createElement(Ue,{loading:o,pullRequest:n,conflicts:e,onConflictChange:this.onConflictChange,onSubmitButtonClick:this.onSubmitButtonClick})}}var Te=Object(Ge.j)(Me)}}]);

//# sourceMappingURL=43.c1dcf3a6.chunk.js.map