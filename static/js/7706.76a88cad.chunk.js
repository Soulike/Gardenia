"use strict";(self.webpackChunksoulike_git=self.webpackChunksoulike_git||[]).push([[7706],{87706:function(H,C,i){i.r(C),i.d(C,{default:function(){return Z}});var t=i(89526),d={Commit:"Style_Commit__nbVew",diffWrapper:"Style_diffWrapper__iy0bC",loadMoreButtonWrapper:"Style_loadMoreButtonWrapper__stI69"},D=i(5892),v=i(30592),r={CommitInfoCard:"Style_CommitInfoCard__8vSRg",messageWrapper:"Style_messageWrapper__pYcld",message:"Style_message__67Vb6",body:"Style_body__pVUDa",infoWrapper:"Style_infoWrapper__IQKnD",info:"Style_info__JFE-O",committerWrapper:"Style_committerWrapper__Yy4XX"},S=i(14006),g=i(565),E=i(65092),A=i(18440),F=i(76320),W=i(55291);function M(s){const{commit:{message:e,body:o,committerName:n,timestamp:a,commitHash:m,committerEmail:f},match:{params:{username:u,repositoryName:l}}}=s;return t.createElement("div",{className:r.CommitInfoCard},t.createElement("div",{className:r.messageWrapper},t.createElement("div",{className:r.message},e),o.length?t.createElement("pre",{className:r.body},o):null),t.createElement("div",{className:r.infoWrapper},t.createElement("div",{className:r.info},t.createElement("div",{className:r.committerWrapper},t.createElement(W.Z,{committerEmail:f,committerName:n})),"\u5728 ",S.Ej.parseTimestampToDifference(a),"\u63D0\u4EA4"),t.createElement("div",{className:r.hashWrapper},t.createElement(g.rU,{className:r.hash,to:A.Function.generateRepositoryCodeRoute({username:u,repositoryName:l,commitHash:m,objectType:F.LP.TREE})},t.createElement(v.Z,{size:"small"},t.createElement("code",null,m))))))}var I=(0,E.EN)(t.memo(M)),P=i(87521);function B(s){const{loading:e,diff:o,commit:n,diffAmount:a,onLoadMoreButtonClick:m}=s;return t.createElement("div",{className:d.Commit},t.createElement(D.Z,{spinning:e},t.createElement("div",{className:d.commitInfoCardWrapper},t.createElement(I,{commit:n})),t.createElement("div",{className:d.diffWrapper},t.createElement(P.Z,{fileDiffs:o,fileDiffAmount:a}),t.createElement("div",{className:d.loadMoreButtonWrapper},t.createElement(v.Z,{disabled:e,loading:e,onClick:m,size:"large",type:"primary"},"\u52A0\u8F7D\u66F4\u591A\u6587\u4EF6\u66F4\u6539")))))}var L=t.memo(B),T=i(60269),p=i(62371),R=i(24315),c=(s,e,o)=>new Promise((n,a)=>{var m=l=>{try{u(o.next(l))}catch(h){a(h)}},f=l=>{try{u(o.throw(l))}catch(h){a(h)}},u=l=>l.done?n(l.value):Promise.resolve(l.value).then(m,f);u((o=o.apply(s,e)).next())});const y=class extends t.PureComponent{constructor(s){super(s);this.init=()=>c(this,null,function*(){return new Promise(e=>{this.setState({diff:[]},()=>e())})}),this.loadCommit=()=>c(this,null,function*(){const{match:{params:{username:e,repositoryName:o,commitHash:n}}}=this.props,a=yield p.CB.commit({username:e,name:o},n);if(a!==null){const{commit:m}=a;this.setState({commit:m})}}),this.loadMoreCommitDiff=()=>c(this,null,function*(){const{match:{params:{username:e,repositoryName:o,commitHash:n}}}=this.props,{diff:a}=this.state,m=yield p.CB.commitDiff({username:e,name:o},n,a.length,y.FILE_DIFF_AMOUNT_PER_PAGE);if(m!==null){const{diff:f}=m;f.length===0?R.Z.success({message:"\u5DF2\u52A0\u8F7D\u6240\u6709\u88AB\u4FEE\u6539\u6587\u4EF6"}):this.setState({diff:[...a,...f]})}}),this.loadCommitDiffAmount=()=>c(this,null,function*(){const{match:{params:{username:e,repositoryName:o,commitHash:n}}}=this.props,a=yield p.CB.commitDiffAmount({username:e,name:o},n);if(a!==null){const{amount:m}=a;this.setState({diffAmount:m})}}),this.onLoadMoreButtonClick=()=>c(this,null,function*(){this.setState({loading:!0}),yield this.loadMoreCommitDiff(),this.setState({loading:!1})}),this.state={commit:new T.HL("","","a@b.com",0,"",""),diff:[],diffAmount:0,loading:!1}}componentDidMount(){return c(this,null,function*(){yield this.init(),this.setState({loading:!0}),yield Promise.all([this.loadCommit(),this.loadCommitDiffAmount(),this.loadMoreCommitDiff()]),this.setState({loading:!1})})}componentDidUpdate(s,e,o){return c(this,null,function*(){const{location:{pathname:n}}=this.props,{location:{pathname:a}}=s;n!==a&&(yield this.componentDidMount())})}render(){const{commit:s,diff:e,loading:o,diffAmount:n}=this.state;return t.createElement(L,{commit:s,diff:e,loading:o,diffAmount:n,onLoadMoreButtonClick:this.onLoadMoreButtonClick})}};let N=y;N.FILE_DIFF_AMOUNT_PER_PAGE=10;var Z=(0,E.EN)(N)}}]);

//# sourceMappingURL=7706.76a88cad.chunk.js.map