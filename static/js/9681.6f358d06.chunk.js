(self.webpackChunksoulike_git=self.webpackChunksoulike_git||[]).push([[9681],{83538:function(pe,V,s){"use strict";s.d(V,{Z:function(){return X}});var e=s(89526),g={CommitInfoBar:"Style_CommitInfoBar__pCbNv",left:"Style_left__A3Sb6",right:"Style_right__HAMLz",message:"Style_message__YDsy6"},M=s(565),Z=s(65092),z=s(18440),x=s(34267),P=s(14006),k=s(55291);function F(S){const{lastCommit:{committerName:I,commitHash:W,message:B,timestamp:N,committerEmail:d},match:{params:{username:E,repositoryName:f}}}=S;return e.createElement("div",{className:g.CommitInfoBar},e.createElement("div",{className:g.left},e.createElement(k.Z,{committerEmail:d,committerName:I}),e.createElement("div",{className:g.message},B)),e.createElement("div",{className:g.right},e.createElement("div",{className:g.time},P.Ej.parseTimestampToDifference(N)),e.createElement(x.Z,{title:W},e.createElement("div",{className:g.commitHash},"\u6700\u540E\u63D0\u4EA4\uFF1A",e.createElement(M.rU,{to:z.Function.generateRepositoryCommitRoute({username:E,repositoryName:f,commitHash:W})},W.slice(0,7))))))}var X=(0,Z.EN)(e.memo(F))},42419:function(pe,V,s){"use strict";s.r(V),s.d(V,{default:function(){return It}});var e=s(89526),g={FileReader:"Style_FileReader__VYWMk",commitInfoBar:"Style_commitInfoBar__pc96f",contentWrapper:"Style_contentWrapper__1QyzE",readerWrapper:"Style_readerWrapper__sskDO",content:"Style_content__b0lNF"},M=s(97025),Z=s(83538),z=s(53546);function x(){return e.createElement(z.Z,{type:"warning",showIcon:!0,message:"\u4E8C\u8FDB\u5236\u6587\u4EF6\u65E0\u6CD5\u663E\u793A",description:"\u4F60\u53EF\u4EE5\u76F4\u63A5\u4E0B\u8F7D\u67E5\u770B\u539F\u6587\u4EF6"})}var P=e.memo(x);function k(){return e.createElement(z.Z,{type:"warning",showIcon:!0,message:"\u6587\u4EF6\u8FC7\u5927\uFF0C\u4E0D\u80FD\u76F4\u63A5\u67E5\u770B",description:"\u4F60\u53EF\u4EE5\u76F4\u63A5\u4E0B\u8F7D\u67E5\u770B\u539F\u6587\u4EF6"})}var F=e.memo(k),X=s(89368),S=s.n(X),I={CodeReader:"Style_CodeReader__5j23m",line:"Style_line__xH01W",commentIcon:"Style_commentIcon__z4nnu",lineNumber:"Style_lineNumber__eJtk2",codeWrapper:"Style_codeWrapper__V2+Ya",code:"Style_code__f+42a"},W=s(97028),B=s(5892),N=s(34267);function d(m){const{processing:o,highlightedCodeLines:t,onCodeLineClickFactory:a,hasCommentLineNumbers:r,hasComment:i,hasLineNumber:u}=m;return e.createElement(B.Z,{spinning:o},e.createElement("table",{className:`${I.CodeReader} hljs`},e.createElement("tbody",null,t.map((l,n)=>{const c=e.createElement("tr",{key:n,className:I.line,style:i?{}:{cursor:"auto"},onClick:typeof a=="function"?a(n+1):void 0},e.createElement("td",{className:I.commentIcon},Array.isArray(r)&&r.includes(n+1)?e.createElement(W.Z,null):null),u?e.createElement("td",null,e.createElement("code",{className:I.lineNumber},n+1)):null,e.createElement("td",{className:I.codeWrapper},e.createElement("pre",{className:I.code},e.createElement("code",{dangerouslySetInnerHTML:{__html:l}}))));return i?e.createElement(N.Z,{key:n,title:"\u70B9\u51FB\u67E5\u770B\u548C\u6DFB\u52A0\u6279\u6CE8",placement:"left"},c):c}))))}var E=e.memo(d),f=s(14006);function R(m){const{fileContent:o,hasLineNumber:t,hasComment:a,onCodeLineClickFactory:r,hasCommentLineNumbers:i}=m,[u,l]=(0,e.useState)([]),[n,c]=(0,e.useState)(!1);return(0,e.useEffect)(()=>{c(!0);let w;o instanceof Blob?w=f.$B.transformBlobToString(o):w=Promise.resolve(o),w.then(y=>f.EK.getHighlightedCodeLines(y)).then(y=>l(y)).finally(()=>c(!1))},[o]),e.createElement(E,{processing:n,hasLineNumber:t,hasComment:a,onCodeLineClickFactory:r,hasCommentLineNumbers:i,highlightedCodeLines:u})}var p=e.memo(R),C={MarkdownReader:"Style_MarkdownReader__KdJHV"},h=s(55327);function v(m){const{markdown:o,loading:t}=m;return e.createElement("div",{className:C.MarkdownReader},e.createElement(B.Z,{spinning:t},e.createElement(h.Z,{markdown:o})))}var b=e.memo(v),ee=(m,o,t)=>new Promise((a,r)=>{var i=n=>{try{l(t.next(n))}catch(c){r(c)}},u=n=>{try{l(t.throw(n))}catch(c){r(c)}},l=n=>n.done?a(n.value):Promise.resolve(n.value).then(i,u);l((t=t.apply(m,o)).next())});function Te(m){const[o,t]=(0,e.useState)(""),[a,r]=(0,e.useState)(!0),{fileContent:i}=m;return(0,e.useEffect)(()=>{(()=>ee(this,null,function*(){t(yield f.$B.transformBlobToString(i)),r(!1)}))().then(()=>r(!1)),r(!0)},[i]),e.createElement(b,{markdown:o,loading:a})}var Ie=e.memo(Te),Q={CodeCommentDrawer:"Style_CodeCommentDrawer__1aLLG",top:"Style_top__67MPV",mid:"Style_mid__LZdRC",bottom:"Style_bottom__OKUbn"},be=s(31243),re={CodeCommentForm:"Style_CodeCommentForm__DLtYy",textarea:"Style_textarea__xbhrc",buttonWrapper:"Style_buttonWrapper__jpzWt"},De=s(98001),_=s(30592);function Me(m){const{onSubmit:o,codeComment:t,onCodeCommentChange:a,submitting:r}=m;return e.createElement("form",{className:re.CodeCommentForm,onSubmit:o},e.createElement(De.Z.TextArea,{onChange:a,value:t,autoFocus:!0,placeholder:"\u60F3\u8981\u8865\u5145\u4E9B\u4EC0\u4E48\uFF1F",className:re.textarea,disabled:r}),e.createElement("div",{className:re.buttonWrapper},e.createElement(_.Z,{htmlType:"submit",type:"primary",disabled:r,loading:r},"\u63D0\u4EA4")))}var Ae=e.memo(Me),Y=s(65092),se=s(24315),A=s(62371),He=s(5939);const $="CODE_COMMENT_CHANGE";var G=new He.EventEmitter,Ue=s(50526),Ze=s(52518),te=(m,o,t)=>new Promise((a,r)=>{var i=n=>{try{l(t.next(n))}catch(c){r(c)}},u=n=>{try{l(t.throw(n))}catch(c){r(c)}},l=n=>n.done?a(n.value):Promise.resolve(n.value).then(i,u);l((t=t.apply(m,o)).next())});class We extends e.PureComponent{constructor(o){super(o);this.setStatePromise=t=>new Promise(a=>{this.setState(t,()=>{a()})}),this.init=()=>te(this,null,function*(){yield this.setStatePromise({codeComment:""})}),this.onCodeCommentChange=t=>{this.setState({codeComment:t.target.value})},this.onSubmit=t=>te(this,null,function*(){t.preventDefault();const{codeComment:a}=this.state;if(!Ue.codeCommentContent(a))se.Z.error({message:Ze.YW});else{const{match:{params:{username:r,repositoryName:i,path:u}},lineNumber:l,commitHash:n}=this.props;yield this.setStatePromise({submitting:!0}),(yield A.Ay.add({repositoryUsername:r,repositoryName:i,filePath:u,columnNumber:l,creationCommitHash:n,content:a}))!==null&&(se.Z.success({message:"\u4EE3\u7801\u6279\u6CE8\u6DFB\u52A0\u6210\u529F"}),yield this.init(),G.emit($)),yield this.setStatePromise({submitting:!1})}}),this.state={codeComment:"",submitting:!1}}componentDidMount(){return te(this,null,function*(){yield this.init()})}componentDidUpdate(o,t,a){return te(this,null,function*(){const{commitHash:r,lineNumber:i,match:{params:{path:u}}}=this.props,{commitHash:l,lineNumber:n,match:{params:{path:c}}}=o;(r!==l||i!==n||u!==c)&&(yield this.componentDidMount())})}render(){const{codeComment:o,submitting:t}=this.state;return e.createElement(Ae,{submitting:t,codeComment:o,onSubmit:this.onSubmit,onCodeCommentChange:this.onCodeCommentChange})}}var je=(0,Y.EN)(We),Ce={CodeCommentList:"Style_CodeCommentList__Lb0-t",itemWrapper:"Style_itemWrapper__zuwD1"},Oe=s(39207),Ve=s(37109),ze=s(34405),ie={CardTitle:"Style_CardTitle__H598x",modificationTimeWrapper:"Style_modificationTimeWrapper__b-UNw"},xe=s(55291);function Xe(m){const{profile:{username:o,email:t},modificationTimestamp:a,loading:r}=m;return e.createElement(B.Z,{spinning:r},e.createElement("div",{className:ie.CardTitle},e.createElement("div",{className:ie.personalCenterLinkWrapper},e.createElement(xe.Z,{committerName:o,committerEmail:t})),e.createElement("div",{className:ie.modificationTimeWrapper},"\u6700\u540E\u7F16\u8F91\u4E8E ",f.Ej.parseTimestampToDate(a))))}var Ye=e.memo(Xe),ve=s(60269),me=(m,o,t)=>new Promise((a,r)=>{var i=n=>{try{l(t.next(n))}catch(c){r(c)}},u=n=>{try{l(t.throw(n))}catch(c){r(c)}},l=n=>n.done?a(n.value):Promise.resolve(n.value).then(i,u);l((t=t.apply(m,o)).next())});class $e extends e.PureComponent{constructor(o){super(o);this.setStatePromise=t=>new Promise(a=>{this.setState(t,()=>{a()})}),this.loadProfile=()=>me(this,null,function*(){const{creatorUsername:t}=this.props,a=yield A.NZ.get({username:t});a!==null&&(yield this.setStatePromise({profile:a}))}),this.state={profile:new ve.NZ("","","",""),loading:!1}}componentDidMount(){return me(this,null,function*(){yield this.setStatePromise({loading:!0}),yield this.loadProfile(),yield this.setStatePromise({loading:!1})})}componentDidUpdate(o,t,a){return me(this,null,function*(){const{creatorUsername:r}=this.props,{creatorUsername:i}=o;r!==i&&(yield this.componentDidMount())})}render(){const{profile:o,loading:t}=this.state,{modificationTimestamp:a}=this.props;return e.createElement(Ye,{loading:t,profile:o,modificationTimestamp:a})}}var Ge=$e,le={CodeCommentItem:"Style_CodeCommentItem__ZmjbC",contentWrapper:"Style_contentWrapper__jG0wY",bottomWrapper:"Style_bottomWrapper__coFeD"},ye={CardBottom:"Style_CardBottom__Jygm2"},Je=s(23377);function Ke(m){const{onDeleteButtonClick:o,loading:t}=m;return e.createElement("div",{className:ye.CardBottom},e.createElement("div",{className:ye.buttonWrapper},e.createElement(Je.Z,{title:"\u786E\u8BA4\u5220\u9664\u4EE3\u7801\u6807\u6CE8\uFF1F",placement:"topLeft",onConfirm:o,disabled:t},e.createElement(_.Z,{size:"small",type:"primary",danger:!0,disabled:t,loading:t},"\u5220\u9664"))))}var ke=e.memo(Ke),Qe=(m,o,t)=>new Promise((a,r)=>{var i=n=>{try{l(t.next(n))}catch(c){r(c)}},u=n=>{try{l(t.throw(n))}catch(c){r(c)}},l=n=>n.done?a(n.value):Promise.resolve(n.value).then(i,u);l((t=t.apply(m,o)).next())});class _e extends e.PureComponent{constructor(o){super(o);this.setStatePromise=t=>new Promise(a=>{this.setState(t,()=>{a()})}),this.onDeleteButtonClick=()=>Qe(this,null,function*(){const{id:t}=this.props;yield this.setStatePromise({loading:!0}),(yield A.Ay.del({id:t}))!==null&&(se.Z.success({message:"\u5220\u9664\u6807\u6CE8\u6210\u529F"}),G.emit($)),yield this.setStatePromise({loading:!1})}),this.state={loading:!1}}render(){const{loading:o}=this.state;return e.createElement(ke,{loading:o,onDeleteButtonClick:this.onDeleteButtonClick})}}var qe=_e;function et(m){const{codeComment:{creatorUsername:o,modificationTimestamp:t,content:a,id:r}}=m;return e.createElement("div",{className:le.CodeCommentItem},e.createElement(ze.Z,{title:e.createElement(Ge,{creatorUsername:o,modificationTimestamp:t})},e.createElement("div",{className:le.contentWrapper},a),e.createElement("div",{className:le.bottomWrapper},e.createElement(qe,{id:r}))))}var tt=e.memo(et);function nt(m){const{codeComments:o,loading:t}=m;return e.createElement("div",{className:Ce.CodeCommentList},e.createElement(Oe.ZP,{loading:t,locale:{emptyText:e.createElement(Ve.Z,{description:"\u6CA1\u6709\u6279\u6CE8"})},dataSource:o,renderItem:a=>e.createElement("div",{className:Ce.itemWrapper,key:a.id},e.createElement(tt,{codeComment:a}))}))}var ot=e.memo(nt),ne=(m,o,t)=>new Promise((a,r)=>{var i=n=>{try{l(t.next(n))}catch(c){r(c)}},u=n=>{try{l(t.throw(n))}catch(c){r(c)}},l=n=>n.done?a(n.value):Promise.resolve(n.value).then(i,u);l((t=t.apply(m,o)).next())});class at extends e.PureComponent{constructor(o){super(o);this.setStatePromise=t=>new Promise(a=>{this.setState(t,()=>{a()})}),this.onListChange=()=>ne(this,null,function*(){return yield this.componentDidMount()}),this.loadCodeComments=()=>ne(this,null,function*(){const{lineNumber:t,commitHash:a,match:{params:{repositoryName:r,path:i,username:u}}}=this.props,l=yield A.Ay.get({repositoryUsername:u,repositoryName:r,columnNumber:t,filePath:i},a);if(l!==null){const{codeComments:n}=l;yield this.setStatePromise({codeComments:n})}}),this.state={codeComments:[],loading:!1},G.on($,this.onListChange)}componentDidMount(){return ne(this,null,function*(){yield this.setStatePromise({loading:!0}),yield this.loadCodeComments(),yield this.setStatePromise({loading:!1})})}componentDidUpdate(o,t,a){return ne(this,null,function*(){const{lineNumber:r,commitHash:i,match:{params:{path:u}}}=this.props,{lineNumber:l,commitHash:n,match:{params:{path:c}}}=o;(r!==l||i!==n||u!==c)&&(yield this.componentDidMount())})}componentWillUnmount(){G.removeListener($,this.onListChange)}render(){const{loading:o,codeComments:t}=this.state;return e.createElement(ot,{loading:o,codeComments:t})}}var rt=(0,Y.EN)(at);function st(m){const{visible:o,fileName:t,code:a,onClose:r,lineNumber:i,commitHash:u}=m;return e.createElement(be.Z,{destroyOnClose:!0,title:e.createElement("div",{className:Q.title},"\u4EE3\u7801\u6279\u6CE8 - ",t,":",i),visible:o,placement:"right",onClose:r,width:"33%"},e.createElement("div",{className:Q.CodeCommentDrawer},e.createElement("div",{className:Q.top},e.createElement(p,{fileContent:a,hasLineNumber:!1,hasComment:!1})),e.createElement("div",{className:Q.mid},e.createElement(rt,{commitHash:u,lineNumber:i})),e.createElement("div",{className:Q.bottom},e.createElement(je,{lineNumber:i,commitHash:u}))))}var it=e.memo(st),j={FileInfoBar:"Style_FileInfoBar__af0Fh",fileInfoWrapper:"Style_fileInfoWrapper__zKI-0",fileNameWrapper:"Style_fileNameWrapper__NlUvm",fileName:"Style_fileName__c6RLD",fileSize:"Style_fileSize__hk0X4"},Ee=s(565),Se=s(18440),mt=s(65293),lt=s(93948),ct=s(57132),ut=s(76320);function dt(m){const{fileSize:o,onRawFileButtonClick:t,match:{params:{username:a,repositoryName:r,commitHash:i,path:u}}}=m,l=S().basename(u);return e.createElement("div",{className:j.FileInfoBar},e.createElement("div",{className:j.fileInfoWrapper},e.createElement("div",{className:j.backLinkWrapper},e.createElement(Ee.rU,{to:Se.Function.generateRepositoryCodeRoute({username:a,repositoryName:r,commitHash:i,objectType:ut.LP.TREE,path:S().join(u,"..")})},e.createElement(_.Z,{size:"small"},e.createElement(lt.Z,null)))),e.createElement("div",{className:j.fileNameWrapper},e.createElement(ct.Z,null),e.createElement("div",{className:j.fileName}," ",l)),e.createElement("div",{className:j.fileSize},f.$B.parseFileSize(o))),e.createElement(mt.Z,{size:-1,className:j.buttonWrapper},e.createElement(_.Z,null,e.createElement(Ee.rU,{to:Se.Function.generateRepositoryCommitsRoute({username:a,repositoryName:r,commitHash:i,path:u})},"\u5386\u53F2")),e.createElement(_.Z,{onClick:t},"\u4E0B\u8F7D")))}var ft=(0,Y.EN)(dt),ht=s(19237),pt=(m,o,t)=>new Promise((a,r)=>{var i=n=>{try{l(t.next(n))}catch(c){r(c)}},u=n=>{try{l(t.throw(n))}catch(c){r(c)}},l=n=>n.done?a(n.value):Promise.resolve(n.value).then(i,u);l((t=t.apply(m,o)).next())});function Ct(m){const{fileSize:o,lastCommitHash:t}=m,{params:{username:a,repositoryName:r,path:i}}=(0,Y.$B)(),u=n=>{const c=URL.createObjectURL(n);f.$B.startDownload(c,S().basename(i)),URL.revokeObjectURL(c)},l=()=>pt(this,null,function*(){const n=yield ht.C.rawFile({username:a},{name:r},i,t);n!==null&&u(n)});return e.createElement(ft,{fileSize:o,onRawFileButtonClick:l})}var vt=e.memo(Ct),ce=s(61764),xt=s(70451);ce.v0.GlobalWorkerOptions.workerSrc="/pdf.worker.min.js";var Ne={PDFReader:"Style_PDFReader__l23wi",control:"Style_control__1y0hg"},yt=s(96446);function Et(m){const{pdfURL:o,pageNumber:t,onPDFLoadSuccess:a,pageAmount:r,onPaginationChange:i}=m;return e.createElement("div",{className:Ne.PDFReader},e.createElement(ce.BB,{file:o,loading:e.createElement(B.Z,{spinning:!0}),error:e.createElement(B.Z,{spinning:!0}),onLoadSuccess:a},e.createElement(ce.T3,{pageNumber:t})),e.createElement("div",{className:Ne.control},e.createElement(yt.Z,{pageSize:1,showSizeChanger:!1,showQuickJumper:!0,current:t,total:r,onChange:i})))}var St=e.memo(Et);function Nt(m){const{fileContent:o}=m,[t,a]=(0,e.useState)(0),[r,i]=(0,e.useState)(1),[u,l]=(0,e.useState)("");(0,e.useEffect)(()=>{l(URL.createObjectURL(o))},[o]),(0,e.useEffect)(()=>()=>URL.revokeObjectURL(u),[u]);const n=w=>{const{numPages:y}=w;a(y)},c=w=>{i(w)};return e.createElement(St,{pageNumber:r,pdfURL:u,pageAmount:t,onPaginationChange:c,onPDFLoadSuccess:n})}var Lt=e.memo(Nt),Le={ImageViewer:"Style_ImageViewer__2RibX",image:"Style_image__rBtQf"};function gt(m){const{url:o,loading:t}=m;return e.createElement("div",{className:Le.ImageViewer},e.createElement(B.Z,{spinning:t},e.createElement("img",{src:o,alt:"file preview",className:Le.image})))}var Ft=e.memo(gt);function Rt(m){const[o,t]=(0,e.useState)(""),{fileContent:a,loading:r}=m;return(0,e.useLayoutEffect)(()=>{const i=URL.createObjectURL(a);return t(i),()=>URL.revokeObjectURL(i)},[a]),e.createElement(Ft,{url:o,loading:r})}var Pt=e.memo(Rt);function Bt(m){const o=[".md",".markdown",".mdwn"],{isOversize:t,lastCommit:a,loading:r,fileContent:i,fileType:u,fileSize:l,fileName:n,onCodeLineClickFactory:c,hasCommentLineNumbers:w,drawerCode:y,drawerLineNumber:ue,drawerVisible:de,onDrawerClose:q}=m,fe=S().extname(n).toLowerCase(),K=u.toLowerCase(),oe=K.includes("text");return e.createElement(e.Fragment,null,e.createElement("div",{className:g.FileReader},e.createElement(M.Z,{loading:r,active:!0},e.createElement("div",{className:g.commitInfoBar},e.createElement(Z.Z,{lastCommit:a})),e.createElement("div",{className:g.contentWrapper},e.createElement("div",{className:g.fileInfoBarWrapper},e.createElement(vt,{fileSize:l,lastCommitHash:a.commitHash})),e.createElement("div",{className:g.readerWrapper},(()=>t?e.createElement(F,null):oe&&o.includes(fe)?e.createElement(Ie,{fileContent:i}):K.includes("pdf")?e.createElement(Lt,{fileContent:i}):oe||K.includes("json")?e.createElement(p,{fileContent:i,hasComment:!0,hasLineNumber:!0,onCodeLineClickFactory:c,hasCommentLineNumbers:w}):K.includes("image")?e.createElement(Pt,{loading:r,fileContent:i}):e.createElement(P,null))())))),e.createElement(it,{lineNumber:ue,code:y,visible:de,fileName:n,onClose:q,commitHash:a.commitHash}))}var wt=e.memo(Bt),ge=s(84259),J=(m,o,t)=>new Promise((a,r)=>{var i=n=>{try{l(t.next(n))}catch(c){r(c)}},u=n=>{try{l(t.throw(n))}catch(c){r(c)}},l=n=>n.done?a(n.value):Promise.resolve(n.value).then(i,u);l((t=t.apply(m,o)).next())});function Tt(){const[t,a]=(0,e.useState)(!1),[r,i]=(0,e.useState)(!1),[u,l]=(0,e.useState)(!1),[n,c]=(0,e.useState)(new ve.HL("","","",0,"","")),[w,y]=(0,e.useState)(!1),[ue,de]=(0,e.useState)("text"),[q,fe]=(0,e.useState)(new Blob),[K,oe]=(0,e.useState)(0),[Fe,bt]=(0,e.useState)([]),[Dt,Re]=(0,e.useState)(!1),[Mt,At]=(0,e.useState)(""),[Ht,Ut]=(0,e.useState)(0),{params:{username:H,repositoryName:U,path:D,commitHash:Pe}}=(0,Y.$B)(),Be=(0,Y.k6)(),Zt=(0,e.useMemo)(()=>Fe.map(({columnNumber:L})=>L),[Fe]),ae=(0,e.useMemo)(()=>()=>J(this,null,function*(){y(!0);const{commitHash:L}=n,T=yield A.Ay.get({repositoryUsername:H,repositoryName:U,filePath:D},L);if(T!==null){const{codeComments:O}=T;bt(O)}y(!1)}),[n,H,U,D]);(0,e.useEffect)(()=>{const L=()=>J(this,null,function*(){yield ae()});return G.on($,L),()=>{G.removeListener($,L)}},[ae]),(0,e.useEffect)(()=>{const L=()=>J(this,null,function*(){const T=yield A.CB.lastBranchCommit({username:H},{name:U},Pe,D);T!==null&&c(T)});y(!0),a(!1),L().then(()=>a(!0)).finally(()=>y(!1))},[H,U,D,Pe]),(0,e.useEffect)(()=>{const L=()=>J(this,null,function*(){const{commitHash:T}=n,O=yield A.CB.fileInfo({username:H},{name:U},D,T);if(O!==null){const{fileType:we,objectType:Vt,fileSize:he}=O;if(Vt===null)return Be.replace(ge.yt[ge.DV.NOT_FOUND]);{oe(he),de(we);const zt=we.toLowerCase().includes("text")?he>131072:he>5242880;l(zt)}}});t&&(y(!0),L().then(()=>i(!0)).finally(()=>y(!1)))},[n,H,U,D,Be,t,5242880,131072]),(0,e.useEffect)(()=>{t&&r&&(y(!0),ae().finally(()=>y(!1)))},[ae,t,r]),(0,e.useEffect)(()=>{const L=()=>J(this,null,function*(){const{commitHash:T}=n,O=yield A.CB.rawFile({username:H},{name:U},D,T);O!==null&&fe(O)});!u&&t&&r&&(y(!0),L().finally(()=>y(!1)))},[u,H,U,D,n,t,r]);const Wt=(0,e.useCallback)(L=>()=>J(this,null,function*(){Ut(L);const T=(yield f.$B.transformBlobToString(q)).split(`
`);At(T[L-1].trim()),Re(!0)}),[q]),jt=()=>{Re(!1)},Ot=(0,X.basename)(D);return e.createElement(wt,{fileSize:K,fileContent:q,fileType:ue,fileName:Ot,isOversize:u,lastCommit:n,loading:w,hasCommentLineNumbers:Zt,onCodeLineClickFactory:Wt,drawerCode:Mt,drawerLineNumber:Ht,drawerVisible:Dt,onDrawerClose:jt})}var It=e.memo(Tt)},55327:function(pe,V,s){"use strict";s.d(V,{Z:function(){return W}});var e=s(89526),g=s(65092),M=s(18440),Z=s(19237),z=s(84143),x=s.n(z),P=s(76320),k=s(89368),F=s.n(k),X=s(47365),S=(B,N,d)=>new Promise((E,f)=>{var R=h=>{try{C(d.next(h))}catch(v){f(v)}},p=h=>{try{C(d.throw(h))}catch(v){f(v)}},C=h=>h.done?E(h.value):Promise.resolve(h.value).then(R,p);C((d=d.apply(B,N)).next())});class I extends e.PureComponent{constructor(N){super(N);this.objectURLs=[],this.loadMainBranchName=()=>S(this,null,function*(){return new Promise(d=>S(this,null,function*(){const{match:{params:{username:E,repositoryName:f}}}=this.props,R=yield Z.C.branches({username:E,name:f});if(R!==null){const{branches:p}=R;for(const{name:C,isDefault:h}of p)if(h){this.setState({mainBranchName:C},()=>d());break}}}))}),this.processHTML=d=>S(this,null,function*(){const f=document.implementation.createHTMLDocument().createElement("div");f.innerHTML=d;const R=f.getElementsByTagName("a"),p=f.getElementsByTagName("img"),C=[];for(const h of R){const v=h.getAttribute("href");v!==null&&C.push((()=>S(this,null,function*(){h.setAttribute("href",yield this.getCompleteLink(v))}))())}for(const h of p){const v=h.getAttribute("src");v!==null&&C.push((()=>S(this,null,function*(){const b=yield this.getImageURL(v);this.objectURLs.push(b),h.setAttribute("src",b)}))())}return yield Promise.all(C),f.innerHTML}),this.getCompleteLink=d=>S(this,null,function*(){if(d.length===0||x()(d)||F().isAbsolute(d)||d.charAt(0)==="#"||d.charAt(0)==="?")return d;{const{match:{params:{username:E,repositoryName:f,objectType:R,commitHash:p,path:C}}}=this.props,{mainBranchName:h}=this.state,v=C?R===P.LP.BLOB?F().join(F().dirname(C),d):F().join(C,d):F().join("",d),b=yield Z.C.fileInfo({username:E},{name:f},v,p||h);if(b!==null){const{objectType:ee}=b;return ee===P.LP.BLOB?M.Function.generateRepositoryCodeRoute({username:E,repositoryName:f,commitHash:p||h,path:v,objectType:P.LP.BLOB}):ee===P.LP.TREE?M.Function.generateRepositoryCodeRoute({username:E,repositoryName:f,commitHash:p||h,path:v,objectType:P.LP.TREE}):M.Function.generateRepositoryCodeRoute({username:E,repositoryName:f,commitHash:p||h,path:v,objectType:P.LP.COMMIT})}else return M.Function.generateRepositoryCodeRoute({username:E,repositoryName:f,commitHash:p||h,path:v,objectType:P.LP.BLOB})}}),this.getImageURL=d=>S(this,null,function*(){if(x()(d)||F().isAbsolute(d))return d;{const{match:{params:{username:E,repositoryName:f,objectType:R,commitHash:p,path:C}}}=this.props,{mainBranchName:h}=this.state,v=C?R===P.LP.BLOB?F().join(F().dirname(C),d):F().join(C,d):F().join("",d),b=yield Z.C.rawFile({username:E},{name:f},v,p||h);return b!==null?URL.createObjectURL(b):d}}),this.state={mainBranchName:"",loading:!1}}componentDidMount(){return S(this,null,function*(){const{match:{params:{commitHash:N}}}=this.props;this.setState({loading:!0}),typeof N!="string"&&(yield this.loadMainBranchName()),this.setState({loading:!1})})}componentDidUpdate(N,d,E){return S(this,null,function*(){const{markdown:f}=this.props,{markdown:R}=N;f!==R&&(yield this.componentDidMount())})}componentWillUnmount(){this.objectURLs.forEach(N=>URL.revokeObjectURL(N))}render(){const{loading:N}=this.state,{markdown:d}=this.props;return e.createElement(X.Z,{markdown:d,processHTML:this.processHTML,loading:N})}}var W=(0,g.EN)(I)},14601:function(){},32767:function(){},28251:function(){},57677:function(){},1543:function(){},87324:function(){}}]);

//# sourceMappingURL=9681.6f358d06.chunk.js.map