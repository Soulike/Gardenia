(this["webpackJsonpsoulike-git"]=this["webpackJsonpsoulike-git"]||[]).push([[43],{1119:function(e,t,n){e.exports={Conflict:"Style_Conflict__3Vamq",conflictsWrapper:"Style_conflictsWrapper__1FN4k",conflictWrapper:"Style_conflictWrapper__2qm8Q",buttonWrapper:"Style_buttonWrapper__1QhqS"}},1120:function(e,t,n){e.exports={ConflictEditor:"Style_ConflictEditor__p1WcR",header:"Style_header__3Oayj",filePath:"Style_filePath__1iCwK",checkboxWrapper:"Style_checkboxWrapper__VLdFN",text:"Style_text__3S4yB"}},1391:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return je}));var r=n(2),a=n.n(r),c=n(4),o=n(14),s=n(15),i=n(39),l=n(38),u=n(1),p=n(0),d=n.n(p),f=n(1119),h=n.n(f),b=n(902),v=n(915),m=n(904),j=n(118),y=n(268),O=n(66),x=n(26),g=n(1120),k=n.n(g),C=n(6),N=n.n(C),R=n(5),w=n.n(R),P=n(8),S=n.n(P),E=n(29),_=n(49),q=n(13),F=n(32),D=n(36),B=n(40),W=n(169),I=n(123);function M(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function V(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?M(Object(n),!0).forEach((function(t){Object(q.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):M(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function U(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(I.a)(e);if(t){var a=Object(I.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(W.a)(this,n)}}var L=function(e){Object(B.a)(n,e);var t=U(n);function n(e){var r;Object(F.a)(this,n),(r=t.call(this,e)).handleChange=function(e){var t=r.props,n=t.disabled,a=t.onChange;n||("checked"in r.props||r.setState({checked:e.target.checked}),a&&a({target:V(V({},r.props),{},{checked:e.target.checked}),stopPropagation:function(){e.stopPropagation()},preventDefault:function(){e.preventDefault()},nativeEvent:e.nativeEvent}))},r.saveInput=function(e){r.input=e};var a="checked"in e?e.checked:e.defaultChecked;return r.state={checked:a},r}return Object(D.a)(n,[{key:"focus",value:function(){this.input.focus()}},{key:"blur",value:function(){this.input.blur()}},{key:"render",value:function(){var e,t=this.props,n=t.prefixCls,r=t.className,a=t.style,c=t.name,o=t.id,s=t.type,i=t.disabled,l=t.readOnly,u=t.tabIndex,p=t.onClick,f=t.onFocus,h=t.onBlur,b=t.autoFocus,v=t.value,m=t.required,j=Object(_.a)(t,["prefixCls","className","style","name","id","type","disabled","readOnly","tabIndex","onClick","onFocus","onBlur","autoFocus","value","required"]),y=Object.keys(j).reduce((function(e,t){return"aria-"!==t.substr(0,5)&&"data-"!==t.substr(0,5)&&"role"!==t||(e[t]=j[t]),e}),{}),O=this.state.checked,x=S()(n,r,(e={},Object(q.a)(e,"".concat(n,"-checked"),O),Object(q.a)(e,"".concat(n,"-disabled"),i),e));return d.a.createElement("span",{className:x,style:a},d.a.createElement("input",Object(E.a)({name:c,id:o,type:s,required:m,readOnly:l,disabled:i,tabIndex:u,className:"".concat(n,"-input"),checked:!!O,onClick:p,onFocus:f,onBlur:h,onChange:this.handleChange,autoFocus:b,ref:this.saveInput,value:v},y)),d.a.createElement("span",{className:"".concat(n,"-inner")}))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return"checked"in e?V(V({},t),{},{checked:e.checked}):null}}]),n}(p.Component);L.defaultProps={prefixCls:"rc-checkbox",className:"",style:{},type:"checkbox",defaultChecked:!1,onFocus:function(){},onBlur:function(){},onChange:function(){}};var T=L,z=n(127),H=n.n(z),$=n(18),J=n.n($),K=n(47),Q=n(110),A=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n},G=p.createContext(null),X=function(e){var t=e.defaultValue,n=e.children,r=e.options,a=void 0===r?[]:r,c=e.prefixCls,o=e.className,s=e.style,i=e.onChange,l=A(e,["defaultValue","children","options","prefixCls","className","style","onChange"]),u=p.useContext(Q.b),d=u.getPrefixCls,f=u.direction,h=p.useState(l.value||t||[]),b=J()(h,2),v=b[0],m=b[1],j=p.useState([]),y=J()(j,2),O=y[0],x=y[1];p.useEffect((function(){"value"in l&&m(l.value||[])}),[l.value]);var g=function(){return a.map((function(e){return"string"===typeof e?{label:e,value:e}:e}))},k=d("checkbox",c),C="".concat(k,"-group"),R=Object(K.a)(l,["value","disabled"]);a&&a.length>0&&(n=g().map((function(e){return p.createElement(re,{prefixCls:k,key:e.value.toString(),disabled:"disabled"in e?e.disabled:l.disabled,value:e.value,checked:-1!==v.indexOf(e.value),onChange:e.onChange,className:"".concat(C,"-item"),style:e.style},e.label)})));var P={toggleOption:function(e){var t=v.indexOf(e.value),n=H()(v);if(-1===t?n.push(e.value):n.splice(t,1),"value"in l||m(n),i){var r=g();i(n.filter((function(e){return-1!==O.indexOf(e)})).sort((function(e,t){return r.findIndex((function(t){return t.value===e}))-r.findIndex((function(e){return e.value===t}))})))}},value:v,disabled:l.disabled,name:l.name,registerValue:function(e){x((function(t){return[].concat(H()(t),[e])}))},cancelValue:function(e){x((function(t){return t.filter((function(t){return t!==e}))}))}},E=S()(C,N()({},"".concat(C,"-rtl"),"rtl"===f),o);return p.createElement("div",w()({className:E,style:s},R),p.createElement(G.Provider,{value:P},n))},Y=p.memo(X),Z=n(77),ee=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n},te=function(e,t){var n,r=e.prefixCls,a=e.className,c=e.children,o=e.indeterminate,s=void 0!==o&&o,i=e.style,l=e.onMouseEnter,u=e.onMouseLeave,d=ee(e,["prefixCls","className","children","indeterminate","style","onMouseEnter","onMouseLeave"]),f=p.useContext(Q.b),h=f.getPrefixCls,b=f.direction,v=p.useContext(G),m=p.useRef(d.value);p.useEffect((function(){null===v||void 0===v||v.registerValue(d.value),Object(Z.a)("checked"in d||!!v||!("value"in d),"Checkbox","`value` is not a valid prop, do you mean `checked`?")}),[]),p.useEffect((function(){return d.value!==m.current&&(null===v||void 0===v||v.cancelValue(m.current),null===v||void 0===v||v.registerValue(d.value)),function(){return null===v||void 0===v?void 0:v.cancelValue(d.value)}}),[d.value]);var j=h("checkbox",r),y=w()({},d);v&&(y.onChange=function(){d.onChange&&d.onChange.apply(d,arguments),v.toggleOption&&v.toggleOption({label:c,value:d.value})},y.name=v.name,y.checked=-1!==v.value.indexOf(d.value),y.disabled=d.disabled||v.disabled);var O=S()((n={},N()(n,"".concat(j,"-wrapper"),!0),N()(n,"".concat(j,"-rtl"),"rtl"===b),N()(n,"".concat(j,"-wrapper-checked"),y.checked),N()(n,"".concat(j,"-wrapper-disabled"),y.disabled),n),a),x=S()(N()({},"".concat(j,"-indeterminate"),s));return p.createElement("label",{className:O,style:i,onMouseEnter:l,onMouseLeave:u},p.createElement(T,w()({},y,{prefixCls:j,className:x,ref:t})),void 0!==c&&p.createElement("span",null,c))},ne=p.forwardRef(te);ne.displayName="Checkbox";var re=ne,ae=re;ae.Group=Y,ae.__ANT_CHECKBOX=!0;var ce=ae,oe=d.a.lazy((function(){return Promise.all([n.e(10),n.e(47)]).then(n.bind(null,1428))}));function se(e){var t=e.conflict.filePath,n=e.code,r=e.onCodeChange,a=e.onResolvedCheckboxChange,c=e.resolved;return Object(u.jsxs)("div",{className:k.a.ConflictEditor,children:[Object(u.jsxs)("div",{className:k.a.header,children:[Object(u.jsx)("code",{className:k.a.filePath,children:t}),Object(u.jsxs)("label",{className:k.a.checkboxWrapper,children:[Object(u.jsx)(ce,{onChange:a,checked:c}),Object(u.jsx)("div",{className:k.a.text,children:"\u5df2\u89e3\u51b3"})]})]}),Object(u.jsx)("div",{className:k.a.codeWrapper,style:c?{position:"fixed",top:"99999999px"}:{},children:Object(u.jsx)(oe,{onBeforeChange:r,value:n,options:{lineNumbers:!0,indentUnit:0}})})]})}var ie=d.a.memo(se),le=n(336),ue=function(e){Object(i.a)(n,e);var t=Object(l.a)(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).onCodeChange=function(e,t,n){r.setState({code:n})},r.onResolvedCheckboxChange=function(e){var t=r.state.code,n=r.props.conflict.filePath;-1!==t.search(/^<<<<<<< .+$/m)||-1!==t.search(/^=======$/m)||-1!==t.search(/^>>>>>>> .+$/m)?le.a.warning({message:Object(u.jsxs)("div",{children:[Object(u.jsx)("code",{children:n})," \u4e2d\u4ecd\u5b58\u5728\u51b2\u7a81"]}),description:"\u8bf7\u89e3\u51b3\u51b2\u7a81\uff0c\u5e76\u5220\u9664\u6240\u6709\u7684\u51b2\u7a81\u6807\u8bb0"}):r.setState({resolved:e.target.checked})},r.state={code:"",resolved:!1},r}return Object(s.a)(n,[{key:"componentDidMount",value:function(){var e=this.props.conflict.content;this.setState({code:e})}},{key:"componentDidUpdate",value:function(){var e=Object(c.a)(a.a.mark((function e(t,n,r){var c,o,s,i,l,u,p,d,f;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=this.props.conflict,o=t.conflict,c===o){e.next=5;break}return e.next=5,this.componentDidMount();case 5:if("function"!==typeof(s=this.props.onChange)){e.next=13;break}if(i=this.state,l=i.code,u=i.resolved,p=c.filePath,d=n.code,f=n.resolved,l===d&&u===f){e.next=13;break}return e.next=13,s(p,u,l);case 13:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state,t=e.code,n=e.resolved,r=this.props.conflict;return Object(u.jsx)(ie,{conflict:r,code:t,onCodeChange:this.onCodeChange,resolved:n,onResolvedCheckboxChange:this.onResolvedCheckboxChange})}}]),n}(p.PureComponent);function pe(e){var t=e.loading,n=e.pullRequest,r=n.sourceRepositoryUsername,a=n.sourceRepositoryName,c=n.sourceRepositoryBranchName,o=n.targetRepositoryUsername,s=n.targetRepositoryName,i=n.targetRepositoryBranchName,l=e.conflicts,p=e.onConflictChange,d=e.onSubmitButtonClick;return Object(u.jsx)("div",{className:h.a.Conflict,children:Object(u.jsxs)(b.a,{spinning:t,children:[Object(u.jsxs)("div",{className:h.a.alert,children:[Object(u.jsx)(v.a,{type:"info",banner:!0,showIcon:!0,message:Object(u.jsxs)("div",{children:["\u6b63\u5728\u89e3\u51b3 ",Object(u.jsx)(y.a,{to:O.Function.generateRepositoryCodeRoute({username:r,repositoryName:a,objectType:x.b.TREE,commitHash:c}),children:Object(u.jsxs)("code",{children:[r,"/",a,":",c]})})," \u5230 ",Object(u.jsx)(y.a,{to:O.Function.generateRepositoryCodeRoute({username:o,repositoryName:s,objectType:x.b.TREE,commitHash:i}),children:Object(u.jsxs)("code",{children:[o,"/",s,":",i]})})," \u7684\u5408\u5e76\u51b2\u7a81"]})}),Object(u.jsx)(v.a,{type:"warning",banner:!0,showIcon:!0,message:Object(u.jsxs)("div",{children:["\u6240\u505a\u7684\u4fee\u6539\u5c06\u88ab\u63d0\u4ea4\u5230 ",Object(u.jsxs)("code",{children:[r,"/",a,":",c]})]})})]}),Object(u.jsx)("div",{className:h.a.conflictsWrapper,children:l.map((function(e){return Object(u.jsx)("div",{className:h.a.conflictWrapper,children:Object(u.jsx)(ue,{conflict:e,onChange:p})},e.filePath)}))}),Object(u.jsx)("div",{className:h.a.buttonWrapper,children:Object(u.jsx)(m.a,{onConfirm:d,disabled:t,title:Object(u.jsxs)("div",{children:["\u786e\u8ba4\u51b2\u7a81\u89e3\u51b3\uff1f",Object(u.jsx)("br",{}),Object(u.jsxs)("strong",{children:["\u4ee5\u4e0a\u4fee\u6539\u90fd\u5c06\u88ab\u63d0\u4ea4\u5230 ",Object(u.jsxs)("code",{children:[r,"/",a,":",c]})]})]}),children:Object(u.jsx)(j.a,{type:"primary",size:"large",disabled:t,loading:t,children:"\u63d0\u4ea4"})})})]})})}var de=d.a.memo(pe),fe=n(62),he=n(148),be=n(30),ve=n(3),me=function(e){Object(i.a)(n,e);var t=Object(l.a)(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).checkURL=function(){var e=r.props,t=e.match.params.no,n=e.history,a=Number.parseInt(t);if(Number.isNaN(a))return n.replace(ve.d[ve.b.NOT_FOUND])},r.loadPullRequest=Object(c.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(c.a)(a.a.mark((function e(t){var n,c,o,s,i,l,u,p;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.props,c=n.match.params,o=c.username,s=c.repositoryName,i=c.no,l=n.history,u=Number.parseInt(i),e.next=4,be.h.get({username:o,name:s},{no:u});case 4:if(null===(p=e.sent)){e.next=14;break}if(p.status===x.c.OPEN){e.next=11;break}return le.a.warn({message:"Pull Request #".concat(u," \u5df2\u5173\u95ed\u6216\u5408\u5e76")}),t(),e.abrupt("return",l.replace(O.Function.generateRepositoryPullRequestRoute({username:o,repositoryName:s,no:i})));case 11:r.setState({pullRequest:p},(function(){return t()})),e.next=16;break;case 14:return t(),e.abrupt("return",l.replace(ve.d[ve.b.NOT_FOUND]));case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)}))),r.loadConflicts=Object(c.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(c.a)(a.a.mark((function e(t){var n,c,o,s,i,l,u,p,d,f;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.state.pullRequest,c=n.id,e.next=4,be.h.getConflicts({id:c});case 4:if(null===(o=e.sent)){e.next=18;break}if(s=o.conflicts,i=r.props,l=i.match.params,u=l.username,p=l.repositoryName,d=l.no,f=i.history,0!==s.length){e.next=14;break}return le.a.warn({message:"".concat(u,"/").concat(p," #").concat(d," \u6ca1\u6709\u5408\u5e76\u51b2\u7a81"),description:"\u60a8\u53ef\u76f4\u63a5\u6267\u884c\u5408\u5e76\u64cd\u4f5c"}),t(),e.abrupt("return",f.replace(O.Function.generateRepositoryPullRequestRoute({username:u,repositoryName:p,no:d})));case 14:s.forEach((function(e){if(e.isBinary)return le.a.warn({message:"\u5b58\u5728\u4e8c\u8fdb\u5236\u6587\u4ef6\u51b2\u7a81",description:"\u8bf7\u4f7f\u7528\u547d\u4ee4\u884c\u89e3\u51b3\u51b2\u7a81"}),t(),f.replace(O.Function.generateRepositoryPullRequestRoute({username:u,repositoryName:p,no:d}))}));case 15:r.setState({conflicts:s},(function(){return t()})),e.next=19;break;case 18:t();case 19:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)}))),r.onConflictChange=function(e,t,n){for(var a=r.state,c=a.conflicts,o=a.resolvedFilePath,s=0;s<c.length;s++){var i=c[s],l=i.filePath,u=i.isBinary,p=i.content;l===e&&n!==p&&(c[s]=new he.c(e,u,n)),t?o.add(e):o.delete(e)}},r.onSubmitButtonClick=Object(c.a)(a.a.mark((function e(){var t,n,c,o,s,i,l,u,p,d;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.state,n=t.pullRequest.id,c=t.resolvedFilePath,o=t.conflicts,o.map((function(e){return e.filePath})).length===c.size){e.next=6;break}le.a.error({message:"\u8bf7\u89e3\u51b3\u6240\u6709\u51b2\u7a81\u540e\u518d\u63d0\u4ea4"}),e.next=15;break;case 6:return r.setState({loading:!0}),e.next=9,be.h.resolveConflicts({id:n},o);case 9:if(null===e.sent){e.next=14;break}return le.a.success({message:"\u89e3\u51b3\u51b2\u7a81\u6210\u529f"}),s=r.props,i=s.history,l=s.match.params,u=l.username,p=l.repositoryName,d=l.no,e.abrupt("return",i.push(O.Function.generateRepositoryPullRequestRoute({username:u,repositoryName:p,no:d})));case 14:r.setState({loading:!1});case 15:case"end":return e.stop()}}),e)}))),r.state={pullRequest:new he.h(0,0,"","","","","","","","",0,0,"","",x.c.CLOSED),conflicts:[],loading:!1,resolvedFilePath:new Set},r}return Object(s.a)(n,[{key:"componentDidMount",value:function(){var e=Object(c.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.checkURL(),this.setState({loading:!0}),e.next=4,this.loadPullRequest();case 4:this.setState({loading:!1});case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(c.a)(a.a.mark((function e(t,n,r){var c,o,s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=this.props.location.pathname,o=this.props.location.pathname,c===o){e.next=5;break}return e.next=5,this.componentDidMount();case 5:if(s=this.state.pullRequest.id,n.pullRequest.id===s){e.next=12;break}return this.setState({loading:!0}),e.next=11,this.loadConflicts();case 11:this.setState({loading:!1});case 12:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state,t=e.loading,n=e.pullRequest,r=e.conflicts;return Object(u.jsx)(de,{loading:t,pullRequest:n,conflicts:r,onConflictChange:this.onConflictChange,onSubmitButtonClick:this.onSubmitButtonClick})}}]),n}(p.PureComponent),je=Object(fe.j)(me)}}]);
//# sourceMappingURL=43.7fc9233c.chunk.js.map