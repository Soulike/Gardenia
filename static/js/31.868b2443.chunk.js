(this["webpackJsonpsoulike-git"]=this["webpackJsonpsoulike-git"]||[]).push([[31],{1005:function(e,t,a){e.exports={SettingsTitle:"Style_SettingsTitle__rgD4i"}},1006:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(0),r=a.n(n),i=a(1005),l=a.n(i);var c=r.a.memo((function(e){var t=e.children;return r.a.createElement("h2",{className:l.a.SettingsTitle},t)}))},1023:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(0),r=a.n(n),i=a(201);var l=r.a.memo((function(){return r.a.createElement(i.a,{avatar:""})}))},1133:function(e,t,a){e.exports={Avatar:"Style_Avatar__2TmQb",body:"Style_body__eN9Pm",avatarWrapper:"Style_avatarWrapper__3wqvg",avatar:"Style_avatar__hT7wZ",fileInput:"Style_fileInput__1gSjB",buttonWrapper:"Style_buttonWrapper__1rFvY"}},1234:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return I}));var n=a(1),r=a.n(n),i=a(3),l=a(8),c=a(10),o=a(17),s=a(18),u=a(0),p=a.n(u),f=a(1133),v=a.n(f),m=a(1006),d=a(1023),g=a(961),h=a(232),_=a(82);var b=p.a.memo((function(e){var t=e.avatar,a=e.loading,n=e.fileInputRef,r=e.onAvatarClick,i=e.onAvatarInputChange,l=e.fileChanged,c=e.onUploadButtonClick;return p.a.createElement("div",{className:v.a.Avatar},p.a.createElement(m.a,null,"\u5934\u50cf"),p.a.createElement("div",{className:v.a.body},p.a.createElement(g.a,{spinning:a},p.a.createElement(h.a,{title:"\u70b9\u51fb\u66f4\u6362\u5934\u50cf"},p.a.createElement("div",{className:v.a.avatarWrapper,onClick:r},t?p.a.createElement("img",{src:t,alt:"avatar",className:v.a.avatar}):p.a.createElement(d.a,null)))),p.a.createElement("input",{type:"file",accept:"image/*",multiple:!1,className:v.a.fileInput,ref:n,onChange:i}),p.a.createElement("div",{className:v.a.buttonWrapper},p.a.createElement(_.a,{type:"primary",block:!0,disabled:a||!l,loading:a,onClick:c},"\u4e0a\u4f20"))))})),k=a(28),C=a(960),S=a(21),y=a(87),E=S.CONFIG.PAGE_ID,A=S.CONFIG.PAGE_ID_TO_ROUTE,I=function(e){Object(s.a)(a,e);var t=Object(o.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).fileInputRef=p.a.createRef(),n.setStatePromise=Object(y.promisify)(n.setState),n.loadAvatar=Object(i.a)(r.a.mark((function e(){var t,a,i;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.f.get();case 2:if(null===(t=e.sent)){e.next=9;break}return a=t.avatar,e.next=7,n.setStatePromise({avatar:a});case 7:e.next=11;break;case 9:return i=n.props.history,e.abrupt("return",i.replace(A[E.NOT_FOUND]));case 11:case"end":return e.stop()}}),e)}))),n.onAvatarClick=function(){var e=n.fileInputRef.current;null!==e&&e.click()},n.onAvatarInputChange=function(e){var t=e.target.files;if(null!==t&&t.length>0){var a=t[0];n.setState({file:a,avatar:URL.createObjectURL(a)})}},n.onUploadButtonClick=Object(i.a)(r.a.mark((function e(){var t;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==(t=n.state.file)){e.next=5;break}C.a.warn({message:"\u8bf7\u5148\u9009\u62e9\u5934\u50cf"}),e.next=11;break;case 5:return n.setState({loading:!0}),e.next=8,k.f.uploadAvatar(t);case 8:null!==e.sent&&(C.a.success({message:"\u4e0a\u4f20\u5934\u50cf\u6210\u529f"}),setTimeout((function(){window.location.reload()}),1e3)),n.setState({loading:!1});case 11:case"end":return e.stop()}}),e)}))),n.state={avatar:"",loading:!1,file:null},n}return Object(c.a)(a,[{key:"componentDidMount",value:function(){var e=Object(i.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.setStatePromise({loading:!0});case 2:return e.next=4,this.loadAvatar();case 4:return e.next=6,this.setStatePromise({loading:!1});case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state,t=e.avatar,a=e.loading,n=e.file;return p.a.createElement(b,{onAvatarInputChange:this.onAvatarInputChange,onAvatarClick:this.onAvatarClick,fileInputRef:this.fileInputRef,avatar:t,loading:a,fileChanged:null!==n,onUploadButtonClick:this.onUploadButtonClick})}}]),a}(u.PureComponent)}}]);
//# sourceMappingURL=31.868b2443.chunk.js.map