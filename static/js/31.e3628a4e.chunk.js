(this["webpackJsonpsoulike-git"]=this["webpackJsonpsoulike-git"]||[]).push([[31],{1072:function(e,t,a){e.exports={Avatar:"Style_Avatar__2TmQb",alertWrapper:"Style_alertWrapper__3gZd7",body:"Style_body__eN9Pm",avatarWrapper:"Style_avatarWrapper__3wqvg",avatar:"Style_avatar__hT7wZ",fileInput:"Style_fileInput__1gSjB",buttonWrapper:"Style_buttonWrapper__1rFvY"}},1334:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return I}));var n=a(2),r=a.n(n),i=a(6),s=a(14),c=a(15),l=a(39),o=a(38),u=a(0),p=a.n(u),v=a(1072),f=a.n(v),d=a(877),j=a(903),b=a(851),g=a(836),h=a(176),m=a(108),x=a(1);function _(e){var t=e.avatar,a=e.loading,n=e.fileInputRef,r=e.onAvatarClick,i=e.onAvatarInputChange,s=e.fileChanged,c=e.onUploadButtonClick,l=e.accept;return Object(x.jsxs)("div",{className:f.a.Avatar,children:[Object(x.jsx)(d.a,{children:"\u5934\u50cf"}),Object(x.jsx)("div",{className:f.a.alertWrapper,children:Object(x.jsx)(b.a,{message:"\u70b9\u51fb\u56fe\u7247\u9009\u62e9\u65b0\u7684\u5934\u50cf\uff0c\u56fe\u50cf\u6587\u4ef6\u5927\u5c0f 2M \u4ee5\u5185\u3002\u63a8\u8350\u4e0a\u4f20\u65b9\u5f62\u56fe\u50cf\uff0c\u5426\u5219\u56fe\u50cf\u4f1a\u88ab\u62c9\u4f38\u3002",banner:!0,type:"info",showIcon:!0})}),Object(x.jsxs)("div",{className:f.a.body,children:[Object(x.jsx)(g.a,{spinning:a,children:Object(x.jsx)(h.a,{title:"\u70b9\u51fb\u66f4\u6362\u5934\u50cf",children:Object(x.jsx)("div",{className:f.a.avatarWrapper,onClick:r,children:t?Object(x.jsx)("img",{src:t,alt:"avatar",className:f.a.avatar}):Object(x.jsx)(j.a,{})})})}),Object(x.jsx)("input",{type:"file",accept:l,multiple:!1,className:f.a.fileInput,ref:n,onChange:i}),Object(x.jsx)("div",{className:f.a.buttonWrapper,children:Object(x.jsx)(m.a,{type:"primary",block:!0,disabled:a||!s,loading:a,onClick:c,children:"\u4e0a\u4f20"})})]})]})}var O=p.a.memo(_),k=a(32),y=a(327),S=a(3),C=a(102),A=function(e){Object(l.a)(a,e);var t=Object(o.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).fileInputRef=p.a.createRef(),n.setStatePromise=Object(C.promisify)(n.setState),n.loadAvatar=Object(i.a)(r.a.mark((function e(){var t,a,i;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.g.get();case 2:if(null===(t=e.sent)){e.next=9;break}return a=t.avatar,e.next=7,n.setStatePromise({avatar:a});case 7:e.next=11;break;case 9:return i=n.props.history,e.abrupt("return",i.replace(S.d[S.b.NOT_FOUND]));case 11:case"end":return e.stop()}}),e)}))),n.onAvatarClick=function(){var e=n.fileInputRef.current;null!==e&&e.click()},n.onAvatarInputChange=function(e){var t=e.target.files;if(null!==t)if(1===t.length){var r=t[0],i=r.type;r.size<=2097152&&a.ALLOWED_MIME_TYPE.includes(i)?n.setState({file:r,avatar:URL.createObjectURL(r)}):y.a.error({message:"\u53ea\u80fd\u4e0a\u4f20 2M \u4ee5\u5185\u7684 JPG \u6216 PNG \u56fe\u50cf\u6587\u4ef6\u4f5c\u4e3a\u5934\u50cf"})}else y.a.error({message:"\u53ea\u80fd\u4e0a\u4f20\u4e00\u4e2a\u6587\u4ef6\u4f5c\u4e3a\u5934\u50cf"})},n.onUploadButtonClick=Object(i.a)(r.a.mark((function e(){var t;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==(t=n.state.file)){e.next=5;break}y.a.warn({message:"\u8bf7\u5148\u9009\u62e9\u5934\u50cf"}),e.next=11;break;case 5:return n.setState({loading:!0}),e.next=8,k.g.uploadAvatar(t);case 8:null!==e.sent&&(y.a.success({message:"\u4e0a\u4f20\u5934\u50cf\u6210\u529f"}),setTimeout((function(){window.location.reload()}),1e3)),n.setState({loading:!1});case 11:case"end":return e.stop()}}),e)}))),n.state={avatar:"",loading:!1,file:null},n}return Object(c.a)(a,[{key:"componentDidMount",value:function(){var e=Object(i.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.setStatePromise({loading:!0});case 2:return e.next=4,this.loadAvatar();case 4:return e.next=6,this.setStatePromise({loading:!1});case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state,t=e.avatar,n=e.loading,r=e.file;return Object(x.jsx)(O,{onAvatarInputChange:this.onAvatarInputChange,onAvatarClick:this.onAvatarClick,fileInputRef:this.fileInputRef,avatar:t,loading:n,fileChanged:null!==r,onUploadButtonClick:this.onUploadButtonClick,accept:a.ALLOWED_MIME_TYPE.join(",")})}}]),a}(u.PureComponent);A.ALLOWED_MIME_TYPE=["image/jpeg","image/png"];var I=A},876:function(e,t,a){e.exports={SettingsTitle:"Style_SettingsTitle__rgD4i"}},877:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(0),r=a.n(n),i=a(876),s=a.n(i),c=a(1);function l(e){var t=e.children;return Object(c.jsx)("h2",{className:s.a.SettingsTitle,children:t})}var o=r.a.memo(l)},903:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(0),r=a.n(n),i=a(218),s=a(1);function c(){return Object(s.jsx)(i.a,{avatar:""})}var l=r.a.memo(c)}}]);
//# sourceMappingURL=31.e3628a4e.chunk.js.map