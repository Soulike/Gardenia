(this["webpackJsonpsoulike-git"]=this["webpackJsonpsoulike-git"]||[]).push([[11],{1027:function(f,h,t){f.exports={CommitInfoBar:"Style_CommitInfoBar__AogMa",left:"Style_left__3aqnY",right:"Style_right__XNYqn",message:"Style_message__3Jq3M"}},1039:function(f,h,t){"use strict";t.d(h,"a",function(){return P});var R=t(0),m=t.n(R),e=t(1027),j=t.n(e),B=t(17),Q=t(47),G=t(49),T=t(174),$=t(68),O=t(353);function k(J){const{lastCommit:{committerName:x,commitHash:H,message:N,timestamp:C,committerEmail:E},match:{params:{username:y,repositoryName:b}}}=J;return m.a.createElement("div",{className:j.a.CommitInfoBar},m.a.createElement("div",{className:j.a.left},m.a.createElement(O.a,{committerEmail:E,committerName:x}),m.a.createElement("div",{className:j.a.message},N)),m.a.createElement("div",{className:j.a.right},m.a.createElement("div",{className:j.a.time},$.b.parseTimestampToDifference(C)),m.a.createElement(T.a,{title:H},m.a.createElement("div",{className:j.a.commitHash},"\u6700\u540E\u63D0\u4EA4\uFF1A",m.a.createElement(B.b,{to:G.Function.generateRepositoryCommitRoute({username:y,repositoryName:b,commitHash:H})},H.slice(0,7))))))}var P=Object(Q.j)(m.a.memo(k))},1040:function(f,h,t){"use strict";t.d(h,"a",function(){return x});var R=t(0),m=t.n(R),e=t(47),j=t(49),B=t(350),Q=t(1026),G=t.n(Q),T=t(22),$=t(1003),O=t.n($),k=t(252),P=(H,N,C)=>new Promise((E,y)=>{var b=v=>{try{p(C.next(v))}catch(g){y(g)}},S=v=>{try{p(C.throw(v))}catch(g){y(g)}},p=v=>v.done?E(v.value):Promise.resolve(v.value).then(b,S);p((C=C.apply(H,N)).next())});class J extends R.PureComponent{constructor(N){super(N);this.objectURLs=[],this.loadMainBranchName=()=>P(this,null,function*(){return new Promise(C=>P(this,null,function*(){const{match:{params:{username:E,repositoryName:y}}}=this.props,b=yield B.a.branches({username:E,name:y});if(b!==null){const{branches:S}=b;for(const{name:p,isDefault:v}of S)if(v){this.setState({mainBranchName:p},()=>C());break}}}))}),this.processHTML=C=>P(this,null,function*(){const y=document.implementation.createHTMLDocument().createElement("div");y.innerHTML=C;const b=y.getElementsByTagName("a"),S=y.getElementsByTagName("img"),p=[];for(const v of b){const g=v.getAttribute("href");g!==null&&p.push((()=>P(this,null,function*(){v.setAttribute("href",yield this.getCompleteLink(g))}))())}for(const v of S){const g=v.getAttribute("src");g!==null&&p.push((()=>P(this,null,function*(){const M=yield this.getImageURL(g);this.objectURLs.push(M),v.setAttribute("src",M)}))())}return yield Promise.all(p),y.innerHTML}),this.getCompleteLink=C=>P(this,null,function*(){if(C.length===0||G()(C)||O.a.isAbsolute(C)||C.charAt(0)==="#"||C.charAt(0)==="?")return C;{const{match:{params:{username:E,repositoryName:y,objectType:b,commitHash:S,path:p}}}=this.props,{mainBranchName:v}=this.state,g=p?b===T.b.BLOB?O.a.join(O.a.dirname(p),C):O.a.join(p,C):O.a.join("",C),M=yield B.a.fileInfo({username:E},{name:y},g,S||v);if(M!==null){const{objectType:te}=M;return te===T.b.BLOB?j.Function.generateRepositoryCodeRoute({username:E,repositoryName:y,commitHash:S||v,path:g,objectType:T.b.BLOB}):te===T.b.TREE?j.Function.generateRepositoryCodeRoute({username:E,repositoryName:y,commitHash:S||v,path:g,objectType:T.b.TREE}):j.Function.generateRepositoryCodeRoute({username:E,repositoryName:y,commitHash:S||v,path:g,objectType:T.b.COMMIT})}else return j.Function.generateRepositoryCodeRoute({username:E,repositoryName:y,commitHash:S||v,path:g,objectType:T.b.BLOB})}}),this.getImageURL=C=>P(this,null,function*(){if(G()(C)||O.a.isAbsolute(C))return C;{const{match:{params:{username:E,repositoryName:y,objectType:b,commitHash:S,path:p}}}=this.props,{mainBranchName:v}=this.state,g=p?b===T.b.BLOB?O.a.join(O.a.dirname(p),C):O.a.join(p,C):O.a.join("",C),M=yield B.a.rawFile({username:E},{name:y},g,S||v);return M!==null?URL.createObjectURL(M):C}}),this.state={mainBranchName:"",loading:!1}}componentDidMount(){return P(this,null,function*(){const{match:{params:{commitHash:N}}}=this.props;this.setState({loading:!0}),typeof N!="string"&&(yield this.loadMainBranchName()),this.setState({loading:!1})})}componentDidUpdate(N,C,E){return P(this,null,function*(){const{markdown:y}=this.props,{markdown:b}=N;y!==b&&(yield this.componentDidMount())})}componentWillUnmount(){this.objectURLs.forEach(N=>URL.revokeObjectURL(N))}render(){const{loading:N}=this.state,{markdown:C}=this.props;return m.a.createElement(k.a,{markdown:C,processHTML:this.processHTML,loading:N})}}var x=Object(e.j)(J)},1043:function(f,h){},1324:function(f,h,t){f.exports={FileReader:"Style_FileReader__3UwbJ",commitInfoBar:"Style_commitInfoBar__Q8via",contentWrapper:"Style_contentWrapper__WXjet",readerWrapper:"Style_readerWrapper__1-Blo",content:"Style_content___R5vO"}},1325:function(f,h,t){f.exports={CodeReader:"Style_CodeReader__yNPpi",line:"Style_line__2xQ8V",commentIcon:"Style_commentIcon__1fmDD",lineNumber:"Style_lineNumber__nX9YT",codeWrapper:"Style_codeWrapper__3J8o_",code:"Style_code__19ilK"}},1326:function(f,h,t){f.exports={MarkdownReader:"Style_MarkdownReader__2lNN5"}},1327:function(f,h,t){f.exports={CodeCommentDrawer:"Style_CodeCommentDrawer__1vYKD",top:"Style_top__1ZUZE",mid:"Style_mid__zKGSd",bottom:"Style_bottom__2avbu"}},1328:function(f,h,t){f.exports={CodeCommentForm:"Style_CodeCommentForm__1HwIU",textarea:"Style_textarea__3fx1d",buttonWrapper:"Style_buttonWrapper__3C6ZC"}},1329:function(f,h,t){f.exports={CodeCommentList:"Style_CodeCommentList__1G5Oh",itemWrapper:"Style_itemWrapper__3kY6G"}},1330:function(f,h,t){f.exports={CardTitle:"Style_CardTitle__271oV",modificationTimeWrapper:"Style_modificationTimeWrapper__2u105"}},1331:function(f,h,t){f.exports={CodeCommentItem:"Style_CodeCommentItem__3jXfA",contentWrapper:"Style_contentWrapper__3lLjk",bottomWrapper:"Style_bottomWrapper__AzNXW"}},1332:function(f,h,t){f.exports={CardBottom:"Style_CardBottom__52kk2"}},1333:function(f,h,t){f.exports={FileInfoBar:"Style_FileInfoBar__2_PqD",fileInfoWrapper:"Style_fileInfoWrapper__11WJK",fileNameWrapper:"Style_fileNameWrapper__AgwR-",fileName:"Style_fileName__3sh6Z",fileSize:"Style_fileSize__1nKjg"}},1334:function(f,h){},1335:function(f,h){},1336:function(f,h){},1337:function(f,h){},1338:function(f,h){},1340:function(f,h,t){f.exports={PDFReader:"Style_PDFReader__38Q-s",control:"Style_control__tcrMH"}},1341:function(f,h,t){f.exports={ImageViewer:"Style_ImageViewer__uLVEm",image:"Style_image__3l2_a"}},1388:function(f,h,t){"use strict";t.r(h),t.d(h,"default",function(){return Jt});var R={};t.r(R),t.d(R,"CODE_COMMENT_CHANGE",function(){return Je});var m=t(0),e=t.n(m),j=t(1324),B=t.n(j),Q=t(1399),G=t(1039),T=t(970);function $(){return e.a.createElement(T.a,{type:"warning",showIcon:!0,message:"\u4E8C\u8FDB\u5236\u6587\u4EF6\u65E0\u6CD5\u663E\u793A",description:"\u4F60\u53EF\u4EE5\u76F4\u63A5\u4E0B\u8F7D\u67E5\u770B\u539F\u6587\u4EF6"})}var O=e.a.memo($);function k(){return e.a.createElement(T.a,{type:"warning",showIcon:!0,message:"\u6587\u4EF6\u8FC7\u5927\uFF0C\u4E0D\u80FD\u76F4\u63A5\u67E5\u770B",description:"\u4F60\u53EF\u4EE5\u76F4\u63A5\u4E0B\u8F7D\u67E5\u770B\u539F\u6587\u4EF6"})}var P=e.a.memo(k),J=t(1003),x=t.n(J),H=t(1325),N=t.n(H),C=t(1431),E=t(955),y=t(174);function b(l){const{processing:o,highlightedCodeLines:a,onCodeLineClickFactory:s,hasCommentLineNumbers:r,hasComment:i,hasLineNumber:d}=l;return e.a.createElement(E.a,{spinning:o},e.a.createElement("table",{className:`${N.a.CodeReader} hljs`},e.a.createElement("tbody",null,a.map((c,n)=>{const u=e.a.createElement("tr",{key:n,className:N.a.line,style:i?{}:{cursor:"auto"},onClick:typeof s=="function"?s(n+1):void 0},e.a.createElement("td",{className:N.a.commentIcon},Array.isArray(r)&&r.includes(n+1)?e.a.createElement(C.a,null):null),d?e.a.createElement("td",null,e.a.createElement("code",{className:N.a.lineNumber},n+1)):null,e.a.createElement("td",{className:N.a.codeWrapper},e.a.createElement("pre",{className:N.a.code},e.a.createElement("code",{dangerouslySetInnerHTML:{__html:c}}))));return i?e.a.createElement(y.a,{key:n,title:"\u70B9\u51FB\u67E5\u770B\u548C\u6DFB\u52A0\u6279\u6CE8",placement:"left"},u):u}))))}var S=e.a.memo(b),p=t(68);function v(l){const{fileContent:o,hasLineNumber:a,hasComment:s,onCodeLineClickFactory:r,hasCommentLineNumbers:i}=l,[d,c]=Object(m.useState)([]),[n,u]=Object(m.useState)(!1);return Object(m.useEffect)(()=>{u(!0);let D;o instanceof Blob?D=p.c.transformBlobToString(o):D=Promise.resolve(o),D.then(F=>p.a.getHighlightedCodeLines(F)).then(F=>c(F)).finally(()=>u(!1))},[o]),e.a.createElement(S,{processing:n,hasLineNumber:a,hasComment:s,onCodeLineClickFactory:r,hasCommentLineNumbers:i,highlightedCodeLines:d})}var g=e.a.memo(v),M=t(1326),te=t.n(M),Be=t(1040);function De(l){const{markdown:o,loading:a}=l;return e.a.createElement("div",{className:te.a.MarkdownReader},e.a.createElement(E.a,{spinning:a},e.a.createElement(Be.a,{markdown:o})))}var Ie=e.a.memo(De),Me=(l,o,a)=>new Promise((s,r)=>{var i=n=>{try{c(a.next(n))}catch(u){r(u)}},d=n=>{try{c(a.throw(n))}catch(u){r(u)}},c=n=>n.done?s(n.value):Promise.resolve(n.value).then(i,d);c((a=a.apply(l,o)).next())});function we(l){const[o,a]=Object(m.useState)(""),[s,r]=Object(m.useState)(!0),{fileContent:i}=l;return Object(m.useEffect)(()=>{(()=>Me(this,null,function*(){a(yield p.c.transformBlobToString(i)),r(!1)}))().then(()=>r(!1)),r(!0)},[i]),e.a.createElement(Ie,{markdown:o,loading:s})}var xe=e.a.memo(we),He=t(1327),q=t.n(He),Ae=t(1408),Ue=t(1328),ie=t.n(Ue),We=t(962),_=t(103);function Ve(l){const{onSubmit:o,codeComment:a,onCodeCommentChange:s,submitting:r}=l;return e.a.createElement("form",{className:ie.a.CodeCommentForm,onSubmit:o},e.a.createElement(We.a.TextArea,{onChange:s,value:a,autoFocus:!0,placeholder:"\u60F3\u8981\u8865\u5145\u4E9B\u4EC0\u4E48\uFF1F",className:ie.a.textarea,disabled:r}),e.a.createElement("div",{className:ie.a.buttonWrapper},e.a.createElement(_.a,{htmlType:"submit",type:"primary",disabled:r,loading:r},"\u63D0\u4EA4")))}var ze=e.a.memo(Ve),ae=t(98),X=t(47),le=t(349),A=t(27),Ge=t(135);const Je="CODE_COMMENT_CHANGE";var K=new Ge.EventEmitter,ve=t(151),ne=(l,o,a)=>new Promise((s,r)=>{var i=n=>{try{c(a.next(n))}catch(u){r(u)}},d=n=>{try{c(a.throw(n))}catch(u){r(u)}},c=n=>n.done?s(n.value):Promise.resolve(n.value).then(i,d);c((a=a.apply(l,o)).next())});class Xe extends m.PureComponent{constructor(o){super(o);this.setStatePromise=Object(ae.promisify)(this.setState),this.init=()=>ne(this,null,function*(){yield this.setStatePromise({codeComment:""})}),this.onCodeCommentChange=a=>{this.setState({codeComment:a.target.value})},this.onSubmit=a=>ne(this,null,function*(){a.preventDefault();const{codeComment:s}=this.state;if(!ve.b.Repository.codeCommentContent(s))le.a.error({message:ve.a.Repository.CODE_COMMENT_CONTENT});else{const{match:{params:{username:r,repositoryName:i,path:d}},lineNumber:c,commitHash:n}=this.props;yield this.setStatePromise({submitting:!0}),(yield A.b.add({repositoryUsername:r,repositoryName:i,filePath:d,columnNumber:c,creationCommitHash:n,content:s}))!==null&&(le.a.success({message:"\u4EE3\u7801\u6279\u6CE8\u6DFB\u52A0\u6210\u529F"}),yield this.init(),K.emit(R.CODE_COMMENT_CHANGE)),yield this.setStatePromise({submitting:!1})}}),this.state={codeComment:"",submitting:!1}}componentDidMount(){return ne(this,null,function*(){yield this.init()})}componentDidUpdate(o,a,s){return ne(this,null,function*(){const{commitHash:r,lineNumber:i,match:{params:{path:d}}}=this.props,{commitHash:c,lineNumber:n,match:{params:{path:u}}}=o;(r!==c||i!==n||d!==u)&&(yield this.componentDidMount())})}render(){const{codeComment:o,submitting:a}=this.state;return e.a.createElement(ze,{submitting:a,codeComment:o,onSubmit:this.onSubmit,onCodeCommentChange:this.onCodeCommentChange})}}var Ke=Object(X.j)(Xe),Ye=t(1329),ye=t.n(Ye),Ze=t(1429),Qe=t(181),$e=t(967),ke=t(1330),me=t.n(ke),qe=t(353);function _e(l){const{profile:{username:o,email:a},modificationTimestamp:s,loading:r}=l;return e.a.createElement(E.a,{spinning:r},e.a.createElement("div",{className:me.a.CardTitle},e.a.createElement("div",{className:me.a.personalCenterLinkWrapper},e.a.createElement(qe.a,{committerName:o,committerEmail:a})),e.a.createElement("div",{className:me.a.modificationTimeWrapper},"\u6700\u540E\u7F16\u8F91\u4E8E ",p.b.parseTimestampToDate(s))))}var et=e.a.memo(_e),Ee=t(134),ce=(l,o,a)=>new Promise((s,r)=>{var i=n=>{try{c(a.next(n))}catch(u){r(u)}},d=n=>{try{c(a.throw(n))}catch(u){r(u)}},c=n=>n.done?s(n.value):Promise.resolve(n.value).then(i,d);c((a=a.apply(l,o)).next())});class tt extends m.PureComponent{constructor(o){super(o);this.setStatePromise=Object(ae.promisify)(this.setState),this.loadProfile=()=>ce(this,null,function*(){const{creatorUsername:a}=this.props,s=yield A.g.get({username:a});s!==null&&(yield this.setStatePromise({profile:s}))}),this.state={profile:new Ee.g("","","",""),loading:!1}}componentDidMount(){return ce(this,null,function*(){yield this.setStatePromise({loading:!0}),yield this.loadProfile(),yield this.setStatePromise({loading:!1})})}componentDidUpdate(o,a,s){return ce(this,null,function*(){const{creatorUsername:r}=this.props,{creatorUsername:i}=o;r!==i&&(yield this.componentDidMount())})}render(){const{profile:o,loading:a}=this.state,{modificationTimestamp:s}=this.props;return e.a.createElement(et,{loading:a,profile:o,modificationTimestamp:s})}}var at=tt,nt=t(1331),ue=t.n(nt),ot=t(1332),Se=t.n(ot),rt=t(959);function st(l){const{onDeleteButtonClick:o,loading:a}=l;return e.a.createElement("div",{className:Se.a.CardBottom},e.a.createElement("div",{className:Se.a.buttonWrapper},e.a.createElement(rt.a,{title:"\u786E\u8BA4\u5220\u9664\u4EE3\u7801\u6807\u6CE8\uFF1F",placement:"topLeft",onConfirm:o,disabled:a},e.a.createElement(_.a,{size:"small",type:"primary",danger:!0,disabled:a,loading:a},"\u5220\u9664"))))}var it=e.a.memo(st),lt=(l,o,a)=>new Promise((s,r)=>{var i=n=>{try{c(a.next(n))}catch(u){r(u)}},d=n=>{try{c(a.throw(n))}catch(u){r(u)}},c=n=>n.done?s(n.value):Promise.resolve(n.value).then(i,d);c((a=a.apply(l,o)).next())});class mt extends m.PureComponent{constructor(o){super(o);this.setStatePromise=Object(ae.promisify)(this.setState),this.onDeleteButtonClick=()=>lt(this,null,function*(){const{id:a}=this.props;yield this.setStatePromise({loading:!0}),(yield A.b.del({id:a}))!==null&&(le.a.success({message:"\u5220\u9664\u6807\u6CE8\u6210\u529F"}),K.emit(R.CODE_COMMENT_CHANGE)),yield this.setStatePromise({loading:!1})}),this.state={loading:!1}}render(){const{loading:o}=this.state;return e.a.createElement(it,{loading:o,onDeleteButtonClick:this.onDeleteButtonClick})}}var ct=mt;function ut(l){const{codeComment:{creatorUsername:o,modificationTimestamp:a,content:s,id:r}}=l;return e.a.createElement("div",{className:ue.a.CodeCommentItem},e.a.createElement($e.a,{title:e.a.createElement(at,{creatorUsername:o,modificationTimestamp:a})},e.a.createElement("div",{className:ue.a.contentWrapper},s),e.a.createElement("div",{className:ue.a.bottomWrapper},e.a.createElement(ct,{id:r}))))}var dt=e.a.memo(ut);function ft(l){const{codeComments:o,loading:a}=l;return e.a.createElement("div",{className:ye.a.CodeCommentList},e.a.createElement(Ze.b,{loading:a,locale:{emptyText:e.a.createElement(Qe.a,{description:"\u6CA1\u6709\u6279\u6CE8"})},dataSource:o,renderItem:s=>e.a.createElement("div",{className:ye.a.itemWrapper,key:s.id},e.a.createElement(dt,{codeComment:s}))}))}var Ct=e.a.memo(ft),oe=(l,o,a)=>new Promise((s,r)=>{var i=n=>{try{c(a.next(n))}catch(u){r(u)}},d=n=>{try{c(a.throw(n))}catch(u){r(u)}},c=n=>n.done?s(n.value):Promise.resolve(n.value).then(i,d);c((a=a.apply(l,o)).next())});class ht extends m.PureComponent{constructor(o){super(o);this.setStatePromise=Object(ae.promisify)(this.setState),this.onListChange=()=>oe(this,null,function*(){return yield this.componentDidMount()}),this.loadCodeComments=()=>oe(this,null,function*(){const{lineNumber:a,commitHash:s,match:{params:{repositoryName:r,path:i,username:d}}}=this.props,c=yield A.b.get({repositoryUsername:d,repositoryName:r,columnNumber:a,filePath:i},s);if(c!==null){const{codeComments:n}=c;yield this.setStatePromise({codeComments:n})}}),this.state={codeComments:[],loading:!1},K.on(R.CODE_COMMENT_CHANGE,this.onListChange)}componentDidMount(){return oe(this,null,function*(){yield this.setStatePromise({loading:!0}),yield this.loadCodeComments(),yield this.setStatePromise({loading:!1})})}componentDidUpdate(o,a,s){return oe(this,null,function*(){const{lineNumber:r,commitHash:i,match:{params:{path:d}}}=this.props,{lineNumber:c,commitHash:n,match:{params:{path:u}}}=o;(r!==c||i!==n||d!==u)&&(yield this.componentDidMount())})}componentWillUnmount(){K.removeListener(R.CODE_COMMENT_CHANGE,this.onListChange)}render(){const{loading:o,codeComments:a}=this.state;return e.a.createElement(Ct,{loading:o,codeComments:a})}}var pt=Object(X.j)(ht);function vt(l){const{visible:o,fileName:a,code:s,onClose:r,lineNumber:i,commitHash:d}=l;return e.a.createElement(Ae.a,{destroyOnClose:!0,title:e.a.createElement("div",{className:q.a.title},"\u4EE3\u7801\u6279\u6CE8 - ",a,":",i),visible:o,placement:"right",onClose:r,width:"33%"},e.a.createElement("div",{className:q.a.CodeCommentDrawer},e.a.createElement("div",{className:q.a.top},e.a.createElement(g,{fileContent:s,hasLineNumber:!1,hasComment:!1})),e.a.createElement("div",{className:q.a.mid},e.a.createElement(pt,{commitHash:d,lineNumber:i})),e.a.createElement("div",{className:q.a.bottom},e.a.createElement(Ke,{lineNumber:i,commitHash:d}))))}var yt=e.a.memo(vt),Et=t(1333),V=t.n(Et),Ne=t(17),ge=t(49),St=t(972),Nt=t(340),gt=t(1386),Ft=t(22);function bt(l){const{fileSize:o,onRawFileButtonClick:a,match:{params:{username:s,repositoryName:r,commitHash:i,path:d}}}=l,c=x.a.basename(d);return e.a.createElement("div",{className:V.a.FileInfoBar},e.a.createElement("div",{className:V.a.fileInfoWrapper},e.a.createElement("div",{className:V.a.backLinkWrapper},e.a.createElement(Ne.b,{to:ge.Function.generateRepositoryCodeRoute({username:s,repositoryName:r,commitHash:i,objectType:Ft.b.TREE,path:x.a.join(d,"..")})},e.a.createElement(_.a,{size:"small"},e.a.createElement(Nt.a,null)))),e.a.createElement("div",{className:V.a.fileNameWrapper},e.a.createElement(gt.a,null),e.a.createElement("div",{className:V.a.fileName}," ",c)),e.a.createElement("div",{className:V.a.fileSize},p.c.parseFileSize(o))),e.a.createElement(St.b,{size:-1,className:V.a.buttonWrapper},e.a.createElement(_.a,null,e.a.createElement(Ne.b,{to:ge.Function.generateRepositoryCommitsRoute({username:s,repositoryName:r,commitHash:i,path:d})},"\u5386\u53F2")),e.a.createElement(_.a,{onClick:a},"\u4E0B\u8F7D")))}var Lt=Object(X.j)(bt),Ot=t(350),Rt=(l,o,a)=>new Promise((s,r)=>{var i=n=>{try{c(a.next(n))}catch(u){r(u)}},d=n=>{try{c(a.throw(n))}catch(u){r(u)}},c=n=>n.done?s(n.value):Promise.resolve(n.value).then(i,d);c((a=a.apply(l,o)).next())});function jt(l){const{fileSize:o,lastCommitHash:a}=l,{params:{username:s,repositoryName:r,path:i}}=Object(X.i)(),d=n=>{const u=URL.createObjectURL(n);p.c.startDownload(u,x.a.basename(i)),URL.revokeObjectURL(u)},c=()=>Rt(this,null,function*(){const n=yield Ot.a.rawFile({username:s},{name:r},i,a);n!==null&&d(n)});return e.a.createElement(Lt,{fileSize:o,onRawFileButtonClick:c})}var Tt=e.a.memo(jt),de=t(1030),na=t(1339);de.c.GlobalWorkerOptions.workerSrc="/pdf.worker.min.js";var Pt=t(1340),Fe=t.n(Pt),Bt=t(1381);function Dt(l){const{pdfURL:o,pageNumber:a,onPDFLoadSuccess:s,pageAmount:r,onPaginationChange:i}=l;return e.a.createElement("div",{className:Fe.a.PDFReader},e.a.createElement(de.a,{file:o,loading:e.a.createElement(E.a,{spinning:!0}),error:e.a.createElement(E.a,{spinning:!0}),onLoadSuccess:s},e.a.createElement(de.b,{pageNumber:a})),e.a.createElement("div",{className:Fe.a.control},e.a.createElement(Bt.a,{pageSize:1,showSizeChanger:!1,showQuickJumper:!0,current:a,total:r,onChange:i})))}var It=e.a.memo(Dt);function Mt(l){const{fileContent:o}=l,[a,s]=Object(m.useState)(0),[r,i]=Object(m.useState)(1),[d,c]=Object(m.useState)("");Object(m.useEffect)(()=>{c(URL.createObjectURL(o))},[o]),Object(m.useEffect)(()=>()=>URL.revokeObjectURL(d),[d]);const n=D=>{const{numPages:F}=D;s(F)},u=D=>{i(D)};return e.a.createElement(It,{pageNumber:r,pdfURL:d,pageAmount:a,onPaginationChange:u,onPDFLoadSuccess:n})}var wt=e.a.memo(Mt),xt=t(1341),be=t.n(xt);function Ht(l){const{url:o,loading:a}=l;return e.a.createElement("div",{className:be.a.ImageViewer},e.a.createElement(E.a,{spinning:a},e.a.createElement("img",{src:o,alt:"file preview",className:be.a.image})))}var At=e.a.memo(Ht);function Ut(l){const[o,a]=Object(m.useState)(""),{fileContent:s,loading:r}=l;return Object(m.useLayoutEffect)(()=>{const i=URL.createObjectURL(s);return a(i),()=>URL.revokeObjectURL(i)},[s]),e.a.createElement(At,{url:o,loading:r})}var Wt=e.a.memo(Ut);function Vt(l){const o=[".md",".markdown",".mdwn"],{isOversize:a,lastCommit:s,loading:r,fileContent:i,fileType:d,fileSize:c,fileName:n,onCodeLineClickFactory:u,hasCommentLineNumbers:D,drawerCode:F,drawerLineNumber:fe,drawerVisible:Ce,onDrawerClose:ee}=l,he=x.a.extname(n).toLowerCase(),Z=d.toLowerCase(),re=Z.includes("text");return e.a.createElement(e.a.Fragment,null,e.a.createElement("div",{className:B.a.FileReader},e.a.createElement(Q.a,{loading:r,active:!0},e.a.createElement("div",{className:B.a.commitInfoBar},e.a.createElement(G.a,{lastCommit:s})),e.a.createElement("div",{className:B.a.contentWrapper},e.a.createElement("div",{className:B.a.fileInfoBarWrapper},e.a.createElement(Tt,{fileSize:c,lastCommitHash:s.commitHash})),e.a.createElement("div",{className:B.a.readerWrapper},(()=>a?e.a.createElement(P,null):re&&o.includes(he)?e.a.createElement(xe,{fileContent:i}):Z.includes("pdf")?e.a.createElement(wt,{fileContent:i}):re||Z.includes("json")?e.a.createElement(g,{fileContent:i,hasComment:!0,hasLineNumber:!0,onCodeLineClickFactory:u,hasCommentLineNumbers:D}):Z.includes("image")?e.a.createElement(Wt,{loading:r,fileContent:i}):e.a.createElement(O,null))())))),e.a.createElement(yt,{lineNumber:fe,code:F,visible:Ce,fileName:n,onClose:ee,commitHash:s.commitHash}))}var zt=e.a.memo(Vt),Le=t(360),Y=(l,o,a)=>new Promise((s,r)=>{var i=n=>{try{c(a.next(n))}catch(u){r(u)}},d=n=>{try{c(a.throw(n))}catch(u){r(u)}},c=n=>n.done?s(n.value):Promise.resolve(n.value).then(i,d);c((a=a.apply(l,o)).next())});function Gt(){const l=128*1024,o=5*1024*1024,[a,s]=Object(m.useState)(!1),[r,i]=Object(m.useState)(!1),[d,c]=Object(m.useState)(!1),[n,u]=Object(m.useState)(new Ee.b("","","",0,"","")),[D,F]=Object(m.useState)(!1),[fe,Ce]=Object(m.useState)("text"),[ee,he]=Object(m.useState)(new Blob),[Z,re]=Object(m.useState)(0),[Oe,Xt]=Object(m.useState)([]),[Kt,Re]=Object(m.useState)(!1),[Yt,Zt]=Object(m.useState)(""),[Qt,$t]=Object(m.useState)(0),{params:{username:U,repositoryName:W,path:w,commitHash:je}}=Object(X.i)(),Te=Object(X.f)(),kt=Object(m.useMemo)(()=>Oe.map(({columnNumber:L})=>L),[Oe]),se=Object(m.useMemo)(()=>()=>Y(this,null,function*(){F(!0);const{commitHash:L}=n,I=yield A.b.get({repositoryUsername:U,repositoryName:W,filePath:w},L);if(I!==null){const{codeComments:z}=I;Xt(z)}F(!1)}),[n,U,W,w]);Object(m.useEffect)(()=>{const L=()=>Y(this,null,function*(){yield se()});return K.on(R.CODE_COMMENT_CHANGE,L),()=>{K.removeListener(R.CODE_COMMENT_CHANGE,L)}},[se]),Object(m.useEffect)(()=>{const L=()=>Y(this,null,function*(){const I=yield A.j.lastBranchCommit({username:U},{name:W},je,w);I!==null&&u(I)});F(!0),s(!1),L().then(()=>s(!0)).finally(()=>F(!1))},[U,W,w,je]),Object(m.useEffect)(()=>{const L=()=>Y(this,null,function*(){const{commitHash:I}=n,z=yield A.j.fileInfo({username:U},{name:W},w,I);if(z!==null){const{fileType:Pe,objectType:ta,fileSize:pe}=z;if(ta===null)return Te.replace(Le.c[Le.a.NOT_FOUND]);{re(pe),Ce(Pe);const aa=Pe.toLowerCase().includes("text")?pe>l:pe>o;c(aa)}}});a&&(F(!0),L().then(()=>i(!0)).finally(()=>F(!1)))},[n,U,W,w,Te,a,o,l]),Object(m.useEffect)(()=>{a&&r&&(F(!0),se().finally(()=>F(!1)))},[se,a,r]),Object(m.useEffect)(()=>{const L=()=>Y(this,null,function*(){const{commitHash:I}=n,z=yield A.j.rawFile({username:U},{name:W},w,I);z!==null&&he(z)});!d&&a&&r&&(F(!0),L().finally(()=>F(!1)))},[d,U,W,w,n,a,r]);const qt=Object(m.useCallback)(L=>()=>Y(this,null,function*(){$t(L);const I=(yield p.c.transformBlobToString(ee)).split(`
`);Zt(I[L-1].trim()),Re(!0)}),[ee]),_t=()=>{Re(!1)},ea=Object(J.basename)(w);return e.a.createElement(zt,{fileSize:Z,fileContent:ee,fileType:fe,fileName:ea,isOversize:d,lastCommit:n,loading:D,hasCommentLineNumbers:kt,onCodeLineClickFactory:qt,drawerCode:Yt,drawerLineNumber:Qt,drawerVisible:Kt,onDrawerClose:_t})}var Jt=e.a.memo(Gt)}}]);

//# sourceMappingURL=11.2f1ef157.chunk.js.map