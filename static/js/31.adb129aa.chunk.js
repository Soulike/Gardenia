(this["webpackJsonpsoulike-git"]=this["webpackJsonpsoulike-git"]||[]).push([[31],{1167:function(e,t,a){e.exports={CommitInfoBar:"Style_CommitInfoBar__AogMa",left:"Style_left__3aqnY",right:"Style_right__XNYqn",avatar:"Style_avatar__2CYzj",name:"Style_name__3WHXI"}},1181:function(e,t,a){"use strict";a(339);var n=a(156),r=a(0),s=a.n(r),i=a(1167),o=a.n(i),c=a(15),m=a(132),u=a(32),l=a(97);var p=Object(m.f)(s.a.memo((function(e){const{lastCommit:{committerName:t,commitHash:a,message:r,timestamp:i},match:{params:{username:m,repository:p}}}=e;return s.a.createElement("div",{className:o.a.CommitInfoBar},s.a.createElement("div",{className:o.a.left},s.a.createElement(c.b,{className:o.a.name,to:u.Function.generatePersonalCenterRoute({username:t})},t),s.a.createElement("div",{className:o.a.message},r)),s.a.createElement("div",{className:o.a.right},s.a.createElement("div",{className:o.a.time},l.b.parseTimestampToDifference(i)),s.a.createElement(n.a,{title:a},s.a.createElement("div",{className:o.a.commitHash},"\u6700\u540e\u63d0\u4ea4\uff1a",s.a.createElement(c.b,{to:u.Function.generateRepositoryCommitRoute({username:m,repository:p,commitHash:a})},a.slice(0,7))))))})));a.d(t,"a",(function(){return p}))},1182:function(e,t,a){"use strict";var n=a(0),r=a.n(n),s=a(132),i=a(32),o=a(342),c=a(1166),m=a.n(c),u=a(20),l=a(1140),p=a.n(l),h=a(249);class f extends n.PureComponent{constructor(e){super(e),this.objectURLs=[],this.loadMainBranchName=async()=>new Promise(async e=>{const{match:{params:{username:t,repository:a}}}=this.props,n=await o.a.branches({username:t,name:a});if(null!==n){const{branches:t}=n;for(const{name:a,isDefault:n}of t)if(n){this.setState({mainBranchName:a},()=>e());break}}}),this.processHTML=async e=>{const t=document.implementation.createHTMLDocument().createElement("div");t.innerHTML=e;const a=t.getElementsByTagName("a"),n=t.getElementsByTagName("img"),r=[];for(const s of a){const e=s.getAttribute("href");null!==e&&r.push((async()=>{s.setAttribute("href",await this.getCompleteLink(e))})())}for(const s of n){const e=s.getAttribute("src");null!==e&&r.push((async()=>{const t=await this.getImageURL(e);this.objectURLs.push(t),s.setAttribute("src",t)})())}return await Promise.all(r),t.innerHTML},this.getCompleteLink=async e=>{if(0===e.length||m()(e)||p.a.isAbsolute(e)||"#"===e.charAt(0)||"?"===e.charAt(0))return e;{const{match:{params:{username:t,repository:a,objectType:n,branch:r,path:s}}}=this.props,{mainBranchName:c}=this.state,m=s?n===u.b.BLOB?p.a.join(p.a.dirname(s),e):p.a.join(s,e):p.a.join("",e),l=await o.a.fileInfo({username:t},{name:a},m,r||c);if(null!==l){const{exists:e,type:n}=l;return e&&n!==u.b.BLOB?i.Function.generateRepositoryCodeRoute({username:t,repository:a,branch:r||c,path:m,objectType:u.b.TREE}):i.Function.generateRepositoryCodeRoute({username:t,repository:a,branch:r||c,path:m,objectType:u.b.BLOB})}return i.Function.generateRepositoryCodeRoute({username:t,repository:a,branch:r||c,path:m,objectType:u.b.BLOB})}},this.getImageURL=async e=>{if(m()(e)||p.a.isAbsolute(e))return e;{const{match:{params:{username:t,repository:a,objectType:n,branch:r,path:s}}}=this.props,{mainBranchName:i}=this.state,c=s?n===u.b.BLOB?p.a.join(p.a.dirname(s),e):p.a.join(s,e):p.a.join("",e),m=await o.a.rawFile({username:t},{name:a},c,r||i);return null!==m?URL.createObjectURL(m):e}},this.state={mainBranchName:"",loading:!1}}async componentDidMount(){const{match:{params:{branch:e}}}=this.props;this.setState({loading:!0}),"string"!==typeof e&&await this.loadMainBranchName(),this.setState({loading:!1})}async componentDidUpdate(e,t,a){const{markdown:n}=this.props,{markdown:r}=e;n!==r&&await this.componentDidMount()}componentWillUnmount(){this.objectURLs.forEach(e=>URL.revokeObjectURL(e))}render(){const{loading:e}=this.state,{markdown:t}=this.props;return r.a.createElement(h.a,{markdown:t,processHTML:this.processHTML,loading:e})}}var d=Object(s.f)(f);a.d(t,"a",(function(){return d}))},1277:function(e,t,a){e.exports={FileList:"Style_FileList__3rWIg",lastCommitInfoBar:"Style_lastCommitInfoBar__2XW39",readmeWrapper:"Style_readmeWrapper__25GwL"}},1278:function(e,t,a){e.exports={Item:"Style_Item__2qcqg",icon:"Style_icon__1TlO4",fileName:"Style_fileName__zs9qY",message:"Style_message__1rBHL",time:"Style_time__2cJ9G"}},1279:function(e,t,a){e.exports={Readme:"Style_Readme__2e1Tq",title:"Style_title__2mCc5",contentWrapper:"Style_contentWrapper__3fQZA"}},1341:function(e,t,a){"use strict";a.r(t);var n=a(1127),r=a(3),s=a.n(r),i=a(7),o=a(1113),c=a(1114),m=a(1116),u=a(1115),l=a(1117),p=a(0),h=a.n(p),f=(a(1129),a(1128)),d=(a(340),a(103)),b=a(1277),y=a.n(b),v=a(20),g=a(15),x=a(132),j=a(1278),k=a.n(j),w=a(32),_=a(97),E=a(1367),N=a(1368);var B=Object(x.f)(h.a.memo((function(e){const{masterBranchName:t,fileInfo:{type:a,path:n,commit:{message:r,timestamp:s,commitHash:i}},match:{params:{username:o,repository:c,branch:m}}}=e,u=function(e){const t=e.split("/");return t[t.length-1]}(n);return h.a.createElement(f.a.Item,{className:k.a.Item},a===v.b.BLOB?h.a.createElement(E.a,{className:k.a.icon}):h.a.createElement(N.a,{className:k.a.icon}),h.a.createElement("div",{className:k.a.fileName},h.a.createElement(g.b,{to:w.Function.generateRepositoryCodeRoute({username:o,repository:c,objectType:a,branch:m||t,path:n})},u)),h.a.createElement(g.b,{className:k.a.message,to:w.Function.generateRepositoryCommitRoute({username:o,repository:c,commitHash:i})},r),h.a.createElement("div",{className:k.a.time},_.b.parseTimestampToDifference(s)))}))),O=(a(142),a(73)),L=a(1279),S=a.n(L),R=a(1182);var C=h.a.memo((function(e){const{readme:t,exists:a,loading:n}=e;return a?h.a.createElement("div",{className:S.a.Readme},h.a.createElement(O.a,{spinning:n},h.a.createElement("div",{className:S.a.title},"README.md"),h.a.createElement("div",{className:S.a.contentWrapper},h.a.createElement(R.a,{markdown:t})))):null})),M=a(342),D=a(1140),T=a(1120),I=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(m.a)(this,Object(u.a)(t).call(this,e))).setStatePromise=Object(T.promisify)(a.setState),a.loadRawReadme=Object(i.a)(s.a.mark((function e(){var t,n,r,i,o,c,m,u,l,p,h,f;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.setStatePromise({exists:!1});case 2:t=["README.md","readme.md","readMe.md","ReadMe.md","README.MD","readme.MD","readMe.MD","ReadMe.MD"],n=a.props,r=n.match.params,i=r.username,o=r.repository,c=r.path,m=n.commitHash,u=0,l=t;case 5:if(!(u<l.length)){e.next=26;break}return p=l[u],e.next=9,M.a.fileInfo({username:i},{name:o},Object(D.join)(c||"",p),m);case 9:if(null===(h=e.sent)||!h.exists){e.next=23;break}return e.next=13,M.a.rawFile({username:i},{name:o},Object(D.join)(c||"",p),m);case 13:if(null===(f=e.sent)){e.next=22;break}return e.t0=a,e.next=18,_.c.transformBlobToString(f);case 18:return e.t1=e.sent,e.t2={readme:e.t1,exists:!0},e.next=22,e.t0.setStatePromise.call(e.t0,e.t2);case 22:return e.abrupt("break",26);case 23:u++,e.next=5;break;case 26:case"end":return e.stop()}}),e)}))),a.state={exists:!1,readme:"",loading:!1},a}return Object(l.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=Object(i.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.props.commitHash){e.next=8;break}return e.next=4,this.setStatePromise({loading:!0});case 4:return e.next=6,this.loadRawReadme();case 6:return e.next=8,this.setStatePromise({loading:!1});case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(i.a)(s.a.mark((function e(t,a,n){var r,i,o,c,m;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.props,i=r.location.pathname,o=r.commitHash,c=t.location.pathname,m=t.commitHash,i===c&&o===m){e.next=5;break}return e.next=5,this.componentDidMount();case 5:case"end":return e.stop()}}),e,this)})));return function(t,a,n){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state,t=e.readme,a=e.exists,n=e.loading;return h.a.createElement(C,{exists:a,readme:t,loading:n})}}]),t}(p.PureComponent),H=Object(x.f)(I),P=a(1181);const F=h.a.lazy(()=>a.e(47).then(a.bind(null,1366)));var A=h.a.memo((function(e){const{fileList:t,lastCommit:a,loading:n,showPreviousFolderItem:r,masterBranchName:s}=e,{commitHash:i}=a;return h.a.createElement(h.a.Fragment,null,h.a.createElement("div",{className:y.a.FileList},h.a.createElement("div",{className:y.a.lastCommitInfoBar},h.a.createElement(P.a,{lastCommit:a})),h.a.createElement(f.a,{locale:{emptyText:h.a.createElement(d.a,{description:"\u6ca1\u6709\u6587\u4ef6"})},loading:n,className:y.a.fileList},r?h.a.createElement(F,null):null,t.map(e=>h.a.createElement(B,{masterBranchName:s,fileInfo:e,key:e.path})))),h.a.createElement("div",{className:y.a.readmeWrapper},h.a.createElement(H,{commitHash:i})))})),U=a(45),W=a(115),q=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(m.a)(this,Object(u.a)(t).call(this,e))).loadMasterBranchName=Object(i.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(i.a)(s.a.mark((function e(t){var n,r,i,o,c,m,u,l,p,h,f,d,b;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.props.match.params,r=n.username,i=n.repository,e.next=3,U.h.branches({username:r,name:i});case 3:if(null===(o=e.sent)){e.next=35;break}c=o.branches,m="",u=!0,l=!1,p=void 0,e.prev=10,h=c[Symbol.iterator]();case 12:if(u=(f=h.next()).done){e.next=20;break}if(d=f.value,b=d.name,!d.isDefault){e.next=17;break}return m=b,e.abrupt("break",20);case 17:u=!0,e.next=12;break;case 20:e.next=26;break;case 22:e.prev=22,e.t0=e.catch(10),l=!0,p=e.t0;case 26:e.prev=26,e.prev=27,u||null==h.return||h.return();case 29:if(e.prev=29,!l){e.next=32;break}throw p;case 32:return e.finish(29);case 33:return e.finish(26);case 34:a.setState({masterBranchName:m},(function(){return t()}));case 35:case"end":return e.stop()}}),e,null,[[10,22,26,34],[27,,29,33]])})));return function(t){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)}))),a.loadDirectory=Object(i.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(i.a)(s.a.mark((function e(t){var r,i,o,c,m,u,l;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.props.match.params,i=r.username,o=r.repository,c=r.path,m=r.branch,u=a.state.masterBranchName,e.next=4,U.h.directory({username:i},{name:o},m||u,void 0===c?"":c+"/");case 4:null!==(l=e.sent)?a.setState({fileList:Object(n.a)(l)},(function(){return t()})):t();case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)}))),a.loadLastCommit=Object(i.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(i.a)(s.a.mark((function e(t){var n,r,i,o,c,m,u;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.props.match.params,r=n.username,i=n.repository,o=n.branch,c=n.path,m=a.state.masterBranchName,e.next=4,U.h.lastBranchCommit({username:r},{name:i},o||m,c);case 4:null!==(u=e.sent)?a.setState({lastCommit:u},(function(){return t()})):t();case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)}))),a.state={fileList:[],lastCommit:new W.b("","","",0,"",""),loading:!0,masterBranchName:""},a}return Object(l.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=Object(i.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({loading:!0}),e.next=3,this.loadMasterBranchName();case 3:return e.next=5,this.loadLastCommit();case 5:return e.next=7,this.loadDirectory();case 7:this.setState({loading:!1});case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(i.a)(s.a.mark((function e(t,a,n){var r,i,o,c,m,u,l,p,h,f;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.match.params,i=r.username,o=r.repository,c=r.branch,m=r.path,u=this.props.match.params,l=u.username,p=u.repository,h=u.branch,f=u.path,i===l&&o===p){e.next=7;break}return e.next=5,this.componentDidMount();case 5:e.next=19;break;case 7:if(c===h){e.next=14;break}return this.setState({loading:!0}),e.next=11,Promise.all([this.loadDirectory(),this.loadLastCommit()]);case 11:this.setState({loading:!1}),e.next=19;break;case 14:if(m===f){e.next=19;break}return this.setState({loading:!0}),e.next=18,this.loadDirectory();case 18:this.setState({loading:!1});case 19:case"end":return e.stop()}}),e,this)})));return function(t,a,n){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state,t=e.fileList,a=e.lastCommit,n=e.loading,r=e.masterBranchName,s=this.props.match.params.path;return h.a.createElement(A,{fileList:t,masterBranchName:r,lastCommit:a,loading:n,showPreviousFolderItem:void 0!==s})}}]),t}(p.Component),Y=Object(x.f)(q);a.d(t,"default",(function(){return Y}))}}]);
//# sourceMappingURL=31.adb129aa.chunk.js.map