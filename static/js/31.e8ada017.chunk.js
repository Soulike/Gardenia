(this["webpackJsonpsoulike-git"]=this["webpackJsonpsoulike-git"]||[]).push([[31],{1008:function(o,s,t){"use strict";t.d(s,"a",function(){return d});var c=t(0),a=t.n(c),f=t(209);function u(){return a.a.createElement(f.a,{avatar:""})}var d=a.a.memo(u)},1112:function(o,s,t){o.exports={Avatar:"Style_Avatar__2TmQb",alertWrapper:"Style_alertWrapper__3gZd7",body:"Style_body__eN9Pm",avatarWrapper:"Style_avatarWrapper__3wqvg",avatar:"Style_avatar__hT7wZ",fileInput:"Style_fileInput__1gSjB",buttonWrapper:"Style_buttonWrapper__1rFvY"}},1419:function(o,s,t){"use strict";t.r(s),t.d(s,"default",function(){return O});var c=t(0),a=t.n(c),f=t(1112),u=t.n(f),d=t(988),h=t(1008),F=t(962),g=t(947),T=t(170),W=t(101);function D(l){const{avatar:n,loading:e,fileInputRef:i,onAvatarClick:v,onAvatarInputChange:m,fileChanged:y,onUploadButtonClick:p,accept:r}=l;return a.a.createElement("div",{className:u.a.Avatar},a.a.createElement(d.a,null,"\u5934\u50CF"),a.a.createElement("div",{className:u.a.alertWrapper},a.a.createElement(F.a,{message:"\u70B9\u51FB\u56FE\u7247\u9009\u62E9\u65B0\u7684\u5934\u50CF\uFF0C\u56FE\u50CF\u6587\u4EF6\u5927\u5C0F 2M \u4EE5\u5185\u3002\u63A8\u8350\u4E0A\u4F20\u65B9\u5F62\u56FE\u50CF\uFF0C\u5426\u5219\u56FE\u50CF\u4F1A\u88AB\u62C9\u4F38\u3002",banner:!0,type:"info",showIcon:!0})),a.a.createElement("div",{className:u.a.body},a.a.createElement(g.a,{spinning:e},a.a.createElement(T.a,{title:"\u70B9\u51FB\u66F4\u6362\u5934\u50CF"},a.a.createElement("div",{className:u.a.avatarWrapper,onClick:v},n?a.a.createElement("img",{src:n,alt:"avatar",className:u.a.avatar}):a.a.createElement(h.a,null)))),a.a.createElement("input",{type:"file",accept:r,multiple:!1,className:u.a.fileInput,ref:i,onChange:m}),a.a.createElement("div",{className:u.a.buttonWrapper},a.a.createElement(W.a,{type:"primary",block:!0,disabled:e||!y,loading:e,onClick:p},"\u4E0A\u4F20"))))}var M=a.a.memo(D),I=t(27),E=t(339),B=t(1),L=t(96),N,R=typeof N!="undefined"?N:l=>{throw new Error('Dynamic require of "'+l+'" is not supported')},C=(l,n,e)=>new Promise((i,v)=>{var m=r=>{try{p(e.next(r))}catch(S){v(S)}},y=r=>{try{p(e.throw(r))}catch(S){v(S)}},p=r=>r.done?i(r.value):Promise.resolve(r.value).then(m,y);p((e=e.apply(l,n)).next())});const A=class extends c.PureComponent{constructor(l){super(l);this.fileInputRef=a.a.createRef(),this.setStatePromise=Object(L.promisify)(this.setState),this.loadAvatar=()=>C(this,null,function*(){const n=yield I.g.get();if(n!==null){const{avatar:e}=n;yield this.setStatePromise({avatar:e})}else{const{history:e}=this.props;return e.replace(B.d[B.b.NOT_FOUND])}}),this.onAvatarClick=()=>{const n=this.fileInputRef.current;n!==null&&n.click()},this.onAvatarInputChange=n=>{const{files:e}=n.target;if(e!==null)if(e.length===1){const i=e[0],{type:v,size:m}=i;m<=2*1024*1024&&A.ALLOWED_MIME_TYPE.includes(v)?this.setState({file:i,avatar:URL.createObjectURL(i)}):E.a.error({message:"\u53EA\u80FD\u4E0A\u4F20 2M \u4EE5\u5185\u7684 JPG \u6216 PNG \u56FE\u50CF\u6587\u4EF6\u4F5C\u4E3A\u5934\u50CF"})}else E.a.error({message:"\u53EA\u80FD\u4E0A\u4F20\u4E00\u4E2A\u6587\u4EF6\u4F5C\u4E3A\u5934\u50CF"})},this.onUploadButtonClick=()=>C(this,null,function*(){const{file:n}=this.state;n===null?E.a.warn({message:"\u8BF7\u5148\u9009\u62E9\u5934\u50CF"}):(this.setState({loading:!0}),(yield I.g.uploadAvatar(n))!==null&&(E.a.success({message:"\u4E0A\u4F20\u5934\u50CF\u6210\u529F"}),setTimeout(()=>{window.location.reload()},1e3)),this.setState({loading:!1}))}),this.state={avatar:"",loading:!1,file:null}}componentDidMount(){return C(this,null,function*(){yield this.setStatePromise({loading:!0}),yield this.loadAvatar(),yield this.setStatePromise({loading:!1})})}render(){const{avatar:l,loading:n,file:e}=this.state;return a.a.createElement(M,{onAvatarInputChange:this.onAvatarInputChange,onAvatarClick:this.onAvatarClick,fileInputRef:this.fileInputRef,avatar:l,loading:n,fileChanged:e!==null,onUploadButtonClick:this.onUploadButtonClick,accept:A.ALLOWED_MIME_TYPE.join(",")})}};let P=A;P.ALLOWED_MIME_TYPE=["image/jpeg","image/png"];var O=P},987:function(o,s,t){o.exports={SettingsTitle:"Style_SettingsTitle__rgD4i"}},988:function(o,s,t){"use strict";t.d(s,"a",function(){return h});var c=t(0),a=t.n(c),f=t(987),u=t.n(f);function d(F){const{children:g}=F;return a.a.createElement("h2",{className:u.a.SettingsTitle},g)}var h=a.a.memo(d)}}]);

//# sourceMappingURL=31.e8ada017.chunk.js.map