"use strict";(self.webpackChunksoulike_git=self.webpackChunksoulike_git||[]).push([[8222],{18222:function(M,P,o){o.r(P),o.d(P,{default:function(){return X}});var e=o(89526),d={Issues:"Style_Issues__-Jtqz",list:"Style_list__7QJFO",header:"Style_header__jXgT+",statusFilter:"Style_statusFilter__nl6Nm",tag:"Style_tag__q5D16",pageButtonWrapper:"Style_pageButtonWrapper__QQXZq"},G=o(5892),g=o(65293),h=o(30592),N=o(75113),B=o(565),f=o(65092),I=o(18440),l=o(76320),R=o(30421),C=o(48877),A=o(27642),W=o(58047),Z={IssueList:"Style_IssueList__+EsLp",emptyWrapper:"Style_emptyWrapper__bXsxz"},y={Issue:"Style_Issue__i5bkP",titleWrapper:"Style_titleWrapper__VrF3O",iconWrapper:"Style_iconWrapper__06-ol",info:"Style_info__YC+TR"},L=o(14006),k=o(57428);function D(r){const{issue:{status:t,no:s,title:n,repositoryUsername:a,repositoryName:u,username:i,creationTime:c}}=r;return e.createElement("div",{className:y.Issue},e.createElement("div",{className:y.titleWrapper},e.createElement("div",{className:y.iconWrapper,style:{color:T(t)}},F(t)),e.createElement(k.Z,{to:I.Function.generateRepositoryIssueRoute({username:a,repositoryName:u,no:s.toString()})},e.createElement("div",{className:y.title},n))),e.createElement("div",{className:y.info},"#",s," \u7531 ",e.createElement("b",null,i)," \u4E8E ",L.Ej.parseTimestampToDifference(c)," \u521B\u5EFA"))}function F(r){switch(r){case l.dG.CLOSED:return e.createElement(A.Z,null);case l.dG.OPEN:return e.createElement(C.Z,null)}}function T(r){switch(r){case l.dG.CLOSED:return"red";case l.dG.OPEN:return"green"}}var x=e.memo(D),b=o(37109);function z(r){const{issues:t}=r;return e.createElement("div",{className:Z.IssueList},t.length>0?t.map(s=>e.createElement(x,{issue:s,key:s.id})):e.createElement("div",{className:Z.emptyWrapper},e.createElement(b.Z,{description:"\u6CA1\u6709\u7B26\u5408\u6761\u4EF6\u7684 Issue"})))}var U=e.memo(z);function V(r){const{match:{params:{username:t,repositoryName:s}},loading:n,openAmount:a,closedAmount:u,currentStatus:i,onStatusButtonClick:c,currentPageNumber:E,onPrevButtonClick:S,onNextButtonClick:$,noNextPage:j,issues:J}=r;return e.createElement("div",{className:d.Issues},e.createElement(G.Z,{spinning:n},e.createElement("div",{className:d.list},e.createElement("div",{className:d.header},e.createElement("div",{className:d.statusFilter},e.createElement(g.Z,{size:-1},e.createElement(h.Z,{size:"small",type:"link",style:{color:"unset",fontWeight:i===void 0?"bolder":"inherit"},onClick:c(void 0)},e.createElement(R.Z,null)," \u6240\u6709",e.createElement(N.Z,{className:d.tag},a+u)),e.createElement(h.Z,{size:"small",type:"link",style:{color:"green",fontWeight:i===l.dG.OPEN?"bolder":"inherit"},onClick:c(l.dG.OPEN)},e.createElement(C.Z,null)," \u5F00\u542F\u7684",e.createElement(N.Z,{className:d.tag},a)),e.createElement(h.Z,{size:"small",type:"link",style:{color:"red",fontWeight:i===l.dG.CLOSED?"bolder":"inherit"},onClick:c(l.dG.CLOSED)},e.createElement(A.Z,null)," \u5DF2\u5173\u95ED",e.createElement(N.Z,{className:d.tag},u)))),e.createElement(B.rU,{to:I.Function.generateRepositoryCreateIssueRoute({username:t,repositoryName:s})},e.createElement(h.Z,{type:"primary"},e.createElement(W.Z,null),"\u521B\u5EFA Issue"))),e.createElement("div",{className:d.issueListWrapper},e.createElement(U,{issues:J})),e.createElement("div",{className:d.pageButtonWrapper},e.createElement(g.Z,{size:-1},e.createElement(h.Z,{disabled:E===0,onClick:S},"\u4E0A\u4E00\u9875"),e.createElement(h.Z,{onClick:$,disabled:j},"\u4E0B\u4E00\u9875"))))))}var Q=e.memo((0,f.EN)(V)),v=o(62371),p=(r,t,s)=>new Promise((n,a)=>{var u=E=>{try{c(s.next(E))}catch(S){a(S)}},i=E=>{try{c(s.throw(E))}catch(S){a(S)}},c=E=>E.done?n(E.value):Promise.resolve(E.value).then(u,i);c((s=s.apply(r,t)).next())});const m=class extends e.PureComponent{constructor(r){super(r),this.loadOpenAmount=()=>p(this,null,function*(){const{match:{params:{username:t,repositoryName:s}}}=this.props,n=yield v.$9.getAmountByRepository({username:t,name:s},l.dG.OPEN);if(n!==null){const{amount:a}=n;this.setState({openAmount:a})}}),this.loadClosedAmount=()=>p(this,null,function*(){const{match:{params:{username:t,repositoryName:s}}}=this.props,n=yield v.$9.getAmountByRepository({username:t,name:s},l.dG.CLOSED);if(n!==null){const{amount:a}=n;this.setState({closedAmount:a})}}),this.onStatusButtonClick=t=>()=>p(this,null,function*(){switch(this.setState({currentStatus:t,loading:!0,currentPageNumber:0}),t){case l.dG.OPEN:{yield this.loadOpenAmount();break}case l.dG.CLOSED:{yield this.loadClosedAmount();break}default:{yield Promise.all([this.loadOpenAmount(),this.loadClosedAmount()]);break}}yield this.loadIssues(t,0,m.SIZE_PER_PAGE),this.setState({loading:!1})}),this.loadIssues=(t,s,n)=>p(this,null,function*(){const{match:{params:{username:a,repositoryName:u}}}=this.props,i=yield v.$9.getByRepository({username:a,name:u},t,s,n);if(i!==null){const{issues:c}=i;this.setState({issues:c})}}),this.onPrevButtonClick=()=>p(this,null,function*(){const{currentPageNumber:t,currentStatus:s}=this.state;t>0&&(this.setState({loading:!0}),yield this.loadIssues(s,(t-1)*m.SIZE_PER_PAGE,m.SIZE_PER_PAGE),this.setState({currentPageNumber:t-1,loading:!1}),window.scrollTo({top:0,behavior:"smooth"}))}),this.onNextButtonClick=()=>p(this,null,function*(){const{currentPageNumber:t,currentStatus:s}=this.state;this.setState({loading:!0}),yield this.loadIssues(s,(t+1)*m.SIZE_PER_PAGE,m.SIZE_PER_PAGE),this.setState({currentPageNumber:t+1,loading:!1}),window.scrollTo({top:0,behavior:"smooth"})}),this.setNoNextPage=()=>{const{currentStatus:t,currentPageNumber:s,openAmount:n,closedAmount:a}=this.state;switch(t){case l.dG.CLOSED:return(s+1)*m.SIZE_PER_PAGE>=a;case l.dG.OPEN:return(s+1)*m.SIZE_PER_PAGE>=n;default:return(s+1)*m.SIZE_PER_PAGE>=n+a}},this.state={loading:!1,openAmount:0,closedAmount:0,currentStatus:l.dG.OPEN,issues:[],currentPageNumber:0}}componentDidMount(){return p(this,null,function*(){const{currentStatus:r}=this.state;this.setState({loading:!0}),yield Promise.all([this.loadOpenAmount(),this.loadClosedAmount(),this.loadIssues(r,0,m.SIZE_PER_PAGE)]),this.setState({loading:!1})})}componentDidUpdate(r,t,s){return p(this,null,function*(){const{match:{params:{username:n,repositoryName:a}}}=this.props,{match:{params:{username:u,repositoryName:i}}}=r;(n!==u||a!==i)&&(yield this.componentDidMount())})}render(){const{loading:r,closedAmount:t,currentStatus:s,openAmount:n,issues:a,currentPageNumber:u}=this.state;return e.createElement(Q,{loading:r,closedAmount:t,currentStatus:s,onStatusButtonClick:this.onStatusButtonClick,openAmount:n,issues:a,currentPageNumber:u,noNextPage:this.setNoNextPage(),onNextButtonClick:this.onNextButtonClick,onPrevButtonClick:this.onPrevButtonClick})}};let O=m;O.SIZE_PER_PAGE=20;var X=(0,f.EN)(O)}}]);

//# sourceMappingURL=8222.c232d07d.chunk.js.map