(this["webpackJsonpsoulike-git"]=this["webpackJsonpsoulike-git"]||[]).push([[43],{1119:function(e,t,n){e.exports={Conflict:"Style_Conflict__3Vamq",conflictsWrapper:"Style_conflictsWrapper__1FN4k",conflictWrapper:"Style_conflictWrapper__2qm8Q",buttonWrapper:"Style_buttonWrapper__1QhqS"}},1120:function(e,t,n){e.exports={ConflictEditor:"Style_ConflictEditor__p1WcR",header:"Style_header__3Oayj",filePath:"Style_filePath__1iCwK",checkboxWrapper:"Style_checkboxWrapper__VLdFN",text:"Style_text__3S4yB"}},1391:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return be}));var a=n(2),r=n.n(a),c=n(4),o=n(14),s=n(15),i=n(39),l=n(38),u=n(1),d=n(0),p=n.n(d),f=n(1119),h=n.n(f),b=n(902),v=n(915),m=n(904),y=n(118),j=n(268),x=n(66),O=n(27),g=n(1120),C=n.n(g),k=n(6),N=n.n(k),w=n(5),R=n.n(w),P=n(8),S=n.n(P),_=n(23),E=n(13),q=n(48),F=n(7),D=n(32),B=n(36),K=n(40),W=n(51),I=function(e){Object(K.a)(n,e);var t=Object(W.a)(n);function n(e){var a;Object(D.a)(this,n),(a=t.call(this,e)).handleChange=function(e){var t=a.props,n=t.disabled,r=t.onChange;n||("checked"in a.props||a.setState({checked:e.target.checked}),r&&r({target:Object(F.a)(Object(F.a)({},a.props),{},{checked:e.target.checked}),stopPropagation:function(){e.stopPropagation()},preventDefault:function(){e.preventDefault()},nativeEvent:e.nativeEvent}))},a.saveInput=function(e){a.input=e};var r="checked"in e?e.checked:e.defaultChecked;return a.state={checked:r},a}return Object(B.a)(n,[{key:"focus",value:function(){this.input.focus()}},{key:"blur",value:function(){this.input.blur()}},{key:"render",value:function(){var e,t=this.props,n=t.prefixCls,a=t.className,r=t.style,c=t.name,o=t.id,s=t.type,i=t.disabled,l=t.readOnly,u=t.tabIndex,d=t.onClick,f=t.onFocus,h=t.onBlur,b=t.onKeyDown,v=t.onKeyPress,m=t.onKeyUp,y=t.autoFocus,j=t.value,x=t.required,O=Object(q.a)(t,["prefixCls","className","style","name","id","type","disabled","readOnly","tabIndex","onClick","onFocus","onBlur","onKeyDown","onKeyPress","onKeyUp","autoFocus","value","required"]),g=Object.keys(O).reduce((function(e,t){return"aria-"!==t.substr(0,5)&&"data-"!==t.substr(0,5)&&"role"!==t||(e[t]=O[t]),e}),{}),C=this.state.checked,k=S()(n,a,(e={},Object(E.a)(e,"".concat(n,"-checked"),C),Object(E.a)(e,"".concat(n,"-disabled"),i),e));return p.a.createElement("span",{className:k,style:r},p.a.createElement("input",Object(_.a)({name:c,id:o,type:s,required:x,readOnly:l,disabled:i,tabIndex:u,className:"".concat(n,"-input"),checked:!!C,onClick:d,onFocus:f,onBlur:h,onKeyUp:m,onKeyDown:b,onKeyPress:v,onChange:this.handleChange,autoFocus:y,ref:this.saveInput,value:j},g)),p.a.createElement("span",{className:"".concat(n,"-inner")}))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return"checked"in e?Object(F.a)(Object(F.a)({},t),{},{checked:e.checked}):null}}]),n}(d.Component);I.defaultProps={prefixCls:"rc-checkbox",className:"",style:{},type:"checkbox",defaultChecked:!1,onFocus:function(){},onBlur:function(){},onChange:function(){},onKeyDown:function(){},onKeyPress:function(){},onKeyUp:function(){}};var U=I,M=n(127),V=n.n(M),L=n(18),T=n.n(L),z=n(49),H=n(110),$=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n},J=d.createContext(null),Q=function(e){var t=e.defaultValue,n=e.children,a=e.options,r=void 0===a?[]:a,c=e.prefixCls,o=e.className,s=e.style,i=e.onChange,l=$(e,["defaultValue","children","options","prefixCls","className","style","onChange"]),u=d.useContext(H.b),p=u.getPrefixCls,f=u.direction,h=d.useState(l.value||t||[]),b=T()(h,2),v=b[0],m=b[1],y=d.useState([]),j=T()(y,2),x=j[0],O=j[1];d.useEffect((function(){"value"in l&&m(l.value||[])}),[l.value]);var g=function(){return r.map((function(e){return"string"===typeof e?{label:e,value:e}:e}))},C=p("checkbox",c),k="".concat(C,"-group"),w=Object(z.a)(l,["value","disabled"]);r&&r.length>0&&(n=g().map((function(e){return d.createElement(ee,{prefixCls:C,key:e.value.toString(),disabled:"disabled"in e?e.disabled:l.disabled,value:e.value,checked:-1!==v.indexOf(e.value),onChange:e.onChange,className:"".concat(k,"-item"),style:e.style},e.label)})));var P={toggleOption:function(e){var t=v.indexOf(e.value),n=V()(v);if(-1===t?n.push(e.value):n.splice(t,1),"value"in l||m(n),i){var a=g();i(n.filter((function(e){return-1!==x.indexOf(e)})).sort((function(e,t){return a.findIndex((function(t){return t.value===e}))-a.findIndex((function(e){return e.value===t}))})))}},value:v,disabled:l.disabled,name:l.name,registerValue:function(e){O((function(t){return[].concat(V()(t),[e])}))},cancelValue:function(e){O((function(t){return t.filter((function(t){return t!==e}))}))}},_=S()(k,N()({},"".concat(k,"-rtl"),"rtl"===f),o);return d.createElement("div",R()({className:_,style:s},w),d.createElement(J.Provider,{value:P},n))},A=d.memo(Q),G=n(77),X=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n},Y=function(e,t){var n,a=e.prefixCls,r=e.className,c=e.children,o=e.indeterminate,s=void 0!==o&&o,i=e.style,l=e.onMouseEnter,u=e.onMouseLeave,p=X(e,["prefixCls","className","children","indeterminate","style","onMouseEnter","onMouseLeave"]),f=d.useContext(H.b),h=f.getPrefixCls,b=f.direction,v=d.useContext(J),m=d.useRef(p.value);d.useEffect((function(){null===v||void 0===v||v.registerValue(p.value),Object(G.a)("checked"in p||!!v||!("value"in p),"Checkbox","`value` is not a valid prop, do you mean `checked`?")}),[]),d.useEffect((function(){return p.value!==m.current&&(null===v||void 0===v||v.cancelValue(m.current),null===v||void 0===v||v.registerValue(p.value)),function(){return null===v||void 0===v?void 0:v.cancelValue(p.value)}}),[p.value]);var y=h("checkbox",a),j=R()({},p);v&&(j.onChange=function(){p.onChange&&p.onChange.apply(p,arguments),v.toggleOption&&v.toggleOption({label:c,value:p.value})},j.name=v.name,j.checked=-1!==v.value.indexOf(p.value),j.disabled=p.disabled||v.disabled);var x=S()((n={},N()(n,"".concat(y,"-wrapper"),!0),N()(n,"".concat(y,"-rtl"),"rtl"===b),N()(n,"".concat(y,"-wrapper-checked"),j.checked),N()(n,"".concat(y,"-wrapper-disabled"),j.disabled),n),r),O=S()(N()({},"".concat(y,"-indeterminate"),s));return d.createElement("label",{className:x,style:i,onMouseEnter:l,onMouseLeave:u},d.createElement(U,R()({},j,{prefixCls:y,className:O,ref:t})),void 0!==c&&d.createElement("span",null,c))},Z=d.forwardRef(Y);Z.displayName="Checkbox";var ee=Z,te=ee;te.Group=A,te.__ANT_CHECKBOX=!0;var ne=te,ae=p.a.lazy((function(){return Promise.all([n.e(10),n.e(47)]).then(n.bind(null,1428))}));function re(e){var t=e.conflict.filePath,n=e.code,a=e.onCodeChange,r=e.onResolvedCheckboxChange,c=e.resolved;return Object(u.jsxs)("div",{className:C.a.ConflictEditor,children:[Object(u.jsxs)("div",{className:C.a.header,children:[Object(u.jsx)("code",{className:C.a.filePath,children:t}),Object(u.jsxs)("label",{className:C.a.checkboxWrapper,children:[Object(u.jsx)(ne,{onChange:r,checked:c}),Object(u.jsx)("div",{className:C.a.text,children:"\u5df2\u89e3\u51b3"})]})]}),Object(u.jsx)("div",{className:C.a.codeWrapper,style:c?{position:"fixed",top:"99999999px"}:{},children:Object(u.jsx)(ae,{onBeforeChange:a,value:n,options:{lineNumbers:!0,indentUnit:0}})})]})}var ce=p.a.memo(re),oe=n(336),se=function(e){Object(i.a)(n,e);var t=Object(l.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).onCodeChange=function(e,t,n){a.setState({code:n})},a.onResolvedCheckboxChange=function(e){var t=a.state.code,n=a.props.conflict.filePath;-1!==t.search(/^<<<<<<< .+$/m)||-1!==t.search(/^=======$/m)||-1!==t.search(/^>>>>>>> .+$/m)?oe.a.warning({message:Object(u.jsxs)("div",{children:[Object(u.jsx)("code",{children:n})," \u4e2d\u4ecd\u5b58\u5728\u51b2\u7a81"]}),description:"\u8bf7\u89e3\u51b3\u51b2\u7a81\uff0c\u5e76\u5220\u9664\u6240\u6709\u7684\u51b2\u7a81\u6807\u8bb0"}):a.setState({resolved:e.target.checked})},a.state={code:"",resolved:!1},a}return Object(s.a)(n,[{key:"componentDidMount",value:function(){var e=this.props.conflict.content;this.setState({code:e})}},{key:"componentDidUpdate",value:function(){var e=Object(c.a)(r.a.mark((function e(t,n,a){var c,o,s,i,l,u,d,p,f;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=this.props.conflict,o=t.conflict,c===o){e.next=5;break}return e.next=5,this.componentDidMount();case 5:if("function"!==typeof(s=this.props.onChange)){e.next=13;break}if(i=this.state,l=i.code,u=i.resolved,d=c.filePath,p=n.code,f=n.resolved,l===p&&u===f){e.next=13;break}return e.next=13,s(d,u,l);case 13:case"end":return e.stop()}}),e,this)})));return function(t,n,a){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state,t=e.code,n=e.resolved,a=this.props.conflict;return Object(u.jsx)(ce,{conflict:a,code:t,onCodeChange:this.onCodeChange,resolved:n,onResolvedCheckboxChange:this.onResolvedCheckboxChange})}}]),n}(d.PureComponent);function ie(e){var t=e.loading,n=e.pullRequest,a=n.sourceRepositoryUsername,r=n.sourceRepositoryName,c=n.sourceRepositoryBranchName,o=n.targetRepositoryUsername,s=n.targetRepositoryName,i=n.targetRepositoryBranchName,l=e.conflicts,d=e.onConflictChange,p=e.onSubmitButtonClick;return Object(u.jsx)("div",{className:h.a.Conflict,children:Object(u.jsxs)(b.a,{spinning:t,children:[Object(u.jsxs)("div",{className:h.a.alert,children:[Object(u.jsx)(v.a,{type:"info",banner:!0,showIcon:!0,message:Object(u.jsxs)("div",{children:["\u6b63\u5728\u89e3\u51b3 ",Object(u.jsx)(j.a,{to:x.Function.generateRepositoryCodeRoute({username:a,repositoryName:r,objectType:O.b.TREE,commitHash:c}),children:Object(u.jsxs)("code",{children:[a,"/",r,":",c]})})," \u5230 ",Object(u.jsx)(j.a,{to:x.Function.generateRepositoryCodeRoute({username:o,repositoryName:s,objectType:O.b.TREE,commitHash:i}),children:Object(u.jsxs)("code",{children:[o,"/",s,":",i]})})," \u7684\u5408\u5e76\u51b2\u7a81"]})}),Object(u.jsx)(v.a,{type:"warning",banner:!0,showIcon:!0,message:Object(u.jsxs)("div",{children:["\u6240\u505a\u7684\u4fee\u6539\u5c06\u88ab\u63d0\u4ea4\u5230 ",Object(u.jsxs)("code",{children:[a,"/",r,":",c]})]})})]}),Object(u.jsx)("div",{className:h.a.conflictsWrapper,children:l.map((function(e){return Object(u.jsx)("div",{className:h.a.conflictWrapper,children:Object(u.jsx)(se,{conflict:e,onChange:d})},e.filePath)}))}),Object(u.jsx)("div",{className:h.a.buttonWrapper,children:Object(u.jsx)(m.a,{onConfirm:p,disabled:t,title:Object(u.jsxs)("div",{children:["\u786e\u8ba4\u51b2\u7a81\u89e3\u51b3\uff1f",Object(u.jsx)("br",{}),Object(u.jsxs)("strong",{children:["\u4ee5\u4e0a\u4fee\u6539\u90fd\u5c06\u88ab\u63d0\u4ea4\u5230 ",Object(u.jsxs)("code",{children:[a,"/",r,":",c]})]})]}),children:Object(u.jsx)(y.a,{type:"primary",size:"large",disabled:t,loading:t,children:"\u63d0\u4ea4"})})})]})})}var le=p.a.memo(ie),ue=n(62),de=n(148),pe=n(30),fe=n(3),he=function(e){Object(i.a)(n,e);var t=Object(l.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).checkURL=function(){var e=a.props,t=e.match.params.no,n=e.history,r=Number.parseInt(t);if(Number.isNaN(r))return n.replace(fe.d[fe.b.NOT_FOUND])},a.loadPullRequest=Object(c.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(c.a)(r.a.mark((function e(t){var n,c,o,s,i,l,u,d;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.props,c=n.match.params,o=c.username,s=c.repositoryName,i=c.no,l=n.history,u=Number.parseInt(i),e.next=4,pe.h.get({username:o,name:s},{no:u});case 4:if(null===(d=e.sent)){e.next=14;break}if(d.status===O.c.OPEN){e.next=11;break}return oe.a.warn({message:"Pull Request #".concat(u," \u5df2\u5173\u95ed\u6216\u5408\u5e76")}),t(),e.abrupt("return",l.replace(x.Function.generateRepositoryPullRequestRoute({username:o,repositoryName:s,no:i})));case 11:a.setState({pullRequest:d},(function(){return t()})),e.next=16;break;case 14:return t(),e.abrupt("return",l.replace(fe.d[fe.b.NOT_FOUND]));case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)}))),a.loadConflicts=Object(c.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(c.a)(r.a.mark((function e(t){var n,c,o,s,i,l,u,d,p,f;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.state.pullRequest,c=n.id,e.next=4,pe.h.getConflicts({id:c});case 4:if(null===(o=e.sent)){e.next=18;break}if(s=o.conflicts,i=a.props,l=i.match.params,u=l.username,d=l.repositoryName,p=l.no,f=i.history,0!==s.length){e.next=14;break}return oe.a.warn({message:"".concat(u,"/").concat(d," #").concat(p," \u6ca1\u6709\u5408\u5e76\u51b2\u7a81"),description:"\u60a8\u53ef\u76f4\u63a5\u6267\u884c\u5408\u5e76\u64cd\u4f5c"}),t(),e.abrupt("return",f.replace(x.Function.generateRepositoryPullRequestRoute({username:u,repositoryName:d,no:p})));case 14:s.forEach((function(e){if(e.isBinary)return oe.a.warn({message:"\u5b58\u5728\u4e8c\u8fdb\u5236\u6587\u4ef6\u51b2\u7a81",description:"\u8bf7\u4f7f\u7528\u547d\u4ee4\u884c\u89e3\u51b3\u51b2\u7a81"}),t(),f.replace(x.Function.generateRepositoryPullRequestRoute({username:u,repositoryName:d,no:p}))}));case 15:a.setState({conflicts:s},(function(){return t()})),e.next=19;break;case 18:t();case 19:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)}))),a.onConflictChange=function(e,t,n){for(var r=a.state,c=r.conflicts,o=r.resolvedFilePath,s=0;s<c.length;s++){var i=c[s],l=i.filePath,u=i.isBinary,d=i.content;l===e&&n!==d&&(c[s]=new de.c(e,u,n)),t?o.add(e):o.delete(e)}},a.onSubmitButtonClick=Object(c.a)(r.a.mark((function e(){var t,n,c,o,s,i,l,u,d,p;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.state,n=t.pullRequest.id,c=t.resolvedFilePath,o=t.conflicts,o.map((function(e){return e.filePath})).length===c.size){e.next=6;break}oe.a.error({message:"\u8bf7\u89e3\u51b3\u6240\u6709\u51b2\u7a81\u540e\u518d\u63d0\u4ea4"}),e.next=15;break;case 6:return a.setState({loading:!0}),e.next=9,pe.h.resolveConflicts({id:n},o);case 9:if(null===e.sent){e.next=14;break}return oe.a.success({message:"\u89e3\u51b3\u51b2\u7a81\u6210\u529f"}),s=a.props,i=s.history,l=s.match.params,u=l.username,d=l.repositoryName,p=l.no,e.abrupt("return",i.push(x.Function.generateRepositoryPullRequestRoute({username:u,repositoryName:d,no:p})));case 14:a.setState({loading:!1});case 15:case"end":return e.stop()}}),e)}))),a.state={pullRequest:new de.h(0,0,"","","","","","","","",0,0,"","",O.c.CLOSED),conflicts:[],loading:!1,resolvedFilePath:new Set},a}return Object(s.a)(n,[{key:"componentDidMount",value:function(){var e=Object(c.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.checkURL(),this.setState({loading:!0}),e.next=4,this.loadPullRequest();case 4:this.setState({loading:!1});case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(c.a)(r.a.mark((function e(t,n,a){var c,o,s;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=this.props.location.pathname,o=this.props.location.pathname,c===o){e.next=5;break}return e.next=5,this.componentDidMount();case 5:if(s=this.state.pullRequest.id,n.pullRequest.id===s){e.next=12;break}return this.setState({loading:!0}),e.next=11,this.loadConflicts();case 11:this.setState({loading:!1});case 12:case"end":return e.stop()}}),e,this)})));return function(t,n,a){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state,t=e.loading,n=e.pullRequest,a=e.conflicts;return Object(u.jsx)(le,{loading:t,pullRequest:n,conflicts:a,onConflictChange:this.onConflictChange,onSubmitButtonClick:this.onSubmitButtonClick})}}]),n}(d.PureComponent),be=Object(ue.j)(he)}}]);
//# sourceMappingURL=43.56a9c1a3.chunk.js.map