(this["webpackJsonpsoulike-git"]=this["webpackJsonpsoulike-git"]||[]).push([[31],{1024:function(e,t,a){e.exports={FileReader:"Style_FileReader__1hW4w",commitInfoBar:"Style_commitInfoBar__2xvVY",contentWrapper:"Style_contentWrapper__3jWFR",fileInfoBar:"Style_fileInfoBar__2iqjb",fileName:"Style_fileName__3GaRF",content:"Style_content__3_Ute"}},1242:function(e,t,a){"use strict";a.r(t);var n=a(4),r=a.n(n),s=a(36),i=a(47),o=a(89),c=a(88),m=a(90),l=a(0),u=a.n(l),f=(a(899),a(902)),p=(a(919),a(930)),d=(a(412),a(132)),h=a(1024),v=a.n(h),w=(a(1025),a(948));var x=u.a.memo((function(e){var t=e.isBinary,a=e.isOversize,n=e.exists,r=e.fileName,s=e.html,i=e.lastCommit,o=e.loading,c=e.onRawFileButtonClick;return u.a.createElement("div",{className:v.a.FileReader},u.a.createElement(f.a,{spinning:o},u.a.createElement("div",{className:v.a.commitInfoBar},u.a.createElement(w.a,{lastCommit:i})),u.a.createElement("div",{className:v.a.contentWrapper},u.a.createElement("div",{className:v.a.fileInfoBar},u.a.createElement("div",{className:v.a.fileName},r),u.a.createElement("div",{className:v.a.buttonWrapper},u.a.createElement(d.a,{onClick:c},"\u4e0b\u8f7d"))),n?t?u.a.createElement(p.a,{type:"info",showIcon:!0,message:"\u4e8c\u8fdb\u5236\u6587\u4ef6\u65e0\u6cd5\u663e\u793a",description:"\u4f60\u53ef\u4ee5\u76f4\u63a5\u67e5\u770b\u539f\u6587\u4ef6"}):a?u.a.createElement(p.a,{type:"info",showIcon:!0,message:"\u6587\u4ef6\u592a\u5927",description:"\u4f60\u53ef\u4ee5\u76f4\u63a5\u67e5\u770b\u539f\u6587\u4ef6"}):u.a.createElement("div",{className:v.a.content,dangerouslySetInnerHTML:{__html:s}}):u.a.createElement(p.a,{type:"error",showIcon:!0,message:"\u6587\u4ef6\u4e0d\u5b58\u5728"}))))})),y=a(101),_=a(277),g=a(206),b=a(1026),C=a.n(b),k=a(953),E=a.n(k),B=a(946),N=a(947),S=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(c.a)(t).call(this,e))).loadLastCommit=function(){var e,t,n,s,i,o;return r.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return e=a.props.match.params,t=e.username,n=e.repository,s=e.path,i=e.branch,c.next=3,r.a.awrap(g.f.lastCommit({username:t},{name:n},i,s));case 3:if(null===(o=c.sent)){c.next=7;break}return c.next=7,r.a.awrap(a.onLastCommitLoaded(o));case 7:case"end":return c.stop()}}))},a.onLastCommitLoaded=function(e){var t;return r.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return a.setState({lastCommit:e}),t=e.commitHash,n.next=4,r.a.awrap(a.loadFileInfo(t));case 4:case"end":return n.stop()}}))},a.loadFileInfo=function(e){var t,n,s,i,o;return r.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return t=a.props.match.params,n=t.username,s=t.repository,i=t.path,c.next=3,r.a.awrap(g.f.fileInfo({username:n},{name:s},i,e));case 3:if(null===(o=c.sent)){c.next=7;break}return c.next=7,r.a.awrap(a.onFileInfoLoaded(o,e));case 7:case"end":return c.stop()}}))},a.onFileInfoLoaded=function(e,t){var n,s,i;return r.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:if(n=e.exists,s=e.size,i=e.isBinary,a.setState({exists:n}),!n){o.next=11;break}if(a.setState({isBinary:i}),i){o.next=11;break}if(!(s>1048576)){o.next=9;break}a.setState({isOversize:!0}),o.next=11;break;case 9:return o.next=11,r.a.awrap(a.loadRawContent(t));case 11:case"end":return o.stop()}}))},a.loadRawContent=function(e){var t,n,s,i,o;return r.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return t=a.props.match.params,n=t.username,s=t.repository,i=t.path,c.next=3,r.a.awrap(g.f.rawFile({username:n},{name:s},i,e));case 3:if(null===(o=c.sent)){c.next=11;break}return c.t0=a,c.next=8,r.a.awrap(N.a.transformBlobToString(o));case 8:c.t1=c.sent,c.t2={rawContent:c.t1},c.t0.setState.call(c.t0,c.t2);case 11:case"end":return c.stop()}}))},a.onRawFileButtonClick=function(){var e,t,n,s,i,o;return r.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return e=a.props.match.params,t=e.username,n=e.repository,s=e.path,i=a.state.lastCommit.commitHash,c.next=4,r.a.awrap(g.f.rawFile({username:t},{name:n},s,i));case 4:null!==(o=c.sent)&&a.startDownload(o);case 6:case"end":return c.stop()}}))},a.startDownload=function(e){var t=a.props.match.params.path,n=URL.createObjectURL(e);N.a.startDownload(n,Object(k.basename)(t)),URL.revokeObjectURL(n)},a.getFileNameFromPath=function(e){var t=e.split("/");return t[t.length-1]},a.getHighlightedHtml=function(){var e=a.state,t=e.isBinary,n=e.rawContent;if(!t){var r=document.createElement("pre"),s=document.createElement("div");return s.append(r),r.innerText=n,n.length<=51200?(C.a.highlightBlock(r),s.innerHTML):s.innerHTML}return n},a.isMarkdown=function(e){var t=E.a.extname(e);return".md"===t||".markdown"===t},a.state={exists:!0,isBinary:!1,isOversize:!1,lastCommit:new _.b("","","","",""),loading:!0,rawContent:""},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){return r.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({loading:!0}),e.next=3,r.a.awrap(this.loadLastCommit());case 3:this.setState({loading:!1});case 4:case"end":return e.stop()}}),null,this)}},{key:"componentDidUpdate",value:function(e,t,a){var n,s;return r.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=this.props.location.pathname,s=e.location.pathname,n===s){t.next=5;break}return t.next=5,r.a.awrap(this.componentDidMount());case 5:case"end":return t.stop()}}),null,this)}},{key:"render",value:function(){var e=this.props.match.params.path,t=this.state,a=t.isBinary,n=t.exists,r=t.isOversize,s=t.rawContent,i=t.lastCommit,o=t.loading,c=this.getFileNameFromPath(e),m="";return!n||r||a||(m=this.isMarkdown(c)?B.a.makeHtml(s):this.getHighlightedHtml()),u.a.createElement(x,{html:m,exists:n,isBinary:a,isOversize:r,lastCommit:i,fileName:c,loading:o,onRawFileButtonClick:this.onRawFileButtonClick})}}]),t}(l.PureComponent),F=Object(y.f)(S);a.d(t,"default",(function(){return F}))},942:function(e,t,a){e.exports={CommitInfoBar:"Style_CommitInfoBar__1-ElH",left:"Style_left__1syWH",right:"Style_right__3RBYJ",avatar:"Style_avatar__290nj",name:"Style_name__3xcxA"}},946:function(e,t,a){"use strict";var n=a(954),r=new(a.n(n).a.Converter)({tables:!0,strikethrough:!0,tasklists:!0,emoji:!0});a.d(t,"a",(function(){return r}))},947:function(e,t,a){"use strict";var n={};a.r(n),a.d(n,"transformBlobToString",(function(){return i})),a.d(n,"startDownload",(function(){return o}));var r=a(4),s=a.n(r);function i(e){return s.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,a){var n=new FileReader;n.readAsText(e),n.onloadend=function(){t(n.result)},n.onerror=function(e){a(e)}})));case 1:case"end":return t.stop()}}))}function o(e,t){var a=document.createElement("a");a.href=e,a.download=t,a.click()}a.d(t,"a",(function(){return n}))},948:function(e,t,a){"use strict";a(413);var n=a(276),r=a(0),s=a.n(r),i=a(942),o=a.n(i),c=a(35),m=a(91);var l=s.a.memo((function(e){var t=e.lastCommit,a=t.committerName,r=t.commitHash,i=t.message,l=t.time;return s.a.createElement("div",{className:o.a.CommitInfoBar},s.a.createElement("div",{className:o.a.left},s.a.createElement(c.b,{className:o.a.name,to:m.b.generatePersonalCenterRoute({username:a})},a),s.a.createElement("div",{className:o.a.message},i)),s.a.createElement("div",{className:o.a.right},s.a.createElement("div",{className:o.a.time},l),s.a.createElement(n.a,{title:r},s.a.createElement("div",{className:o.a.commitHash},"\u6700\u540e\u63d0\u4ea4\uff1a",r.slice(0,7)))))}));a.d(t,"a",(function(){return l}))}}]);
//# sourceMappingURL=31.7f5e20e4.chunk.js.map