(this["webpackJsonpsoulike-git"]=this["webpackJsonpsoulike-git"]||[]).push([[18],{1113:function(e,t,a){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}a.d(t,"a",(function(){return n}))},1114:function(e,t,a){"use strict";function n(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function r(e,t,a){return t&&n(e.prototype,t),a&&n(e,a),e}a.d(t,"a",(function(){return r}))},1115:function(e,t,a){"use strict";function n(e){return(n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}a.d(t,"a",(function(){return n}))},1116:function(e,t,a){"use strict";function n(e){return(n="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t){return!t||"object"!==n(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}a.d(t,"a",(function(){return r}))},1117:function(e,t,a){"use strict";function n(e,t){return(n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function r(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&n(e,t)}a.d(t,"a",(function(){return r}))},1127:function(e,t,a){"use strict";function n(e){return function(e){if(Array.isArray(e)){for(var t=0,a=new Array(e.length);t<e.length;t++)a[t]=e[t];return a}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}a.d(t,"a",(function(){return n}))},1140:function(e,t,a){(function(e){function a(e,t){for(var a=0,n=e.length-1;n>=0;n--){var r=e[n];"."===r?e.splice(n,1):".."===r?(e.splice(n,1),a++):a&&(e.splice(n,1),a--)}if(t)for(;a--;a)e.unshift("..");return e}function n(e,t){if(e.filter)return e.filter(t);for(var a=[],n=0;n<e.length;n++)t(e[n],n,e)&&a.push(e[n]);return a}t.resolve=function(){for(var t="",r=!1,s=arguments.length-1;s>=-1&&!r;s--){var o=s>=0?arguments[s]:e.cwd();if("string"!==typeof o)throw new TypeError("Arguments to path.resolve must be strings");o&&(t=o+"/"+t,r="/"===o.charAt(0))}return(r?"/":"")+(t=a(n(t.split("/"),(function(e){return!!e})),!r).join("/"))||"."},t.normalize=function(e){var s=t.isAbsolute(e),o="/"===r(e,-1);return(e=a(n(e.split("/"),(function(e){return!!e})),!s).join("/"))||s||(e="."),e&&o&&(e+="/"),(s?"/":"")+e},t.isAbsolute=function(e){return"/"===e.charAt(0)},t.join=function(){var e=Array.prototype.slice.call(arguments,0);return t.normalize(n(e,(function(e,t){if("string"!==typeof e)throw new TypeError("Arguments to path.join must be strings");return e})).join("/"))},t.relative=function(e,a){function n(e){for(var t=0;t<e.length&&""===e[t];t++);for(var a=e.length-1;a>=0&&""===e[a];a--);return t>a?[]:e.slice(t,a-t+1)}e=t.resolve(e).substr(1),a=t.resolve(a).substr(1);for(var r=n(e.split("/")),s=n(a.split("/")),o=Math.min(r.length,s.length),i=o,c=0;c<o;c++)if(r[c]!==s[c]){i=c;break}var m=[];for(c=i;c<r.length;c++)m.push("..");return(m=m.concat(s.slice(i))).join("/")},t.sep="/",t.delimiter=":",t.dirname=function(e){if("string"!==typeof e&&(e+=""),0===e.length)return".";for(var t=e.charCodeAt(0),a=47===t,n=-1,r=!0,s=e.length-1;s>=1;--s)if(47===(t=e.charCodeAt(s))){if(!r){n=s;break}}else r=!1;return-1===n?a?"/":".":a&&1===n?"/":e.slice(0,n)},t.basename=function(e,t){var a=function(e){"string"!==typeof e&&(e+="");var t,a=0,n=-1,r=!0;for(t=e.length-1;t>=0;--t)if(47===e.charCodeAt(t)){if(!r){a=t+1;break}}else-1===n&&(r=!1,n=t+1);return-1===n?"":e.slice(a,n)}(e);return t&&a.substr(-1*t.length)===t&&(a=a.substr(0,a.length-t.length)),a},t.extname=function(e){"string"!==typeof e&&(e+="");for(var t=-1,a=0,n=-1,r=!0,s=0,o=e.length-1;o>=0;--o){var i=e.charCodeAt(o);if(47!==i)-1===n&&(r=!1,n=o+1),46===i?-1===t?t=o:1!==s&&(s=1):-1!==t&&(s=-1);else if(!r){a=o+1;break}}return-1===t||-1===n||0===s||1===s&&t===n-1&&t===a+1?"":e.slice(t,n)};var r="b"==="ab".substr(-1)?function(e,t,a){return e.substr(t,a)}:function(e,t,a){return t<0&&(t=e.length+t),e.substr(t,a)}}).call(this,a(96))},1166:function(e,t){e.exports=function(e){if("string"!==typeof e)return!1;var t=e.match(a);if(!t)return!1;var s=t[1];if(!s)return!1;if(n.test(s)||r.test(s))return!0;return!1};var a=/^(?:\w+:)?\/\/(\S+)$/,n=/^localhost[\:?\d]*(?:[^\:?\d]\S*)?$/,r=/^[^\s\.]+\.\S{2,}$/},1167:function(e,t,a){e.exports={CommitInfoBar:"Style_CommitInfoBar__AogMa",left:"Style_left__3aqnY",right:"Style_right__XNYqn",avatar:"Style_avatar__2CYzj",name:"Style_name__3WHXI"}},1181:function(e,t,a){"use strict";a(339);var n=a(156),r=a(0),s=a.n(r),o=a(1167),i=a.n(o),c=a(15),m=a(132),u=a(32),l=a(97);var p=Object(m.f)(s.a.memo((function(e){const{lastCommit:{committerName:t,commitHash:a,message:r,timestamp:o},match:{params:{username:m,repository:p}}}=e;return s.a.createElement("div",{className:i.a.CommitInfoBar},s.a.createElement("div",{className:i.a.left},s.a.createElement(c.b,{className:i.a.name,to:u.Function.generatePersonalCenterRoute({username:t})},t),s.a.createElement("div",{className:i.a.message},r)),s.a.createElement("div",{className:i.a.right},s.a.createElement("div",{className:i.a.time},l.b.parseTimestampToDifference(o)),s.a.createElement(n.a,{title:a},s.a.createElement("div",{className:i.a.commitHash},"\u6700\u540e\u63d0\u4ea4\uff1a",s.a.createElement(c.b,{to:u.Function.generateRepositoryCommitRoute({username:m,repository:p,commitHash:a})},a.slice(0,7))))))})));a.d(t,"a",(function(){return p}))},1182:function(e,t,a){"use strict";var n=a(0),r=a.n(n),s=a(132),o=a(32),i=a(342),c=a(1166),m=a.n(c),u=a(20),l=a(1140),p=a.n(l),f=a(249);class h extends n.PureComponent{constructor(e){super(e),this.objectURLs=[],this.loadMainBranchName=async()=>new Promise(async e=>{const{match:{params:{username:t,repository:a}}}=this.props,n=await i.a.branches({username:t,name:a});if(null!==n){const{branches:t}=n;for(const{name:a,isDefault:n}of t)if(n){this.setState({mainBranchName:a},()=>e());break}}}),this.processHTML=async e=>{const t=document.implementation.createHTMLDocument().createElement("div");t.innerHTML=e;const a=t.getElementsByTagName("a"),n=t.getElementsByTagName("img"),r=[];for(const s of a){const e=s.getAttribute("href");null!==e&&r.push((async()=>{s.setAttribute("href",await this.getCompleteLink(e))})())}for(const s of n){const e=s.getAttribute("src");null!==e&&r.push((async()=>{const t=await this.getImageURL(e);this.objectURLs.push(t),s.setAttribute("src",t)})())}return await Promise.all(r),t.innerHTML},this.getCompleteLink=async e=>{if(0===e.length||m()(e)||p.a.isAbsolute(e)||"#"===e.charAt(0)||"?"===e.charAt(0))return e;{const{match:{params:{username:t,repository:a,objectType:n,branch:r,path:s}}}=this.props,{mainBranchName:c}=this.state,m=s?n===u.b.BLOB?p.a.join(p.a.dirname(s),e):p.a.join(s,e):p.a.join("",e),l=await i.a.fileInfo({username:t},{name:a},m,r||c);if(null!==l){const{exists:e,type:n}=l;return e&&n!==u.b.BLOB?o.Function.generateRepositoryCodeRoute({username:t,repository:a,branch:r||c,path:m,objectType:u.b.TREE}):o.Function.generateRepositoryCodeRoute({username:t,repository:a,branch:r||c,path:m,objectType:u.b.BLOB})}return o.Function.generateRepositoryCodeRoute({username:t,repository:a,branch:r||c,path:m,objectType:u.b.BLOB})}},this.getImageURL=async e=>{if(m()(e)||p.a.isAbsolute(e))return e;{const{match:{params:{username:t,repository:a,objectType:n,branch:r,path:s}}}=this.props,{mainBranchName:o}=this.state,c=s?n===u.b.BLOB?p.a.join(p.a.dirname(s),e):p.a.join(s,e):p.a.join("",e),m=await i.a.rawFile({username:t},{name:a},c,r||o);return null!==m?URL.createObjectURL(m):e}},this.state={mainBranchName:"",loading:!1}}async componentDidMount(){const{match:{params:{branch:e}}}=this.props;this.setState({loading:!0}),"string"!==typeof e&&await this.loadMainBranchName(),this.setState({loading:!1})}async componentDidUpdate(e,t,a){const{markdown:n}=this.props,{markdown:r}=e;n!==r&&await this.componentDidMount()}componentWillUnmount(){this.objectURLs.forEach(e=>URL.revokeObjectURL(e))}render(){const{loading:e}=this.state,{markdown:t}=this.props;return r.a.createElement(f.a,{markdown:t,processHTML:this.processHTML,loading:e})}}var d=Object(s.f)(h);a.d(t,"a",(function(){return d}))},1277:function(e,t,a){e.exports={FileList:"Style_FileList__3rWIg",lastCommitInfoBar:"Style_lastCommitInfoBar__2XW39",readmeWrapper:"Style_readmeWrapper__25GwL"}},1278:function(e,t,a){e.exports={Item:"Style_Item__2qcqg",icon:"Style_icon__1TlO4",fileName:"Style_fileName__zs9qY",message:"Style_message__1rBHL",time:"Style_time__2cJ9G"}},1279:function(e,t,a){e.exports={Readme:"Style_Readme__2e1Tq",title:"Style_title__2mCc5",contentWrapper:"Style_contentWrapper__3fQZA"}},1334:function(e,t,a){"use strict";a.r(t);var n=a(1127),r=a(3),s=a.n(r),o=a(7),i=a(1113),c=a(1114),m=a(1116),u=a(1115),l=a(1117),p=a(0),f=a.n(p),h=(a(1129),a(1128)),d=(a(340),a(103)),b=a(1277),y=a.n(b),v=a(20),g=a(15),w=a(132),j=a(1278),E=a.n(j),_=a(32),x=a(97),N={name:"file-text",theme:"outlined",icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494zM504 618H320c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h184c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8zM312 490v48c0 4.4 3.6 8 8 8h384c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H320c-4.4 0-8 3.6-8 8z"}}]}},O=a(12),S=function(e,t){return f.a.createElement(O.a,Object.assign({},e,{ref:t,icon:N}))};S.displayName="FileTextOutlined";var k=f.a.forwardRef(S),B={name:"folder",theme:"outlined",icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 298.4H521L403.7 186.2a8.15 8.15 0 00-5.5-2.2H144c-17.7 0-32 14.3-32 32v592c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V330.4c0-17.7-14.3-32-32-32zM840 768H184V256h188.5l119.6 114.4H840V768z"}}]}},L=function(e,t){return f.a.createElement(O.a,Object.assign({},e,{ref:t,icon:B}))};L.displayName="FolderOutlined";var C=f.a.forwardRef(L);var R=Object(w.f)(f.a.memo((function(e){const{masterBranchName:t,fileInfo:{type:a,path:n,commit:{message:r,timestamp:s,commitHash:o}},match:{params:{username:i,repository:c,branch:m}}}=e,u=function(e){const t=e.split("/");return t[t.length-1]}(n);return f.a.createElement(h.a.Item,{className:E.a.Item},a===v.b.BLOB?f.a.createElement(k,{className:E.a.icon}):f.a.createElement(C,{className:E.a.icon}),f.a.createElement("div",{className:E.a.fileName},f.a.createElement(g.b,{to:_.Function.generateRepositoryCodeRoute({username:i,repository:c,objectType:a,branch:m||t,path:n})},u)),f.a.createElement(g.b,{className:E.a.message,to:_.Function.generateRepositoryCommitRoute({username:i,repository:c,commitHash:o})},r),f.a.createElement("div",{className:E.a.time},x.b.parseTimestampToDifference(s)))}))),A=(a(142),a(73)),H=a(1279),T=a.n(H),M=a(1182);var D=f.a.memo((function(e){const{readme:t,exists:a,loading:n}=e;return a?f.a.createElement("div",{className:T.a.Readme},f.a.createElement(A.a,{spinning:n},f.a.createElement("div",{className:T.a.title},"README.md"),f.a.createElement("div",{className:T.a.contentWrapper},f.a.createElement(M.a,{markdown:t})))):null})),I=a(342),F=a(1140);class P extends p.PureComponent{constructor(e){super(e),this.readmeExists=async()=>{const{match:{params:{username:e,repository:t,path:a}},commitHash:n}=this.props,r=await I.a.fileInfo({username:e},{name:t},Object(F.join)(a||"","README.md"),n);return null!==r&&r.exists},this.loadRawReadme=async()=>{const{match:{params:{username:e,repository:t,path:a}},commitHash:n}=this.props,r=await I.a.rawFile({username:e},{name:t},Object(F.join)(a||"","README.md"),n);null!==r&&this.setState({readme:await x.c.transformBlobToString(r),exists:!0})},this.state={exists:!1,readme:"",loading:!0}}async componentDidMount(){const{commitHash:e}=this.props;e&&(this.setState({loading:!0}),await this.readmeExists()?await this.loadRawReadme():this.setState({exists:!1}),this.setState({loading:!1}))}async componentDidUpdate(e,t,a){const{location:{pathname:n},commitHash:r}=this.props,{location:{pathname:s},commitHash:o}=e;n===s&&r===o||await this.componentDidMount()}render(){const{readme:e,exists:t,loading:a}=this.state;return f.a.createElement(D,{exists:t,readme:e,loading:a})}}var U=Object(w.f)(P),z=a(1181);const W=f.a.lazy(()=>a.e(46).then(a.bind(null,1366)));var q=f.a.memo((function(e){const{fileList:t,lastCommit:a,loading:n,showPreviousFolderItem:r,masterBranchName:s}=e,{commitHash:o}=a;return f.a.createElement(f.a.Fragment,null,f.a.createElement("div",{className:y.a.FileList},f.a.createElement("div",{className:y.a.lastCommitInfoBar},f.a.createElement(z.a,{lastCommit:a})),f.a.createElement(h.a,{locale:{emptyText:f.a.createElement(d.a,{description:"\u6ca1\u6709\u6587\u4ef6"})},loading:n,className:y.a.fileList},r?f.a.createElement(W,null):null,t.map(e=>f.a.createElement(R,{masterBranchName:s,fileInfo:e,key:e.path})))),f.a.createElement("div",{className:y.a.readmeWrapper},f.a.createElement(U,{commitHash:o})))})),V=a(45),Y=a(115),J=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(m.a)(this,Object(u.a)(t).call(this,e))).loadMasterBranchName=Object(o.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(o.a)(s.a.mark((function e(t){var n,r,o,i,c,m,u,l,p,f,h,d,b;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.props.match.params,r=n.username,o=n.repository,e.next=3,V.h.branches({username:r,name:o});case 3:if(null===(i=e.sent)){e.next=35;break}c=i.branches,m="",u=!0,l=!1,p=void 0,e.prev=10,f=c[Symbol.iterator]();case 12:if(u=(h=f.next()).done){e.next=20;break}if(d=h.value,b=d.name,!d.isDefault){e.next=17;break}return m=b,e.abrupt("break",20);case 17:u=!0,e.next=12;break;case 20:e.next=26;break;case 22:e.prev=22,e.t0=e.catch(10),l=!0,p=e.t0;case 26:e.prev=26,e.prev=27,u||null==f.return||f.return();case 29:if(e.prev=29,!l){e.next=32;break}throw p;case 32:return e.finish(29);case 33:return e.finish(26);case 34:a.setState({masterBranchName:m},(function(){return t()}));case 35:case"end":return e.stop()}}),e,null,[[10,22,26,34],[27,,29,33]])})));return function(t){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)}))),a.loadDirectory=Object(o.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(o.a)(s.a.mark((function e(t){var r,o,i,c,m,u,l;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.props.match.params,o=r.username,i=r.repository,c=r.path,m=r.branch,u=a.state.masterBranchName,e.next=4,V.h.directory({username:o},{name:i},m||u,void 0===c?"":c+"/");case 4:null!==(l=e.sent)?a.setState({fileList:Object(n.a)(l)},(function(){return t()})):t();case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)}))),a.loadLastCommit=Object(o.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(o.a)(s.a.mark((function e(t){var n,r,o,i,c,m,u;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.props.match.params,r=n.username,o=n.repository,i=n.branch,c=n.path,m=a.state.masterBranchName,e.next=4,V.h.lastBranchCommit({username:r},{name:o},i||m,c);case 4:null!==(u=e.sent)?a.setState({lastCommit:u},(function(){return t()})):t();case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)}))),a.state={fileList:[],lastCommit:new Y.b("","","",0,"",""),loading:!0,masterBranchName:""},a}return Object(l.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=Object(o.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({loading:!0}),e.next=3,this.loadMasterBranchName();case 3:return e.next=5,this.loadLastCommit();case 5:return e.next=7,this.loadDirectory();case 7:this.setState({loading:!1});case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(o.a)(s.a.mark((function e(t,a,n){var r,o,i,c,m,u,l,p,f,h;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.match.params,o=r.username,i=r.repository,c=r.branch,m=r.path,u=this.props.match.params,l=u.username,p=u.repository,f=u.branch,h=u.path,o===l&&i===p){e.next=7;break}return e.next=5,this.componentDidMount();case 5:e.next=19;break;case 7:if(c===f){e.next=14;break}return this.setState({loading:!0}),e.next=11,Promise.all([this.loadDirectory(),this.loadLastCommit()]);case 11:this.setState({loading:!1}),e.next=19;break;case 14:if(m===h){e.next=19;break}return this.setState({loading:!0}),e.next=18,this.loadDirectory();case 18:this.setState({loading:!1});case 19:case"end":return e.stop()}}),e,this)})));return function(t,a,n){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state,t=e.fileList,a=e.lastCommit,n=e.loading,r=e.masterBranchName,s=this.props.match.params.path;return f.a.createElement(q,{fileList:t,masterBranchName:r,lastCommit:a,loading:n,showPreviousFolderItem:void 0!==s})}}]),t}(p.Component),X=Object(w.f)(J);a.d(t,"default",(function(){return X}))}}]);
//# sourceMappingURL=18.1c23468e.chunk.js.map