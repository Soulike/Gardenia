(this["webpackJsonpsoulike-git"]=this["webpackJsonpsoulike-git"]||[]).push([[18],{1113:function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,"a",(function(){return a}))},1114:function(e,t,n){"use strict";function a(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function r(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}n.d(t,"a",(function(){return r}))},1115:function(e,t,n){"use strict";function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}n.d(t,"a",(function(){return a}))},1116:function(e,t,n){"use strict";function a(e){return(a="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t){return!t||"object"!==a(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}n.d(t,"a",(function(){return r}))},1117:function(e,t,n){"use strict";function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function r(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}n.d(t,"a",(function(){return r}))},1140:function(e,t,n){(function(e){function n(e,t){for(var n=0,a=e.length-1;a>=0;a--){var r=e[a];"."===r?e.splice(a,1):".."===r?(e.splice(a,1),n++):n&&(e.splice(a,1),n--)}if(t)for(;n--;n)e.unshift("..");return e}function a(e,t){if(e.filter)return e.filter(t);for(var n=[],a=0;a<e.length;a++)t(e[a],a,e)&&n.push(e[a]);return n}t.resolve=function(){for(var t="",r=!1,o=arguments.length-1;o>=-1&&!r;o--){var i=o>=0?arguments[o]:e.cwd();if("string"!==typeof i)throw new TypeError("Arguments to path.resolve must be strings");i&&(t=i+"/"+t,r="/"===i.charAt(0))}return(r?"/":"")+(t=n(a(t.split("/"),(function(e){return!!e})),!r).join("/"))||"."},t.normalize=function(e){var o=t.isAbsolute(e),i="/"===r(e,-1);return(e=n(a(e.split("/"),(function(e){return!!e})),!o).join("/"))||o||(e="."),e&&i&&(e+="/"),(o?"/":"")+e},t.isAbsolute=function(e){return"/"===e.charAt(0)},t.join=function(){var e=Array.prototype.slice.call(arguments,0);return t.normalize(a(e,(function(e,t){if("string"!==typeof e)throw new TypeError("Arguments to path.join must be strings");return e})).join("/"))},t.relative=function(e,n){function a(e){for(var t=0;t<e.length&&""===e[t];t++);for(var n=e.length-1;n>=0&&""===e[n];n--);return t>n?[]:e.slice(t,n-t+1)}e=t.resolve(e).substr(1),n=t.resolve(n).substr(1);for(var r=a(e.split("/")),o=a(n.split("/")),i=Math.min(r.length,o.length),s=i,c=0;c<i;c++)if(r[c]!==o[c]){s=c;break}var u=[];for(c=s;c<r.length;c++)u.push("..");return(u=u.concat(o.slice(s))).join("/")},t.sep="/",t.delimiter=":",t.dirname=function(e){if("string"!==typeof e&&(e+=""),0===e.length)return".";for(var t=e.charCodeAt(0),n=47===t,a=-1,r=!0,o=e.length-1;o>=1;--o)if(47===(t=e.charCodeAt(o))){if(!r){a=o;break}}else r=!1;return-1===a?n?"/":".":n&&1===a?"/":e.slice(0,a)},t.basename=function(e,t){var n=function(e){"string"!==typeof e&&(e+="");var t,n=0,a=-1,r=!0;for(t=e.length-1;t>=0;--t)if(47===e.charCodeAt(t)){if(!r){n=t+1;break}}else-1===a&&(r=!1,a=t+1);return-1===a?"":e.slice(n,a)}(e);return t&&n.substr(-1*t.length)===t&&(n=n.substr(0,n.length-t.length)),n},t.extname=function(e){"string"!==typeof e&&(e+="");for(var t=-1,n=0,a=-1,r=!0,o=0,i=e.length-1;i>=0;--i){var s=e.charCodeAt(i);if(47!==s)-1===a&&(r=!1,a=i+1),46===s?-1===t?t=i:1!==o&&(o=1):-1!==t&&(o=-1);else if(!r){n=i+1;break}}return-1===t||-1===a||0===o||1===o&&t===a-1&&t===n+1?"":e.slice(t,a)};var r="b"==="ab".substr(-1)?function(e,t,n){return e.substr(t,n)}:function(e,t,n){return t<0&&(t=e.length+t),e.substr(t,n)}}).call(this,n(96))},1166:function(e,t){e.exports=function(e){if("string"!==typeof e)return!1;var t=e.match(n);if(!t)return!1;var o=t[1];if(!o)return!1;if(a.test(o)||r.test(o))return!0;return!1};var n=/^(?:\w+:)?\/\/(\S+)$/,a=/^localhost[\:?\d]*(?:[^\:?\d]\S*)?$/,r=/^[^\s\.]+\.\S{2,}$/},1167:function(e,t,n){e.exports={CommitInfoBar:"Style_CommitInfoBar__AogMa",left:"Style_left__3aqnY",right:"Style_right__XNYqn",avatar:"Style_avatar__2CYzj",name:"Style_name__3WHXI"}},1181:function(e,t,n){"use strict";n(339);var a=n(156),r=n(0),o=n.n(r),i=n(1167),s=n.n(i),c=n(15),u=n(132),l=n(32),m=n(97);var f=Object(u.f)(o.a.memo((function(e){const{lastCommit:{committerName:t,commitHash:n,message:r,timestamp:i},match:{params:{username:u,repository:f}}}=e;return o.a.createElement("div",{className:s.a.CommitInfoBar},o.a.createElement("div",{className:s.a.left},o.a.createElement(c.b,{className:s.a.name,to:l.Function.generatePersonalCenterRoute({username:t})},t),o.a.createElement("div",{className:s.a.message},r)),o.a.createElement("div",{className:s.a.right},o.a.createElement("div",{className:s.a.time},m.b.parseTimestampToDifference(i)),o.a.createElement(a.a,{title:n},o.a.createElement("div",{className:s.a.commitHash},"\u6700\u540e\u63d0\u4ea4\uff1a",o.a.createElement(c.b,{to:l.Function.generateRepositoryCommitRoute({username:u,repository:f,commitHash:n})},n.slice(0,7))))))})));n.d(t,"a",(function(){return f}))},1182:function(e,t,n){"use strict";var a=n(0),r=n.n(a),o=n(132),i=n(32),s=n(342),c=n(1166),u=n.n(c),l=n(20),m=n(1140),f=n.n(m),p=n(249);class h extends a.PureComponent{constructor(e){super(e),this.objectURLs=[],this.loadMainBranchName=async()=>new Promise(async e=>{const{match:{params:{username:t,repository:n}}}=this.props,a=await s.a.branches({username:t,name:n});if(null!==a){const{branches:t}=a;for(const{name:n,isDefault:a}of t)if(a){this.setState({mainBranchName:n},()=>e());break}}}),this.processHTML=async e=>{const t=document.implementation.createHTMLDocument().createElement("div");t.innerHTML=e;const n=t.getElementsByTagName("a"),a=t.getElementsByTagName("img"),r=[];for(const o of n){const e=o.getAttribute("href");null!==e&&r.push((async()=>{o.setAttribute("href",await this.getCompleteLink(e))})())}for(const o of a){const e=o.getAttribute("src");null!==e&&r.push((async()=>{const t=await this.getImageURL(e);this.objectURLs.push(t),o.setAttribute("src",t)})())}return await Promise.all(r),t.innerHTML},this.getCompleteLink=async e=>{if(0===e.length||u()(e)||f.a.isAbsolute(e)||"#"===e.charAt(0)||"?"===e.charAt(0))return e;{const{match:{params:{username:t,repository:n,objectType:a,branch:r,path:o}}}=this.props,{mainBranchName:c}=this.state,u=o?a===l.b.BLOB?f.a.join(f.a.dirname(o),e):f.a.join(o,e):f.a.join("",e),m=await s.a.fileInfo({username:t},{name:n},u,r||c);if(null!==m){const{exists:e,type:a}=m;return e&&a!==l.b.BLOB?i.Function.generateRepositoryCodeRoute({username:t,repository:n,branch:r||c,path:u,objectType:l.b.TREE}):i.Function.generateRepositoryCodeRoute({username:t,repository:n,branch:r||c,path:u,objectType:l.b.BLOB})}return i.Function.generateRepositoryCodeRoute({username:t,repository:n,branch:r||c,path:u,objectType:l.b.BLOB})}},this.getImageURL=async e=>{if(u()(e)||f.a.isAbsolute(e))return e;{const{match:{params:{username:t,repository:n,objectType:a,branch:r,path:o}}}=this.props,{mainBranchName:i}=this.state,c=o?a===l.b.BLOB?f.a.join(f.a.dirname(o),e):f.a.join(o,e):f.a.join("",e),u=await s.a.rawFile({username:t},{name:n},c,r||i);return null!==u?URL.createObjectURL(u):e}},this.state={mainBranchName:"",loading:!1}}async componentDidMount(){const{match:{params:{branch:e}}}=this.props;this.setState({loading:!0}),"string"!==typeof e&&await this.loadMainBranchName(),this.setState({loading:!1})}async componentDidUpdate(e,t,n){const{markdown:a}=this.props,{markdown:r}=e;a!==r&&await this.componentDidMount()}componentWillUnmount(){this.objectURLs.forEach(e=>URL.revokeObjectURL(e))}render(){const{loading:e}=this.state,{markdown:t}=this.props;return r.a.createElement(p.a,{markdown:t,processHTML:this.processHTML,loading:e})}}var d=Object(o.f)(h);n.d(t,"a",(function(){return d}))},1282:function(e,t,n){e.exports={FileReader:"Style_FileReader__3UwbJ",commitInfoBar:"Style_commitInfoBar__Q8via",contentWrapper:"Style_contentWrapper__WXjet",fileInfoBar:"Style_fileInfoBar__2tYVI",fileName:"Style_fileName__CCvcF",readerWrapper:"Style_readerWrapper__1-Blo",content:"Style_content___R5vO"}},1283:function(e,t,n){e.exports={CodeReader:"Style_CodeReader__yNPpi",line:"Style_line__2xQ8V",lineNumber:"Style_lineNumber__nX9YT",code:"Style_code__19ilK"}},1284:function(e,t,n){e.exports={MarkdownReader:"Style_MarkdownReader__2lNN5"}},1335:function(e,t,n){"use strict";n.r(t);var a=n(3),r=n.n(a),o=n(7),i=n(1113),s=n(1114),c=n(1116),u=n(1115),l=n(1117),m=n(0),f=n.n(m),p=(n(142),n(73)),h=(n(94),n(25)),d=n(1282),b=n.n(d),y=n(1181),v=n(32),g=n(15),w=n(132),_=(n(341),n(157));var j=f.a.memo((function(){return f.a.createElement(_.a,{type:"warning",showIcon:!0,message:"\u4e8c\u8fdb\u5236\u6587\u4ef6\u65e0\u6cd5\u663e\u793a",description:"\u4f60\u53ef\u4ee5\u76f4\u63a5\u4e0b\u8f7d\u67e5\u770b\u539f\u6587\u4ef6"})}));var E=f.a.memo((function(){return f.a.createElement(_.a,{type:"warning",showIcon:!0,message:"\u6587\u4ef6\u8fc7\u5927\uff0c\u4e0d\u80fd\u76f4\u63a5\u67e5\u770b",description:"\u4f60\u53ef\u4ee5\u76f4\u63a5\u4e0b\u8f7d\u67e5\u770b\u539f\u6587\u4ef6"})})),C=n(1140),O=n(1283),N=n.n(O),k=n(97);var B=f.a.memo((function(e){var t=e.code,n=k.a.getHighlightedCodeLines(t);return f.a.createElement("table",{className:"".concat(N.a.CodeReader," hljs")},f.a.createElement("tbody",null,n.map((function(e,t){return f.a.createElement("tr",{key:t,className:N.a.line},f.a.createElement("td",null,f.a.createElement("div",{className:N.a.lineNumber},t+1)),f.a.createElement("td",null,f.a.createElement("pre",{className:N.a.code},f.a.createElement("code",{dangerouslySetInnerHTML:{__html:e}}))))}))))})),R=n(1284),S=n.n(R),x=n(1182);var L=f.a.memo((function(e){const{markdown:t}=e;return f.a.createElement("div",{className:S.a.MarkdownReader},f.a.createElement(x.a,{markdown:t}))}));var F=Object(w.f)(f.a.memo((function(e){const t=[".json"],n=[".md",".markdown",".mdwn"],{isBinary:a,isOversize:r,fileName:o,lastCommit:i,loading:s,onRawFileButtonClick:c,fileContent:u,match:{params:{username:l,repository:m,branch:d,path:w}}}=e,_=Object(C.extname)(o).toLowerCase();return f.a.createElement("div",{className:b.a.FileReader},f.a.createElement(p.a,{spinning:s},f.a.createElement("div",{className:b.a.commitInfoBar},f.a.createElement(y.a,{lastCommit:i})),f.a.createElement("div",{className:b.a.contentWrapper},f.a.createElement("div",{className:b.a.fileInfoBar},f.a.createElement("div",{className:b.a.fileName},o),f.a.createElement(h.a.Group,{className:b.a.buttonWrapper},f.a.createElement(h.a,null,f.a.createElement(g.b,{to:v.Function.generateRepositoryCommitsRoute({username:l,repository:m,branch:d,path:w})},"\u5386\u53f2")),f.a.createElement(h.a,{onClick:c},"\u4e0b\u8f7d"))),f.a.createElement("div",{className:b.a.readerWrapper},a?f.a.createElement(j,null):r?f.a.createElement(E,null):t.includes(_)?f.a.createElement(B,{code:u}):n.includes(_)?f.a.createElement(L,{markdown:u}):f.a.createElement(B,{code:u})))))}))),T=n(115),I=n(45),A=v.CONFIG.PAGE_ID_TO_ROUTE,U=v.CONFIG.PAGE_ID,M=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).loadLastCommit=Object(o.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(o.a)(r.a.mark((function e(t){var a,o,i,s,c,u;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.props.match.params,o=a.username,i=a.repository,s=a.path,c=a.branch,e.next=3,I.h.lastBranchCommit({username:o},{name:i},c,s);case 3:null!==(u=e.sent)&&n.setState({lastCommit:u},(function(){return t()}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)}))),n.loadFileInfo=Object(o.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(o.a)(r.a.mark((function e(t){var a,o,i,s,c,u,l,m,f,p,h;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.state.lastCommit.commitHash,o=n.props,i=o.match.params,s=i.username,c=i.repository,u=i.path,l=o.history,e.next=4,I.h.fileInfo({username:s},{name:c},u,a);case 4:null!==(m=e.sent)&&(f=m.exists,p=m.size,h=m.isBinary,f?!h&&p>1048576?n.setState({isOversize:!0,isBinary:h},(function(){return t()})):n.setState({isOversize:!1,isBinary:h},(function(){return t()})):l.replace(A[U.NOT_FOUND]));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)}))),n.loadFileContent=Object(o.a)(r.a.mark((function e(){var t,a,o,i,s,c;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.props.match.params,a=t.username,o=t.repository,i=t.path,s=n.state.lastCommit.commitHash,e.next=4,I.h.rawFile({username:a},{name:o},i,s);case 4:if(null===(c=e.sent)){e.next=12;break}return e.t0=n,e.next=9,k.c.transformBlobToString(c);case 9:e.t1=e.sent,e.t2={fileContent:e.t1},e.t0.setState.call(e.t0,e.t2);case 12:case"end":return e.stop()}}),e)}))),n.onRawFileButtonClick=Object(o.a)(r.a.mark((function e(){var t,a,o,i,s,c;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.props.match.params,a=t.username,o=t.repository,i=t.path,s=n.state.lastCommit.commitHash,e.next=4,I.h.rawFile({username:a},{name:o},i,s);case 4:null!==(c=e.sent)&&n.startDownload(c);case 6:case"end":return e.stop()}}),e)}))),n.startDownload=function(e){var t=n.props.match.params.path,a=URL.createObjectURL(e);k.c.startDownload(a,Object(C.basename)(t)),URL.revokeObjectURL(a)},n.getFileNameFromPath=function(e){var t=e.split("/");return t[t.length-1]},n.state={isBinary:!1,isOversize:!1,lastCommit:new T.b("","","",0,"",""),loading:!0,fileContent:""},n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=Object(o.a)(r.a.mark((function e(){var t,n,a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({loading:!0}),e.next=3,this.loadLastCommit();case 3:return e.next=5,this.loadFileInfo();case 5:if(t=this.state,n=t.isBinary,a=t.isOversize,n||a){e.next=9;break}return e.next=9,this.loadFileContent();case 9:this.setState({loading:!1});case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(o.a)(r.a.mark((function e(t,n,a){var o,i;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=this.props.location.pathname,i=t.location.pathname,o===i){e.next=5;break}return e.next=5,this.componentDidMount();case 5:case"end":return e.stop()}}),e,this)})));return function(t,n,a){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.props.match.params.path,t=this.state,n=t.isBinary,a=t.isOversize,r=t.lastCommit,o=t.loading,i=t.fileContent,s=this.getFileNameFromPath(e);return f.a.createElement(F,{fileContent:i,isBinary:n,isOversize:a,lastCommit:r,fileName:s,loading:o,onRawFileButtonClick:this.onRawFileButtonClick})}}]),t}(m.PureComponent),P=Object(w.f)(M);n.d(t,"default",(function(){return P}))}}]);
//# sourceMappingURL=18.40e6e175.chunk.js.map